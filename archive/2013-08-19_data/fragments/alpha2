((idp8880624
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      TODO use Cow.Html to generate a more complete Atom feed.\n    </blockquote>")))
 (idp8878960
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      TODO finish the atom example.\n    </blockquote>")))
 (idp8878528
  ((file xml-streams-and-trees.html)
   (html "<blockquote>\n      TODO antiquotations.\n    </blockquote>")))
 (idp8875040
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      There's another interesting bit of new syntax in the\n      <code>xml_of_date</code> function known as a\n      <span><em>quotation</em></span>. OCaml not only allows code to be\n      generated during pre-processing, but also to override the core\n      language grammar with new constructs. The most common way of doing\n      this is by embedding the custom grammars inside\n      <code>&lt;:foo&lt; ... &gt;&gt;</code> tags, where\n      <code>foo</code> represents the particular grammar being\n      used. In the case of COW, this lets you generate XMLM-compatible\n      OCaml values just by typing in XML tags.\n    </blockquote>")))
 (idp8873424
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The Atom date field is a good example. We define it as a tuple of\n      integers, but the format mandated by the specification is actually\n      a free-form text format and not XML. However, because the syntax\n      extension generates normal OCaml functions, we can just override\n      the <code>xml_of_date</code> function with a custom one\n      which returns the correct XML fragment. Any references further\n      down the module will just use our overridden version and ignore\n      the auto-generated one.\n    </blockquote>")))
 (idp8872720
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      We've now filled in more of the Atom schema with these records.\n      The first problem we run into is that occasionally there is a\n      mismatch between the syntax extension's idea of what the\n      auto-generated XML should look like, and the reality of the\n      protocol you are mapping to.\n    </blockquote>")))
 (idp8870672
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      This is convenient, but just one small portion of Atom. How do we\n      express the full Atom scheme from earlier? The answer is with just\n      a few more records that match the Atom XML schema.\n    </blockquote>")))
 (idp8869072
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      This will generate the following XML output on the terminal when\n      you execute it:\n    </blockquote>")))
 (idp8866320
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      If we run <code>xml_of_author</code> and convert the result\n      to a human-readable string, our complete example looks like:\n    </blockquote>")))
 (idp8862032
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Notice that the <code>with xml</code> clause has been\n      replaced with a new <code>xml_of_author</code> function that\n      has been generated for you. It accepts an\n      <code>author</code> value and returns an\n      <code>Xml.t</code> value. The generated code isn't really\n      meant to be human-readable, but you don't normally see it when\n      using the syntax extension (we've only dumped it out here to\n      illustrate how <code>camlp4</code> works).\n    </blockquote>")))
 (idp8858336
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Let's see the OCaml code that has been generated for our\n      <code>author</code> record after it has been preprocessed:\n    </blockquote>")))
 (idp8856256
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      You can supply <code>ocamlfind</code> with a number of\n      different predicates to define the type of build you are running\n      (preprocessing, compilation or linking). The final part of the\n      script invokes the <code>camlp4o</code> binary on your ML\n      source file and outputs the transformed source code to your\n      terminal.\n    </blockquote>")))
 (idp8852528
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The OCaml compiler can call <code>camlp4</code>\n      automatically during a compilation to preprocess the source files.\n      This is specified via the <code>-pp</code> flag to the\n      compiler. You don't normally need to specify this flag yourself.\n      Use the <code>ocamlfind</code> utility instead to generate\n      the right command-line flags for you. Here's a small shell script\n      which preprocesses a source file with the COW syntax extension:\n    </blockquote>")))
 (idp8849984
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      This is a standard record type definition with the addition of\n      <code>with xml</code> at the end. This uses a syntax\n      extension to signify that we wish to generate boilerplate code for\n      handling this record as an XML document.\n    </blockquote>")))
 (idp8847824
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Let's start to build up an Atom specification using Cow. First,\n      the <code>&lt;author&gt;</code> tag can be represented with\n      the following type:\n    </blockquote>")))
 (idp8846640
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      One caveat to bear in mind is that COW isn't fully compatible with\n      Core yet, and so you must use the syntax extension before opening\n      the Core modules. (<span><em>avsm</em></span>: we can fix this\n      easily, but note is here as a warning to reviewers).\n    </blockquote>")))
 (idp8844112
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The COW library and syntax extension can be installed via OPAM by\n      <code>opam install cow</code>. There are two OCamlfind\n      packages installed: the library is called <code>cow</code>\n      and the syntax extension is activated with the\n      <code>cow.syntax</code> package.\n    </blockquote>")))
 (idp8842864
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      We want to build this by minimising the amount of repetitive XML\n      generation code. The &quot;Caml on the Web&quot; (COW) library\n      provides a syntax extension that is useful here.\n    </blockquote>")))
 (idp8840720
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Here's an example of an Atom feed:\n    </blockquote>")))
 (idp8839920
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      We'll use the Atom 1.0 syndication format as our example here.\n      Atom feeds allow web-based programs (such as browsers) to poll a\n      website for updates. The website owner publishes a feed of content\n      in a standardized XML format via HTTP. This feed is then parsed by\n      clients and compared against previously downloaded versions to\n      determine which contents are available.\n    </blockquote>")))
 (idp8838000
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The OCaml distribution provides the <code>camlp4</code> tool\n      for this purpose, which you can view as a type-safe preprocessor.\n      Camlp4 operates by loading in a set of syntax extension modules\n      that transform the Abstract Syntax Tree (AST) of OCaml, usually by\n      adding nodes that generate code. We'll talk about how to build\n      your own syntax extensions later in the book, but for now we'll\n      describe how to <span><em>use</em></span> several syntax extensions\n      that make it easier to manipulate external data formats such as\n      XML.\n    </blockquote>")))
 (idp8837328
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      In the earlier JSON chapter, we explained how to construct records\n      by creating the records directly. You can do exactly the same\n      thing for XML, but there is also a more automated method available\n      by using OCaml's facility for syntax extensions.\n    </blockquote>")))
 (idp8833168
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The <code>filter_tag</code> combinator accepts a\n      <code>tree list</code> parameter and outputs a\n      <code>tree list</code>. This lets us easily chain together\n      the results of one filter to another, and hence select\n      hierarchical XML tags very easily. When we get to the\n      <code>&lt;Text&gt;</code> tag, we iterate over all the\n      results and print each one individually.\n    </blockquote>")))
 (idp8829904
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Once we have these helper functions, the selection of all the\n      <code>&lt;Text&gt;</code> tags is a matter of chaining the\n      combinators together to peform the selection over the\n      <code>tree</code> data structure.\n    </blockquote>")))
 (idp8827760
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Notice the use of a <span><em>guard pattern</em></span> in the\n      <code>filter_tag</code> pattern match. This looks for an\n      <code>Element</code> tag that matches the name parameter,\n      and concatenates the results with the accumulator list.\n    </blockquote>")))
 (idp8826288
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      (<span><em>avsm</em></span>: have we explained\n      <code>fold_left</code> before this section or does it need a\n      full intro?)\n    </blockquote>")))
 (idp8823680
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The implementation of these signatures fold over the\n      <code>tree</code> structure to filter the tags which match\n      the desired tag name. A similar version that matches on tag\n      attributes is left as an exercise for you to try.\n    </blockquote>")))
 (idp8820160
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The type <code>tree</code> can be pattern-matched and\n      traversed like a normal OCaml data structure. Let's see how this\n      works by extracting out all the &quot;Related Topics&quot; in the\n      example document. First, we'll need a few helper combinator\n      functions to filter through tags and trees, with the following\n      signature:\n    </blockquote>")))
 (idp8817952
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Signals enforce a very iterative style of parsing XML, as your\n      program has to deal with signals arriving serially. It's often\n      more convenient to deal with complete XML documents directly\n      in-memory as an OCaml data structure. You can convert a signal\n      stream into an OCaml structure by defining the following data type\n      and helper functions:\n    </blockquote>")))
 (idp8811008
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The <code>xml_id</code> function begins by reading one\n      signal, which will always be a <code>Dtd</code>. The\n      recursive <code>pull</code> function is then invoked to\n      iterate over the remaining signals. This uses\n      <code>Xmlm.peek</code> to inspect the current input signal\n      and immediately output it. The rest of the function is not\n      strictly necessary, but it tracks that all of the tags that have\n      been started via the <code>El_start</code> signal are also\n      closed by a corresponding <code>El_end</code> signal. Once\n      the <code>pull</code> function has finished due to the\n      opening tag being closed, the <code>Xmlm.eoi</code> function\n      verifies that the &quot;end of input&quot; has been reached.\n    </blockquote>")))
 (idp8808448
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The <code>Fun</code> channel returns one character at a time\n      as an integer, and <code>String</code> starts parsing an\n      OCaml string from the given integer offset. Both of these are will\n      normally be used in preference to <code>Channel</code>,\n      which uses an interface that is deprecated in Core.\n    </blockquote>")))
 (idp8804208
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Let's start at the bottom, where we open up input and output\n      channels to pass to <code>Xmlm</code> parser. The\n      <code>input</code> and <code>output</code> constructor\n      functions use a polymorphic variant to define the mechanism that\n      the library should use to read the document.\n      <code>Channel</code> is the simplest, but there are several\n      others available.\n    </blockquote>")))
 (idp8801968
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      Let's take a shot at handling signals by writing the XML identity\n      function that parses some XML and outputs it again. There is no\n      explicit buffering required since this uses the XMLM streaming\n      API.\n    </blockquote>")))
 (idp8797136
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      XMLM outputs an ordered sequence of these signals to your code as\n      it parses the document. The first <code>signal</code> when\n      inputting an XML document is always a <code>Dtd</code>. The\n      DTD (or <span><em>document type description</em></span>) optionally\n      defines which tags are allowed within the XML document. Some XML\n      parsers can validate a document against a DTD, but XMLM is a\n      <span><em>non-validating</em></span> parser that reads the DTD if\n      present, but disregards its contents. The\n      <code>El_start</code> and <code>El_end</code> signals\n      indicate the opening and closing of tags, and\n      <code>Data</code> passes the free-form information contained\n      between tags.\n    </blockquote>")))
 (idp8795072
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The type of a <code>signal</code> reveals the basic\n      structure of the streaming API in XMLM:\n    </blockquote>")))
 (idp8791712
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n        A well-formed sequence of <code>signal</code>s represents\n        an XML document tree traversal in depth-first order. Input pulls\n        a well-formed sequence of <code>signal</code>s from a data\n        source and output pushes a well-formed sequence of\n        <code>signal</code>s to a data destination. Functions are\n        provided to easily transform sequences of\n        <code>signal</code>s to/from arborescent data structures.\n      </blockquote>")))
 (idp8790928
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n      The XMLM documentation is a good place to read about the overall\n      layout of the library. It tells us that:\n    </blockquote>")))
 (idp8787488
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n    The XML document is structured as a series of\n    <code>&lt;tags&gt;</code> that are closed by an end\n    <code>&lt;/tag&gt;</code>. The opening tags have an optional\n    set of key/value attributes and usually contain text data or further\n    tags within them. If the XML document is large, we don't want to\n    read the whole thing into memory before processing it. Luckily we\n    don't have to, as there are two parsing strategies for XML: a\n    low-level <span><em>streaming</em></span> API that parses a document\n    incrementally, and a simpler but more inefficient tree API. We'll\n    start with the streaming API first, as the tree API is built on top\n    of it.\n  </blockquote>")))
 (idp8783376
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n    Since XML is such a common web format, we've taken our example\n    document from the\n    <a href=\"http://duckduckgo.com\" target=\"_top\">DuckDuckGo</a> search engine.\n    This is a smaller search engine than the usual suspects, but has the\n    advantage of a freely available API that doesn't require you to\n    register before using it. We'll talk more about how to use the live\n    API later in\n    <a href=\"\">???</a>, but\n    for now here's what a shortened XML search response from DuckDuckGo\n    looks like:\n  </blockquote>")))
 (idp8780800
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n    The remainder of this section uses the freely available XMLM\n    library. It's easiest to obtain it via OPAM (see\n    <a href=\"\">???</a> for\n    installation instructions). You need to run\n    <code>opam install xmlm</code> once OPAM is installed. The\n    library documentation is also readable\n    <a href=\"http://erratique.ch/software/xmlm/doc/Xmlm\" target=\"_top\">online</a>.\n  </blockquote>")))
 (idp8778768
  ((file xml-streams-and-trees.html)
   (html
    "<blockquote>\n    XML is a markup language designed to store tree-structured data in a\n    format that is (somewhat) human- and machine-readable. Like JSON, it\n    is a textual format commonly used in web technologies, with a\n    complete\n    <a href=\"http://www.w3.org/TR/REC-xml/\" target=\"_top\">specification</a>\n    available online. A complete description is beyond the scope of this\n    book, but we'll explain how to manipulate it now.\n  </blockquote>")))
 (idp112288
  ((file variants.html)
   (html
    "<blockquote>\n        Variants are most problematic exactly where you take full\n        advantage of their power; in particular, when you take advantage\n        of the ability of polymorphic variant types to overlap in the\n        tags they support. This ties into OCaml's support for subtyping.\n        As we'll discuss further when we cover objects in\n        <a href=\"object-oriented-programming.html\">Chapter\194\1608, <i>Object Oriented Programming</i></a>,\n        subtyping brings in a lot of complexity, and most of the time,\n        that's complexity you want to avoid.\n      </blockquote>")))
 (idp7601200
  ((file variants.html)
   (html
    "<blockquote>\n        Probably the safest and most common use-case for polymorphic\n        variants is for cases where ordinary variants would be\n        sufficient, but are syntactically too heavyweight. For example,\n        you often want to create a variant type for encoding the inputs\n        or outputs to a function, where it's not worth declaring a\n        separate type for it. Polymorphic variants are very useful here,\n        and as long as there are type annotations that constrain these\n        to have explicit, exact types, this tends to work well.\n      </blockquote>")))
 (idp7600608
  ((file variants.html)
   (html
    "<blockquote>\n        All that said, polymorphic variants are still a useful and\n        powerful feature, but it's worth understanding their\n        limitations, and how to use them sensibly and modestly.\n      </blockquote>")))
 (idp7599280
  ((file variants.html)
   (html
    "<blockquote>\n<span><em>Efficiency:</em></span> This isn't a huge effect,\n            but polymorphic variants are somewhat heavier than regular\n            variants, and OCaml can't generate code for matching on\n            polymorphic variants that is quite as efficient as what is\n            generated for regular variants.\n          </blockquote>")))
 (idp7597904
  ((file variants.html)
   (html
    "<blockquote>\n<span><em>Error-finding:</em></span> Polymorphic variants are\n            type-safe, but the typing discipline that they impose is, by\n            dint of its flexibility, less likely to catch bugs in your\n            program.\n          </blockquote>")))
 (idp7596304
  ((file variants.html)
   (html
    "<blockquote>\n<span><em>Complexity:</em></span> As we've seen, the typing\n            rules for polymorphic variants are a lot more complicated\n            than they are for regular variants. This means that heavy\n            use of polymorphic variants can leave you scratching your\n            head trying to figure out why a given piece of code did or\n            didn't compile. It can also lead to absurdly long and hard\n            to decode error messages.\n          </blockquote>")))
 (idp7595184
  ((file variants.html)
   (html
    "<blockquote>\n        In reality, regular variants are the more pragmatic choice most\n        of the time. That's because the flexibility of polymorphic\n        variants comes at a price. Here are some of the downsides.\n      </blockquote>")))
 (idp7594544
  ((file variants.html)
   (html
    "<blockquote>\n        At first glance, polymorphic variants look like a strict\n        improvement over ordinary variants. You can do everything that\n        ordinary variants can do, plus it's more flexible and more\n        concise. What's not to like?\n      </blockquote>")))
 (idp7592944
  ((file variants.html)
   (html
    "<blockquote>\n        This is useful when you want to narrow down to a type whose\n        definition is long, and you don't want the verbosity of writing\n        the tags down explicitly in the match.\n      </blockquote>")))
 (idp7590464
  ((file variants.html)
   (html
    "<blockquote>\n        Once we have type definitions at our disposal, we can revisit\n        the question of how we write the pattern-match that narrows the\n        type. In particular, we can explicitly use the type name as part\n        of the pattern match, by prefixing it with a\n        <code>#</code>.\n      </blockquote>")))
 (idp7588224
  ((file variants.html)
   (html
    "<blockquote>\n        In particular, the compiler will complain that the\n        <code>`Grey</code> case as unused.\n      </blockquote>")))
 (idp7586480
  ((file variants.html)
   (html
    "<blockquote>\n        If we add an explicit type annotation to the code itself (rather\n        than just in the mli), then the compiler has enough information\n        to warn us.\n      </blockquote>")))
 (idp7582304
  ((file variants.html)
   (html
    "<blockquote>\n        In the above code, we did something funny to the definition of\n        <code>extended_color_to_int</code>, that underlines some\n        of the downsides of polymorphic variants. In particular, we\n        added some special-case handling for the color gray, rather than\n        using <code>color_to_int</code>. Unfortunately, we\n        misspelled <code>Gray</code> as <code>Grey</code>.\n        This is exactly the kind of error that the compiler would catch\n        with ordinary variants, but with polymorphic variants, this\n        compiles without issue. All that happened was that the compiler\n        inferred a wider type for\n        <code>extended_color_to_int</code>, which happens to be\n        compatible with the narrower type that was listed in the mli.\n      </blockquote>")))
 (idp7578128
  ((file variants.html)
   (html
    "<blockquote>\n        Here, <code>extended_color</code> is defined as an\n        explicit extension of <code>color</code>. Also, notice\n        that we defined all of these types as exact variants. We can\n        implement this library as follows.\n      </blockquote>")))
 (idp7575296
  ((file variants.html)
   (html
    "<blockquote>\n        Let's consider how we might turn our code into a proper library\n        with an <code>mli</code>. Here's what the interface to\n        this file might look like.\n      </blockquote>")))
 (idp7571232
  ((file variants.html)
   (html
    "<blockquote>\n        Catch-all cases are error-prone even with ordinary variants, but\n        they are especially so with polymorphic variants. That's because\n        you have no way of bounding what tags your function might have\n        to deal with. Such code is particularly vulnerable to typos. For\n        instance, if code that uses\n        <code>is_positive_permissive</code> passes in\n        <code>Float</code> misspelled as <code>Floot</code>,\n        the erroneous code will compile without complaint.\n      </blockquote>")))
 (idp7568528
  ((file variants.html)
   (html
    "<blockquote>\n        As we saw with the definition of <code>is_positive</code>,\n        a match statement can lead to the inference of an upper bound on\n        a variant type, limiting the possible tags to those that can be\n        handled by the match. If we add a catch-all case to our match\n        statement, we end up with a function with a lower bound.\n      </blockquote>")))
 (idp7565488
  ((file variants.html)
   (html
    "<blockquote>\n        The above code is more delicately balanced than one might\n        imagine. In particular, if we use a catch-all case instead of an\n        explicit enumeration of the cases, the type is no longer\n        narrowed, and so compilation fails.\n      </blockquote>")))
 (idp7557776
  ((file variants.html)
   (html
    "<blockquote>\n        Now we can try writing <code>extended_color_to_int</code>.\n        The key issue with this code is that\n        <code>extended_color_to_int</code> needs to invoke\n        <code>color_to_int</code> with a narrower type,\n        <span><em>i.e.</em></span>, one that includes fewer tags. Written\n        properly, this narrowing can be done via a pattern match. In\n        particular, in the following code, the type of the variable\n        <code>color</code> includes only the tags\n        <code>`Basic</code>, <code>`RGB</code> and\n        <code>`Gray</code>, and not <code>`RGBA</code>.\n      </blockquote>")))
 (idp7553616
  ((file variants.html)
   (html
    "<blockquote>\n        What we want to do is to share tags between two different\n        variant types, and polymorphic variants let us do this in a\n        natural way. First, let's rewrite\n        <code>basic_color_to_int</code> and\n        <code>color_to_int</code> using polymorphic variants. The\n        translation here is pretty straightforward.\n      </blockquote>")))
 (idp7551200
  ((file variants.html)
   (html
    "<blockquote>\n        The problem is that <code>extended_color</code> and\n        <code>color</code> are in the compiler's view distinct and\n        unrelated types. The compiler doesn't, for example, recognize\n        any equality between the <code>Basic</code> tag in the two\n        types.\n      </blockquote>")))
 (idp7549200
  ((file variants.html)
   (html
    "<blockquote>\n        This looks reasonable enough, but it leads to the following type\n        error.\n      </blockquote>")))
 (idp7546064
  ((file variants.html)
   (html
    "<blockquote>\n        We want to write a function\n        <code>extended_color_to_int</code>, that works like\n        <code>color_to_int</code> for all of the old kinds of\n        colors, with new logic only for handling colors that include an\n        alpha channel. One might try to write such a function as\n        follows.\n      </blockquote>")))
 (idp7544144
  ((file variants.html)
   (html
    "<blockquote>\n        To see how to use polymorphic variants in practice, we'll return\n        to terminal colors. Imagine that we have a new terminal type\n        that adds yet more colors, say, by adding an alpha channel so\n        you can specify translucent colors. We could model this extended\n        set of colors as follows, using an ordinary variant.\n      </blockquote>")))
 (idp7539536
  ((file variants.html)
   (html
    "<blockquote>\n      Here, the inferred type states that the tags can be no more than\n      <code>`Float</code>, <code>`Int</code> and\n      <code>`Not_a_number</code>, and must contain at least\n      <code>`Float</code> and <code>`Int</code>. As you can\n      already start to see, polymorphic variants can lead to fairly\n      complex inferred types.\n    </blockquote>")))
 (idp7537632
  ((file variants.html)
   (html
    "<blockquote>\n      Perhaps surprisingly, we can also create polymorphic variant types\n      that have different upper and lower bounds.\n    </blockquote>")))
 (idp7534320
  ((file variants.html)
   (html
    "<blockquote>\n      We can think of these <code>&lt;</code> and\n      <code>&gt;</code> markers as indications of upper and lower\n      bounds on the tags involved. If the same set of tags are both an\n      upper and a lower bound, we end up with an\n      <span><em>exact</em></span> polymorphic variant type, which has\n      neither marker. For example:\n    </blockquote>")))
 (idp7531360
  ((file variants.html)
   (html
    "<blockquote>\n      The <code>&lt;</code> is there because\n      <code>is_positive</code> has no way of dealing with values\n      that have tags other than <code>`Float of float</code> or\n      <code>`Int of int</code>.\n    </blockquote>")))
 (idp7529008
  ((file variants.html)
   (html
    "<blockquote>\n      OCaml will in some cases infer a variant type with\n      <code>&lt;</code>, to indicate &quot;these tags or\n      less&quot;, as in the following example.\n    </blockquote>")))
 (idp7524928
  ((file variants.html)
   (html
    "<blockquote>\n      The <code>&gt;</code> at the beginning of the variant types\n      above is critical, because it marks the types as being open to\n      combination with other variant types. We can read the type\n      <code>[&gt; `Int of string | `Float of float]</code> as\n      describing a variant whose tags include\n      <code>`Int of string</code> and\n      <code>`Float of float</code>, but may include more tags as\n      well. In other words, you can roughly translate\n      <code>&gt;</code> to mean: &quot;these tags or more&quot;.\n    </blockquote>")))
 (idp7523040
  ((file variants.html)
   (html
    "<blockquote>\n      The type system will complain, however, if it sees incompatible\n      uses of the same tag:\n    </blockquote>")))
 (idp7522432
  ((file variants.html)
   (html
    "<blockquote>\n      As you can see, polymorphic variant types are inferred\n      automatically, and when we combine variants with different tags,\n      the compiler infers a new type that knows about all of those tags.\n    </blockquote>")))
 (idp7520176
  ((file variants.html)
   (html
    "<blockquote>\n      Syntactically, polymorphic variants are distinguished from\n      ordinary variants by the leading backtick. And unlike ordinary\n      variants, polymorphic variants can be used without an explicit\n      type declaration.\n    </blockquote>")))
 (idp7519104
  ((file variants.html)
   (html
    "<blockquote>\n      In addition to the ordinary variants we've seen so far, OCaml also\n      supports so-called <span><em>polymorphic variants</em></span>. As\n      we'll see, polymorphic variants are more flexible and\n      syntactically more lightweight than ordinary variants, but that\n      extra power comes at a cost.\n    </blockquote>")))
 (idp7517488
  ((file variants.html)
   (html
    "<blockquote>\n      More generally, using variants to build recursive data-structures\n      is a common technique, and shows up everywhere from designing\n      little languages to building efficient data-structures.\n    </blockquote>")))
 (idp7516896
  ((file variants.html)
   (html
    "<blockquote>\n      This example is more than a toy. There's a module very much in\n      this spirit already exists as part of Core, and gets a lot of\n      practical use in a variety of applications.\n    </blockquote>")))
 (idp7515344
  ((file variants.html)
   (html
    "<blockquote>\n      it's easy to see that we've missed an important case:\n      double-negation.\n    </blockquote>")))
 (idp7512944
  ((file variants.html)
   (html
    "<blockquote>\n      One thing to notice about the above code is that it uses a\n      catch-all case in the very last line within the\n      <code>Not</code> case. It's generally better to be explicit\n      about the cases you're ignoring. Indeed, if we change this snippet\n      of code to be more explicit:\n    </blockquote>")))
 (idp7510400
  ((file variants.html)
   (html
    "<blockquote>\n      Another useful operation to be able to do on expressions is\n      simplification. The following function applies some basic\n      simplification rules, most of the simplifications being driven by\n      the presence of constants.\n    </blockquote>")))
 (idp7509024
  ((file variants.html)
   (html
    "<blockquote>\n      The structure of the code is pretty straightforward --- we're just\n      pattern-matching over the structure of the data, doing the\n      appropriate calculation based on which tag we see. To use this\n      evaluator on a concrete example, we just need to write the\n      <code>base_eval</code> function which is capable of\n      evaluating a base predicate.\n    </blockquote>")))
 (idp7506016
  ((file variants.html)
   (html
    "<blockquote>\n      Being able to construct such expressions isn't enough: we also\n      need to be able to evaluate such an expression. The following code\n      shows how you could write a general-purpose evaluator for\n      <code>blang</code>'s.\n    </blockquote>")))
 (idp7503344
  ((file variants.html)
   (html
    "<blockquote>\n      Using the above, we can construct a simple expression with\n      <code>mail_predicate</code> as its base predicate.\n    </blockquote>")))
 (idp7500320
  ((file variants.html)
   (html
    "<blockquote>\n      The <code>Base</code> tag is what allows you to tie the\n      <code>blang</code> to your application, by letting you\n      specify an element of some base predicate type, whose whose truth\n      or falsehood is determined by your application. If you were\n      writing a filter language for an email processor, your base\n      predicates might specify the tests you would run against an email,\n      as in the following example.\n    </blockquote>")))
 (idp7496032
  ((file variants.html)
   (html
    "<blockquote>\n      The purpose of each tag is pretty straightforward.\n      <code>And</code>, <code>Or</code> and\n      <code>Not</code> are the basic operators for building up\n      boolean expression, and <code>Const</code> lets you enter\n      constants <code>true</code> and <code>false</code>.\n    </blockquote>")))
 (idp7493776
  ((file variants.html)
   (html
    "<blockquote>\n      Note that the definition of the type <code>blang</code> is\n      recursive, meaning that a <code>blang</code> may contain\n      other <code>blang</code>s.\n    </blockquote>")))
 (idp7491328
  ((file variants.html)
   (html
    "<blockquote>\n      An expression in this language will be defined by the variant\n      <code>blang</code> (short for &quot;boolean language&quot;)\n      with one tag for each kind of expression we want to support.\n    </blockquote>")))
 (idp7490560
  ((file variants.html)
   (html
    "<blockquote>\n      Another common application of variants is to represent tree-like\n      recursive data-structures. We'll show how this can be done by\n      walking through the design of a simple Boolean expression\n      language. Such a language can be useful anywhere you need to\n      specify filters, which are used in everything from packet\n      analyzers to mail clients.\n    </blockquote>")))
 (idp7486672
  ((file variants.html)
   (html
    "<blockquote>\n      And it's explicit at the type level that\n      <code>handle_log_entry</code> sees only\n      <code>Log_entry</code> messages,\n      <code>handle_logon</code> sees only <code>Logon</code>\n      messages, etc.\n    </blockquote>")))
 (idp7483168
  ((file variants.html)
   (html
    "<blockquote>\n      In addition, this design allows us to essentially downcast to the\n      specific message type once we know what it is, and then dispatch\n      code to handle just that message type. In particular, while we use\n      the type <code>Common.t * details</code> to represent an\n      arbitrary message, we can use\n      <code>Common.t * Logon.t</code> to represent a logon\n      message. Thus, if we had functions for handling individual message\n      types, we could write a dispatch function as follows.\n    </blockquote>")))
 (idp7482000
  ((file variants.html)
   (html
    "<blockquote>\n      Note that the more complex match statement for computing the\n      session id has been replaced with the simple expression\n      <code>common.Common.session_id</code>.\n    </blockquote>")))
 (idp7478224
  ((file variants.html)
   (html
    "<blockquote>\n      A full message can then represented as a pair of a\n      <code>Common.t</code> and a <code>details</code>.\n      Using this, we can rewrite our example above as follows:\n    </blockquote>")))
 (idp7476736
  ((file variants.html)
   (html
    "<blockquote>\n      Separately, we need a record that contains the fields that are\n      common across all messages.\n    </blockquote>")))
 (idp7475248
  ((file variants.html)
   (html
    "<blockquote>\n      We can then define a variant type that covers the different\n      possible unique components.\n    </blockquote>")))
 (idp7473424
  ((file variants.html)
   (html
    "<blockquote>\n      We can improve the code by refactoring our types to explicitly\n      separate which parts are shared and which are common. The first\n      step is to cut down the definitions of the per-message records to\n      just contain the unique components of each message.\n    </blockquote>")))
 (idp7472800
  ((file variants.html)
   (html
    "<blockquote>\n      This code effectively computes the session id for each underlying\n      message type. The repetition in this case isn't that bad, but\n      would become problematic in larger and more complicated examples.\n    </blockquote>")))
 (idp7471024
  ((file variants.html)
   (html
    "<blockquote>\n      There's one awkward bit about the code above, which is the\n      calculation of the session ids. In particular, we have the\n      following repetitive snippet of code:\n    </blockquote>")))
 (idp7468720
  ((file variants.html)
   (html "<blockquote>\n      Here's the concrete code.\n    </blockquote>")))
 (idp7467984
  ((file variants.html)
   (html
    "<blockquote>\n          the set of messages so far that are associated with the user.\n        </blockquote>")))
 (idp7467104
  ((file variants.html)
   (html
    "<blockquote>\n          the set of session identifiers for the user that have been\n          seen thus far.\n        </blockquote>")))
 (idp7465136
  ((file variants.html)
   (html
    "<blockquote>\n      You can increase the precision of your types by using variants to\n      represent differences between types, and records to represent\n      shared structure. Consider the following function that takes a\n      list of <code>client_message</code>s and returns all\n      messages generated by a given user. The code in question is\n      implemented by folding over the list of messages, where the\n      accumulator is a pair of:\n    </blockquote>")))
 (idp7460592
  ((file variants.html)
   (html
    "<blockquote>\n      A <code>client_message</code> is a <code>Logon</code>\n<span><em>or</em></span> a <code>Heartbeat</code>\n<span><em>or</em></span> a <code>Log_entry</code>. If we want\n      to write code that processes messages generically, rather than\n      code specialized to a fixed message type, we need something like\n      <code>client_message</code> to act as one overarching type\n      for the different possible messages.\n    </blockquote>")))
 (idp7454560
  ((file variants.html)
   (html
    "<blockquote>\n      This record type combines multiple pieces of data into one value.\n      In particular, a single <code>Log_entry.t</code> has a\n      <code>session_id</code> <span><em>and</em></span> a\n      <code>time</code> <span><em>and</em></span> an\n      <code>important</code> flag <span><em>and</em></span> a\n      <code>message</code>. More generally, you can think of\n      record types as acting as conjunctions. Variants, on the other\n      hand, are disjunctions, letting you represent multiple\n      possibilities, as in the following example.\n    </blockquote>")))
 (idp7451920
  ((file variants.html)
   (html
    "<blockquote>\n      Records and variants are most effective when used in concert.\n      Consider again the type <code>Log_entry.t</code>\n<a href=\"records.html\">Chapter\194\1603, <i>Records</i></a>:\n    </blockquote>")))
 (idp7449504
  ((file variants.html)
   (html
    "<blockquote>\n    But because the catch-all case encompasses all possibilities, the\n    type system will no longer warn us that we have missed the new\n    <code>Bold</code> case when we change the type to include it.\n    We can get this check back by being more explicit about what we're\n    ignoring. We haven't changed the behavior of the code, but we have\n    improved our robustness to change.\n  </blockquote>")))
 (idp7446192
  ((file variants.html)
   (html
    "<blockquote>\n    Here's an example of how a catch-all case plays in. Imagine we\n    wanted a version of <code>color_to_int</code> that works on\n    older terminals by rendering the first 16 colors (the 8\n    <code>basic_color</code>s in regular and bold) in the normal\n    way, but rendering everything else as white. We might have written\n    the function as follows.\n  </blockquote>")))
 (idp7445344
  ((file variants.html)
   (html
    "<blockquote>\n    As we've seen, the type errors identified the things that needed to\n    be fixed to complete the refactoring of the code. This is\n    fantastically useful, but for it to work well and reliably, you need\n    to write your code in a way that maximizes the compiler's chances of\n    helping you find the bugs. One important rule of thumb to follow to\n    maximize what the compiler can do for you is to avoid catch-all\n    cases in pattern matches.\n  </blockquote>")))
 (idp7443664
  ((file variants.html)
   (html
    "<blockquote>\n    Fixing this now leads us to the correct implementation.\n  </blockquote>")))
 (idp7440000
  ((file variants.html)
   (html
    "<blockquote>\n    Here, the compiler is complaining that the <code>Basic</code>\n    tag is used with the wrong number of arguments. If we fix that,\n    however, the compiler flag will flag a second problem, which is that\n    we haven't handled the new <code>Bold</code> tag.\n  </blockquote>")))
 (idp7435040
  ((file variants.html)
   (html
    "<blockquote>\n    We've essentially broken out the <code>Basic</code> case into\n    two cases, <code>Basic</code> and <code>Bold</code>, and\n    <code>Basic</code> has changed from having two arguments to\n    one. <code>color_to_int</code> as we wrote it still expects\n    the old structure of the variant, and if we try to compile that same\n    code again, the compiler will notice the discrepancy.\n  </blockquote>")))
 (idp7432832
  ((file variants.html)
   (html
    "<blockquote>\n    Consider what would happen if we were to change the definition of\n    <code>color</code> to the following.\n  </blockquote>")))
 (idp7432224
  ((file variants.html)
   (html
    "<blockquote>\n    OCaml's type system can act as a refactoring tool, by warning you of\n    places where your code needs to be updated to match an interface\n    change. This is particularly valuable in the context of variants.\n  </blockquote>")))
 (idp7430064
  ((file variants.html)
   (html
    "<blockquote>\n    Now, we can print text using the full set of available colors.\n  </blockquote>")))
 (idp7428128
  ((file variants.html)
   (html
    "<blockquote>\n    Once again, we'll use pattern matching to convert a color to a\n    corresponding integer. But in this case, the pattern matching does\n    more than separate out the different cases; it also allows us to\n    extract the data associated with each tag.\n  </blockquote>")))
 (idp7426304
  ((file variants.html)
   (html
    "<blockquote>\n    We'll also represent this more complicated color-space as a variant,\n    but this time, the different tags will have arguments which describe\n    the data available in each case.\n  </blockquote>")))
 (idp7425664
  ((file variants.html)
   (html
    "<blockquote>\n        A 24-level grayscale ramp\n      </blockquote>")))
 (idp7424768
  ((file variants.html)
   (html
    "<blockquote>\n        A 6\226\128\133\195\151\226\128\1336\226\128\133\195\151\226\128\1336 RGB color cube\n      </blockquote>")))
 (idp7423920
  ((file variants.html)
   (html
    "<blockquote>\n        The 8 basic colors, in regular and bold versions.\n      </blockquote>")))
 (idp7421840
  ((file variants.html)
   (html
    "<blockquote>\n    In this example, the cases of the variant are simple tag with no\n    associated data. This is substantively the same as the enumerations\n    found in languages like C and Java. But as we'll see, variants can\n    do considerably more than represent a simple enumeration. Indeed, an\n    enumeration isn't enough to effectively describe the full set of\n    colors that a modern terminal can display. Many terminals, including\n    the venerable <code>xterm</code>, support 256 different\n    colors, broken up into the following groups.\n  </blockquote>")))
 (idp7421232
  ((file variants.html)
   (html
    "<blockquote>\n    On most terminals, that word &quot;Blue&quot; will be rendered in\n    blue.\n  </blockquote>")))
 (idp7419168
  ((file variants.html)
   (html
    "<blockquote>\n    Using the above, we can generate escape codes to change the color of\n    a given string displayed in a terminal.\n  </blockquote>")))
 (idp7416432
  ((file variants.html)
   (html
    "<blockquote>\n    The following function uses pattern matching to convert a\n    <code>basic_color</code> to a corresponding integer. Note that\n    the exhaustiveness checking on pattern matches means that the\n    compiler will warn us if we miss a color.\n  </blockquote>")))
 (idp7414688
  ((file variants.html)
   (html
    "<blockquote>\n    Let's consider a concrete example of how variants can be useful.\n    Almost all terminals support a set of 8 basic colors, and we can\n    represent those colors using a variant. Each color is declared as a\n    simple tag, with pipes used to separate the different cases.\n  </blockquote>")))
 (idp7413872
  ((file variants.html)
   (html
    "<blockquote>\n    Variant types are one of the most useful features of OCaml, and also\n    one of the most unusual. They let you represent data that may take\n    on multiple different forms, where each form is marked by an\n    explicit tag. As we'll see, when combined with pattern matching,\n    variants give you a powerful way of representing complex data and of\n    organizing the case-analysis on that information.\n  </blockquote>")))
 (idp7288576
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          And indeed, when we provide the two positions arguments, the\n          <code>sep</code> argument is not erased, instead\n          returning a function that expects the <code>sep</code>\n          argument to be provided.\n        </blockquote>")))
 (idp7286656
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          An optional argument that doesn't have any following\n          positional arguments can't be erased at all, which leads to a\n          compiler warning.\n        </blockquote>")))
 (idp7285072
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          However, if all arguments to a function are presented at once,\n          then erasure of optional arguments isn't applied until all of\n          the arguments are passed in. This preserves our ability to\n          pass in optional arguments anywhere on the argument list.\n          Thus, we can write:\n        </blockquote>")))
 (idp7283248
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          then application of the first argument would not cause the\n          optional argument to be erased.\n        </blockquote>")))
 (idp7279872
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          The rule is: an optional argument is erased as soon as the\n          first positional argument defined <span><em>after</em></span>\n          the optional argument is passed in. That explains the behavior\n          of <code>prepend_pound</code> above. But if we had\n          instead defined <code>concat</code> with the optional\n          argument in the second position:\n        </blockquote>")))
 (idp7278384
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Note that the optional argument <code>?sep</code> has\n          now disappeared, or <span><em>erased</em></span>. So when does\n          OCaml decide to erase an optional argument?\n        </blockquote>")))
 (idp7276816
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          But what happens if we partially apply just the first\n          argument?\n        </blockquote>")))
 (idp7275184
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Optional arguments can be tricky to think about in the\n          presence of partial application. We can of course partially\n          apply the optional argument itself:\n        </blockquote>")))
 (idp7270656
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Note that if we provide an explicit type constraint for\n          <code>g</code>, that constraint decides the question of\n          what <code>g</code>'s type is, and the error disappears.\n          In the following, we do this by providing an explicit type\n          annotation.\n        </blockquote>")))
 (idp7269392
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          As suggested by the error message, we can get OCaml to accept\n          the fact that <code>f</code> is used with different\n          argument orders if we provide explicit type information. Thus,\n          we can write:\n        </blockquote>")))
 (idp7266176
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Note that these heuristics might at different points in the\n          source suggest different types. Here's a version of\n          <code>numeric_deriv</code> where the invocations of\n          <code>f</code> were changes so they list the arguments\n          in different orders.\n        </blockquote>")))
 (idp7265472
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Since there are multiple plausible types to choose from, OCaml\n          needs some heuristic for choosing between them. The heuristic\n          the compiler uses is to prefer labels to options, and to\n          choose the order of arguments that shows up in the source\n          code.\n        </blockquote>")))
 (idp7262576
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Even worse, it would be perfectly consistent for\n          <code>f</code> to take an optional argument instead of a\n          labeled one, which could lead to this type signature for\n          <code>numeric_deriv</code>:\n        </blockquote>")))
 (idp7260064
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          In principle, it's not obvious how the order of the arguments\n          to <code>f</code> should be chosen. Since optional\n          arguments can be passed in arbitrary order, it seems like it\n          could as well be\n          <code>y:float -&gt; x:float -&gt; float</code> as it is\n          <code>x:float -&gt; y:float -&gt; float</code>.\n        </blockquote>")))
 (idp7253344
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          One subtle aspect of labeled and optional arguments is how\n          they are inferred by the type system. Consider the following\n          example for computing numerical derivatives of a function of\n          two dimensions. The function takes an argument\n          <code>delta</code> which determines the scale at which\n          to compute the derivative, values <code>x</code> and\n          <code>y</code> which determine which point to compute\n          the derivative at, and the function <code>f</code> whose\n          derivative is being computed. The function\n          <code>f</code> itself takes two labeled arguments\n          <code>x</code> and <code>y</code>.\n        </blockquote>")))
 (idp7252496
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n<span><em>(yminsky: This is too abstract of an\n          example.)</em></span>\n</blockquote>")))
 (idp7248528
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Now, if someone calls <code>uppercase_concat</code>\n          without an argument, an explicit <code>None</code> will\n          be passed to <code>concat</code>, leaving\n          <code>concat</code> to decide what the default behavior\n          should be.\n        </blockquote>")))
 (idp7245088
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Instead, we can have <code>uppercase_concat</code>\n          simply pass through the optional argument to\n          <code>concat</code> using the <code>?</code>\n          syntax.\n        </blockquote>")))
 (idp7243168
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          In the way we've written it, we've been forced to separately\n          make the decision as to what the default separator is. Thus,\n          if we later change <code>concat</code>'s default\n          behavior, we'll need to remember to change\n          <code>uppercase_concat</code> to match it.\n        </blockquote>")))
 (idp7239952
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          One use-case for this is when you want to define a wrapper\n          function that mimics the optional arguments of the function\n          it's wrapping. For example, imagine we wanted to create a\n          function called <code>uppercase_concat</code>, which is\n          the same as <code>concat</code> except that it converts\n          the first string that it's passed to uppercase. We could write\n          the function as follows.\n        </blockquote>")))
 (idp7237008
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          And the following two lines are equivalent ways of calling\n          <code>concat</code> without specifying\n          <code>sep</code>.\n        </blockquote>")))
 (idp7231968
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          But sometimes, passing in <code>Some</code> or\n          <code>None</code> explicitly is exactly what you want.\n          OCaml lets you do this by using <code>?</code> instead\n          of <code>~</code> to mark the argument. Thus, the\n          following two lines are equivalent ways of specifying the\n          <code>sep</code> argument to concat.\n        </blockquote>")))
 (idp7228816
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Under the covers, a function with an optional argument\n          receives <code>None</code> when the caller doesn't\n          provide the argument, and <code>Some</code> when it\n          does. But the <code>Some</code> and\n          <code>None</code> are normally not explicitly passed in\n          by the caller.\n        </blockquote>")))
 (idp7227216
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This means that rarely used functions should not have optional\n        arguments. A good rule of thumb for optional arguments is that\n        you should never use an optional argument for internal functions\n        of a module, only for functions that are exposed as part of the\n        module's interface.\n      </blockquote>")))
 (idp7226480
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        The downside is that the caller may be unaware that there is a\n        choice to be made, and so may unknowingly (and wrongly) pick\n        that default behavior. Optional arguments really only make sense\n        when the extra concision of omitting the argument overwhelms the\n        corresponding loss of explicitness.\n      </blockquote>")))
 (idp7225744
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Optional arguments are very useful, but they're also easy to\n        abuse. The key advantage of optional arguments is that they let\n        you write functions with multiple arguments that users can\n        ignore most of the time, only worrying about them when they\n        specifically want to invoke those options.\n      </blockquote>")))
 (idp7223376
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        In the above example, we had a bit of code to substitute in the\n        empty string when no argument was provided. This is a common\n        enough pattern that there's an explicit syntax for providing a\n        default value, which allows us to write\n        <code>concat</code> even more concisely.\n      </blockquote>")))
 (idp7217920
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Here, <code>?</code> is used to mark\n        <code>sep</code> as optional. And while the caller can\n        pass a value of type <code>string</code> for\n        <code>sep</code>, internally to the function,\n        <code>sep</code> is seen as a\n        <code>string option</code>, with <code>None</code>\n        appearing when <code>sep</code> is not provided by the\n        caller.\n      </blockquote>")))
 (idp7216176
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Here's an example of a string concatenation function with an\n        optional separator.\n      </blockquote>")))
 (idp7215456
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        An optional argument is like a labeled argument that the caller\n        can choose whether or not to provide. Optional arguments are\n        passed in using the same syntax as labeled arguments, and,\n        similarly to labeled arguments, optional arguments can be\n        provided in any order.\n      </blockquote>")))
 (idp7213664
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          So, even though the order of labeled arguments usually doesn't\n          matter, it will sometimes bite you in higher-ordered contexts,\n          where you're doing things like passing functions as arguments\n          to other functions.\n        </blockquote>")))
 (idp7211504
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          But, if we go back to the original definition of\n          <code>apply_to_tuple</code>, things will work smoothly.\n        </blockquote>")))
 (idp7209232
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          we'll find that it can't be passed in to\n          <code>apply_to_tuple</code>.\n        </blockquote>")))
 (idp7207664
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          It turns out this order of listing matters. In particular, if\n          we define a function that has a different order\n        </blockquote>")))
 (idp7203392
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          Here, the definition of <code>apply_to_tuple</code> sets\n          up the expectation that its first argument is a function with\n          two labeled arguments, <code>first</code> and\n          <code>second</code>, listed in that order. We could have\n          defined <code>apply_to_tuple</code> differently to\n          change the order in which the labeled arguments were listed.\n        </blockquote>")))
 (idp7201200
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n          One surprising gotcha with labeled arguments is that while\n          order doesn't matter when calling a function with labeled\n          arguments, it does matter in a higher-order context,\n          <span><em>e.g.</em></span>, when passing a function with\n          labeled arguments to another function. Here's an example.\n        </blockquote>")))
 (idp7199392
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n            In other cases, you want to put the function argument\n            second. One common reason is readability. In particular, a\n            function that spans multiple lines is easiest to read when\n            it's the last argument provided.\n          </blockquote>")))
 (idp7196080
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n            When you want flexibility on the order in which arguments\n            are passed. Consider a function like\n            <code>List.iter</code>, that takes two arguments: a\n            function, and a list of elements to call that function on. A\n            common pattern is to partially apply\n            <code>List.iter</code> by giving it just the function,\n            as in the following example from earlier in the chapter.\n            This requires putting the function argument first.\n          </blockquote>")))
 (idp7194112
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n            but with labeled arguments, we can make the intent much\n            clearer.\n          </blockquote>")))
 (idp7191696
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n            When the meaning of a particular argument is unclear from\n            the type alone. For example, consider a function for\n            creating a hashtable where the first argument is the initial\n            size of the table, and the second argument is a flag which,\n            when true, indicates that the hashtable will reduce its size\n            when the hashtable contains few elements. The following\n            signature doesn't give you much of a hint as to the meaning\n            of the arguments.\n          </blockquote>")))
 (idp7190048
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n            This improves the readability of both the signature and of\n            client code that makes use of <code>substring</code>,\n            and makes it harder to accidentally swap the position and\n            the length.\n          </blockquote>")))
 (idp7188480
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n            where the two ints are the starting position and length of\n            the substring to extract. Labeled arguments can make this\n            signature clearer:\n          </blockquote>")))
 (idp7186896
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n            When defining functions that have multiple arguments that\n            might get confused with each other. This is most at issue\n            when the arguments are of the same type. For example,\n            consider this signature for a function for extracting a\n            substring of another string.\n          </blockquote>")))
 (idp7185936
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n            When defining a function with lots of arguments. Beyond a\n            certain number, arguments are easier to remember by name\n            than by position.\n          </blockquote>")))
 (idp7184960
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Labeled arguments are useful in a few different cases:\n      </blockquote>")))
 (idp7182320
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        OCaml also supports <span><em>label punning</em></span>, meaning\n        that you get to drop the text after the <code>:</code> if\n        the name of the label and the name of the variable being used\n        are the same. Label punning works in both function declaration\n        and function invocation, as shown in these examples:\n      </blockquote>")))
 (idp7180816
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        We can then provide a labeled argument using a similar\n        convention. As you can see, the arguments can be provided in any\n        order.\n      </blockquote>")))
 (idp7178672
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Up until now, we've written functions where the arguments are\n        specified positionally, <span><em>i.e.</em></span>, by the order\n        in which the arguments are passed to the function. OCaml also\n        supports labeled arguments, which let you identify a function\n        argument by name. Labeled arguments are declared by putting a\n        tilde in front of the label.\n      </blockquote>")))
 (idp7176544
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Also, note the use of partial application to generate the\n        function passed to <code>List.map</code>\n</blockquote>")))
 (idp7174576
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        We can also combine the different styles of function declaration\n        together, as in the following example where we declare a two\n        argument function with a pattern-match on the second argument.\n      </blockquote>")))
 (idp7171920
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This is equivalent to combining a <code>fun</code> with\n        <code>match</code>, as follows:\n      </blockquote>")))
 (idp7168864
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Another way to define a function is using the\n        <code>function</code> keyword. Instead of having syntactic\n        support for declaring curried functions,\n        <code>function</code> has built-in pattern matching.\n        Here's an example:\n      </blockquote>")))
 (idp7166784
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        The type error aside, this example highlights the importance of\n        choosing the operator you use with care, particularly with\n        respect to associativity.\n      </blockquote>")))
 (idp7163600
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        The above type error is a little bewildering at first glance.\n        What's going on is that, because <code>^!</code> is right\n        associative, the operator is trying to feed the value\n        <code>List.dedup ~compare:String.compare</code> to the\n        function <code>List.iter ~f:print_endline</code>. But\n        <code>List.iter ~f:print_endline</code> expects a list of\n        strings as its input, not a function.\n      </blockquote>")))
 (idp7160640
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Note that <code>|!</code> only works in the intended way\n        because it is left-associative. Indeed, let's see what happens\n        if we try using a right associative operator, like (^!).\n      </blockquote>")))
 (idp7159552
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        It is this later form that we're using in the\n        <code>|!</code> pipeline above.\n      </blockquote>")))
 (idp7158048
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Or, we can pass it just the function argument, leaving us with a\n        function for printing out a list of strings.\n      </blockquote>")))
 (idp7155072
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        An important part of what's happening here is partial\n        application. Normally, <code>List.iter</code> takes two\n        arguments: a function to be called on each element of the list,\n        and the list to iterate over. We can call\n        <code>List.iter</code> with all it's arguments:\n      </blockquote>")))
 (idp7152320
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        It's not quite obvious at first what the purpose of this\n        operator is: it just takes some value and a function, and\n        applies the function to the value. But its utility is clearer\n        when you see it in action. It works as a kind of sequencing\n        operator, similar in spirit to using pipe in the UNIX shell.\n        Consider, for example, the following code for printing out the\n        unique elements of your <code>PATH</code>.\n      </blockquote>")))
 (idp7150816
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Here's an example of a very useful operator that's defined in\n        Core, following these rules. Here's the definition:\n      </blockquote>")))
 (idp7130944
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        The syntactic role of an operator work is determined by its\n        first character. This table describes how, and lists the\n        operators from highest to lowest precedence.\n      </blockquote>")))
 (idp7129360
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        We can define (or redefine) the meaning of an operator as\n        follows. Here's an example of a simple vector-addition operator\n        on int pairs.\n      </blockquote>")))
 (idp7127392
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        or is one of a handful of pre-determined strings, including\n        <code>mod</code>, the modulus operator, and\n        <code>lsl</code>, for &quot;logical shift left&quot;, a\n        bit-shifting operation.\n      </blockquote>")))
 (idp7126016
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        A function is treated syntactically as an operator if the name\n        of that function is chosen from one of a specialized set of\n        identifiers. This set includes any identifier that is a sequence\n        of characters from the following set\n      </blockquote>")))
 (idp7124128
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        In the second expression above, we've partially applied\n        <code>(+)</code> to gain a function that increments its\n        single argument by <code>3</code>, and then applied that\n        to all the elements of a list.\n      </blockquote>")))
 (idp7121808
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        You might not have thought of the second example as an ordinary\n        function, but it very much is. Infix operators like\n        <code>+</code> really only differ syntactically from other\n        functions. In fact, if we put parenthesis around an infix\n        operator, you can use it as an ordinary prefix function.\n      </blockquote>")))
 (idp7120352
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        So far, we've seen examples of functions used in both prefix and\n        infix style:\n      </blockquote>")))
 (idp7118080
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Note that in the above example, we take advantage of the fact\n        that the right hand side of <code>||</code> is evaluated\n        lazily, only being executed if the left hand side evaluates to\n        false.\n      </blockquote>")))
 (idp7114352
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        We can also define multiple mutually recursive values by using\n        <code>let rec</code> and <code>and</code> together,\n        as in this (gratuitously inefficient) example.\n      </blockquote>")))
 (idp7111920
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        In order to define a recursive function, you need to mark the\n        let binding as recursive with the <code>rec</code>\n        keyword, as shown in this example:\n      </blockquote>")))
 (idp7110960
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        A function is <span><em>recursive</em></span> if it refers to\n        itself in its definition. Recursion is important in any\n        programming language, but is particularly important in\n        functional languages.\n      </blockquote>")))
 (idp7109360
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        There are small tradeoffs between these two approaches, but most\n        of the time, one should stick to currying, since it's the\n        default style in the OCaml world.\n      </blockquote>")))
 (idp7108736
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        OCaml handles this calling convention efficiently as well. In\n        particular it does not generally have to allocate a tuple just\n        for the purpose of sending arguments to a tuple-style function.\n      </blockquote>")))
 (idp7107120
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Currying is not the only way of writing a multi-argument\n        function in OCaml. It's also possible to use the different arms\n        of a tuple as different arguments. So, we could write:\n      </blockquote>")))
 (idp7106432
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        You might worry that curried functions are terribly expensive,\n        but this is not the case. In OCaml, there is no penalty for\n        calling a curried function with all of its arguments. (Partial\n        application, unsurprisingly, does have a small extra cost.)\n      </blockquote>")))
 (idp7103744
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Note that the <code>fun</code> keyword supports its own\n        syntactic sugar for currying, so we could also have written\n        <code>abs_diff</code> as follows.\n      </blockquote>")))
 (idp7102848
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        The practice of applying some of the arguments of a curried\n        function to get a new function is called <span><em>partial\n        application</em></span>.\n      </blockquote>")))
 (idp7099632
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Currying is more than just a theoretical curiosity. You can make\n        use of currying to specialize a function by feeding in some of\n        the arguments. Here's an example where we create a specialized\n        version of <code>abs_diff</code> that measures the\n        distance of a given number from <code>3</code>.\n      </blockquote>")))
 (idp7096272
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This style of function is called a <span><em>curried</em></span>\n        function. (Currying is named after Haskell Curry, a famous\n        logician who had a significant impact on the design and theory\n        of programming languages.) The key to interpreting the type\n        signature of a curried function is the observation that\n        <code>-&gt;</code> is right-associative. The type\n        signature of <code>abs_diff</code> can therefore be\n        parenthesized as follows. This doesn't change the meaning of the\n        signature, but it makes it easier to see how the currying fits\n        in.\n      </blockquote>")))
 (idp7093072
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This rewrite makes it explicit that <code>abs_diff</code>\n        is actually a function of one argument that returns another\n        function of one argument, which itself returns the final\n        computation. Because the functions are nested, the inner\n        expression <code>abs (x - y)</code> has access to both\n        <code>x</code>, which was captured by the first function\n        application, and <code>y</code>, which was captured by the\n        second one.\n      </blockquote>")))
 (idp7089600
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        You may find the type signature of <code>abs_diff</code>\n        with all of its arrows a little hard to parse. To understand\n        what's going on, let's rewrite <code>abs_diff</code> in an\n        equivalent form, using the <code>fun</code> keyword:\n      </blockquote>")))
 (idp7087600
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        OCaml of course also supports multi-argument functions. Here's\n        an example that came up in\n        <a href=\"a-guided-tour.html\">Chapter\194\1601, <i>A Guided Tour</i></a>.\n      </blockquote>")))
 (idp7085440
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This connection is important, and will come up more when\n        programming in a monadic style, as we'll see in\n        <a href=\"\">???</a>.\n      </blockquote>")))
 (idp7083728
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Functions and let bindings have a lot to do with each other. In\n        some sense, you can think of the argument of a function as a\n        variable being bound to its argument. Indeed, the following two\n        expressions are nearly equivalent:\n      </blockquote>")))
 (idp7081248
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This is the most common and convenient way to declare a\n        function, but syntactic niceties aside, the two styles of\n        function definition are entirely equivalent.\n      </blockquote>")))
 (idp7079744
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Defining named functions is so common that there is some built\n        in syntactic sugar for it. Thus, we can write:\n      </blockquote>")))
 (idp7077904
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        The key thing to understand is that functions are ordinary\n        values in OCaml, and you can do everything with them that you'd\n        do with an ordinary value, including passing them to and\n        returning them from other functions and storing them in\n        datastructures. We even name functions in the same way that we\n        name other values, by using a let binding.\n      </blockquote>")))
 (idp7073888
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        It's worth stopping for a moment to puzzle this example out,\n        since this kind of higher-order use of functions can be a bit\n        obscure at first. The first thing to understand is the function\n        <code>(fun f -&gt; f 5)</code>, which takes a function as\n        its argument and applies that function to the number\n        <code>5</code>. The invocation of\n        <code>List.map</code> applies\n        <code>(fun f -&gt; f 5)</code> to the elements of the\n        <code>increments</code> list (which are themselves\n        functions) and returns the list containing the results of these\n        function applications.\n      </blockquote>")))
 (idp7072352
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Or even stuff them into a datastructure.\n      </blockquote>")))
 (idp7070896
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Or pass it to another function.\n      </blockquote>")))
 (idp7069328
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Anonymous functions aren't named, but they can be used for many\n        different purposes nonetheless. You can, for example, apply an\n        anonymous function to an argument:\n      </blockquote>")))
 (idp7066784
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        We'll start by looking at the most basic form of OCaml function,\n        the <span><em>anonymous</em></span> function. Anonymous functions\n        are declared using the <code>fun</code> keyword, as\n        follows.\n      </blockquote>")))
 (idp7065104
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      OCaml being a functional language, it's no surprise that functions\n      are an important and pervasive element of programming in OCaml.\n      Indeed, we've seen functions pop up already in many of the\n      examples we've looked at thus far. But while we've introduced the\n      basics of functions, we're now going to cover them in more depth,\n      starting from the foundations.\n    </blockquote>")))
 (idp7062128
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Note that when doing a\n        <code>let</code>/<code>and</code> style declaration,\n        the order of execution of the right-hand side of the binds is\n        undefined by the language definition, so one should not write\n        code that relies on it.\n      </blockquote>")))
 (idp7060864
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This use-case doesn't come up that often. Most of the time that\n        <code>and</code> comes into play, it's used to define\n        multiple mutually recursive values, which we'll learn about\n        later in the chapter.\n      </blockquote>")))
 (idp7058048
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This can be useful when you want to create a number of new let\n        bindings at once, without having each definition affect the\n        next. So, if we wanted to create new bindings that swapped the\n        values of <code>x</code> and <code>y</code>, we\n        could write:\n      </blockquote>")))
 (idp7055888
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Another variant on the let binding is the use of\n        <code>and</code> to join multiple variable definitions\n        into a single declaration. For example, we can write:\n      </blockquote>")))
 (idp7051168
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This case can't really come up in practice, because\n        <code>String.split</code> always returns a list with at\n        least one element. But the compiler doesn't know this, and so it\n        emits the warning. It's generally better to use a match\n        statement to handle such cases explicitly:\n      </blockquote>")))
 (idp7047600
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        This actually binds two variables, one for each element of the\n        pair. Using a pattern in a let-binding makes the most sense for\n        a pattern that is <span><em>irrefutable</em></span>,\n        <span><em>i.e.</em></span>, where any value of the type in\n        question is guaranteed to match the pattern. Tuple and record\n        patterns are irrefutable, but list patterns are not. Consider\n        the following code that implements a function for up-casing the\n        first element of a comma-separate list.\n      </blockquote>")))
 (idp7045136
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n        Another useful feature of let bindings is that they support the\n        use of patterns on the left-hand side of the bind. Consider the\n        following code, which uses <code>List.unzip</code>, a\n        function for converting a list of pairs into a pair of lists.\n      </blockquote>")))
 (idp7042704
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      In OCaml, let bindings are immutable. As we'll see in\n      <a href=\"a-guided-tour.html#imperative-programming\">the section called \226\128\156Imperative programming\226\128\157</a>, there are\n      mutable values in OCaml, but no mutable variables.\n    </blockquote>")))
 (idp7037088
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      Here, we redefined <code>pi</code> to be zero after the\n      definition of <code>area_of_circle</code>. You might think\n      that this would mean that the result of the computation would now\n      be zero, but you'd be wrong. In fact, the behavior of the function\n      is unchanged. That's because the original definition of\n      <code>pi</code> wasn't changed, it was just shadowed, so\n      that any subsequent reference to <code>pi</code> would see\n      the new definition of <code>pi</code> as zero. But there is\n      no later use of <code>pi</code>, so the binding doesn't make\n      a difference. Indeed, if you type the example I gave above into\n      the toplevel, OCaml will warn you that the definition is unused.\n    </blockquote>")))
 (idp7034720
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      It's important not to confuse this sequence of let bindings with\n      the modification of a mutable variable. How would\n      <code>area_of_ring</code> be different, for example, if we\n      had instead written this purposefully confusing bit of code:\n    </blockquote>")))
 (idp7031776
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      One common idiom is to use a series of nested\n      <code>let</code>/<code>in</code> expressions to build\n      up the components of a larger computation. Thus, we might write:\n    </blockquote>")))
 (idp7027728
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      This time, in the inner scope we called the list of strings\n      <code>languages</code> instead of\n      <code>language_list</code>, thus hiding the original\n      definition of <code>languages</code>. But once the\n      definition of <code>dashed_languages</code> is complete, the\n      inner scope has closed and the original definition of languages\n      reappears.\n    </blockquote>")))
 (idp7024848
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      A let binding in an inner scope can <span><em>shadow</em></span>,\n      or hide, the definition from an outer scope. So, for example, we\n      could have written the <code>dashed_languages</code> example\n      as follows:\n    </blockquote>")))
 (idp7022112
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      Note that the scope of <code>language_list</code> is just\n      the expression\n      <code>String.concat ~sep:&quot;-&quot; language_list</code>,\n      and is not available at the top-level, as we can see if we try to\n      access it now.\n    </blockquote>")))
 (idp7017264
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      This first evaluates <span><em><code>expr1</code></em></span>\n      and then evaluates <span><em><code>expr2</code></em></span>\n      with <span><em><code>identifier</code></em></span> bound to\n      whatever value was produced by the evaluation of\n      <span><em><code>expr1</code></em></span>. Here's how it looks\n      in practice.\n    </blockquote>")))
 (idp7015232
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n<code>let</code> can also be used to create a variable\n      binding whose scope is limited to a particular expression, using\n      the following syntax.\n    </blockquote>")))
 (idp7013872
  ((file variables-and-functions.html)
   (html "<blockquote>\n      Here's a simple example.\n    </blockquote>")))
 (idp7012864
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      Every variable binding has a <span><em>scope</em></span>, which is\n      the portion of the code that can refer to that binding. The scope\n      of a top-level let binding is everything that follows it in the\n      top-level session (or in the remainder of the module).\n    </blockquote>")))
 (idp7011808
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      As we'll see when we get to the module system in\n      <a href=\"\">???</a>, this same\n      syntax is used for top-level definitions in a module.\n    </blockquote>")))
 (idp7009632
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n      At its simplest, a variable is an identifier whose meaning is\n      bound to a particular value. In OCaml these bindings are often\n      introduced using the <code>let</code> keyword. When typed in\n      at the prompt of the interpreter, a let binding has the following\n      syntax.\n    </blockquote>")))
 (idp7008032
  ((file variables-and-functions.html)
   (html
    "<blockquote>\n    Variables and functions are fundamental ideas that show up in\n    virtually all programming languages. But OCaml has a different take\n    on these basic concepts, and so we'll spend some time digging into\n    the details of OCaml's variables and functions differ from what you\n    may have seen elsewhere.\n  </blockquote>")))
 (idp7412192
  ((file records.html)
   (html
    "<blockquote>\n      Field iterators are useful for a variety of tasks, from building\n      validation functions to scaffolding the definition of a web-form\n      based on a record type, all with a guarantee that you've\n      exhaustively considered all elements of the field.\n    </blockquote>")))
 (idp7410352
  ((file records.html)
   (html
    "<blockquote>\n      The advantage of using field iterators is that when the definition\n      of <code>Logon</code> changes, <code>iter</code> will\n      change along with it, prompting you to handle whatever new cases\n      arise.\n    </blockquote>")))
 (idp7404496
  ((file records.html)
   (html
    "<blockquote>\n<code>fieldslib</code> also provides higher-level operators,\n      like <code>Fields.fold</code> and\n      <code>Fields.iter</code>, which let you iterate over all the\n      fields of a record. The following function uses\n      <code>Logon.Fields.iter</code> and\n      <code>show_field</code> to print out all the fields of a\n      <code>Logon</code> record.\n    </blockquote>")))
 (idp7401856
  ((file records.html)
   (html
    "<blockquote>\n      Here's an example of <code>show_field</code> in action.\n    </blockquote>")))
 (idp7398640
  ((file records.html)
   (html
    "<blockquote>\n      We can use these first class fields to do things like write a\n      generic function for displaying a record field. The function\n      <code>show_field</code> takes three arguments: the\n      <code>Field.t</code>, a function for converting the contents\n      of the field in question to a string, and the record type.\n    </blockquote>")))
 (idp7397856
  ((file records.html)
   (html
    "<blockquote>\n          The (optional) ability to set the record field, which is\n          present only if the field is mutable.\n        </blockquote>")))
 (idp7397008
  ((file records.html)
   (html
    "<blockquote>\n          The ability to do a functional update of that field\n        </blockquote>")))
 (idp7396240
  ((file records.html)
   (html
    "<blockquote>\n          The ability to extract the field\n        </blockquote>")))
 (idp7395472
  ((file records.html)
   (html
    "<blockquote>\n          The name of the field as a string\n        </blockquote>")))
 (idp7391808
  ((file records.html)
   (html
    "<blockquote>\n      In addition to generating field accessor functions,\n      <code>fieldslib</code> also creates a sub-module called\n      <code>Fields</code> that contains a first class\n      representative of each field, in the form of a value of type\n      <code>Field.t</code>. A <code>Field.t</code> bundles\n      up the following functionality of a record filed:\n    </blockquote>")))
 (idp7389552
  ((file records.html)
   (html
    "<blockquote>\n      Given that definition, we can use the function\n      <code>Logon.user</code> to extract the user field from a\n      logon message.\n    </blockquote>")))
 (idp7386112
  ((file records.html)
   (html
    "<blockquote>\n<code>fieldslib</code> is invoked by putting the\n      <code>with fields</code> annotation at the end of the\n      declaration of a record type. So, for example, we could have\n      defined <code>Logon</code> as follows.\n    </blockquote>")))
 (idp7382992
  ((file records.html)
   (html
    "<blockquote>\n      Here, we wrote a small function\n      <code>(fun x -&gt; x.Logon.user)</code> to access the\n      <code>user</code> field. This kind of accessor function is a\n      common enough pattern that that it would be convenient to generate\n      them automatically. The <code>fieldslib</code> syntax\n      extension that ships with <code>Core</code> does just that.\n    </blockquote>")))
 (idp7380704
  ((file records.html)
   (html
    "<blockquote>\n      Consider the following function for extracting the usernames from\n      a list of <code>Logon</code> messages.\n    </blockquote>")))
 (idp7378592
  ((file records.html)
   (html
    "<blockquote>\n      OCaml's policy of immutable-by-default is a good one, but\n      imperative programming does have its place. We'll discuss more\n      about how (and when) to use OCaml's imperative features in\n      <a href=\"a-guided-tour.html#imperative-programming\">the section called \226\128\156Imperative programming\226\128\157</a>.\n    </blockquote>")))
 (idp7377408
  ((file records.html)
   (html
    "<blockquote>\n      Note that <code>&lt;-</code> is not needed for\n      initialization, because all fields of a record, including mutable\n      ones, must be specified when the record is created.\n    </blockquote>")))
 (idp7374400
  ((file records.html)
   (html
    "<blockquote>\n      We then use the <code>&lt;-</code> operator for actually\n      changing the state. The side-effecting version of\n      <code>register_heartbeat</code> would be written as follows.\n    </blockquote>")))
 (idp7372000
  ((file records.html)
   (html
    "<blockquote>\n      Like most OCaml values, records are immutable by default. You can,\n      however, declare individual record fields as mutable. For example,\n      we could take the <code>client_info</code> type and make the\n      fields that may need to change over time mutable, as follows.\n    </blockquote>")))
 (idp7368608
  ((file records.html)
   (html
    "<blockquote>\n      The original implementation of\n      <code>register_heartbeat</code> would now be invalid, and\n      thus the compiler would warn us to think about how to handle this\n      new field. But the version using a functional update continues to\n      compile as is, even though it incorrectly ignores the new field.\n      The correct thing to do would be to update the code as follows.\n    </blockquote>")))
 (idp7366624
  ((file records.html)
   (html
    "<blockquote>\n      Functional updates make your code independent of the identity of\n      the fields in the record that are not changing. This is often what\n      you want, but it has downsides as well. In particular, if you\n      change the definition of your record to have more fields, the type\n      system will not prompt you to reconsider whether your update code\n      should affect those fields. Consider what happens if we decided to\n      add a field for the status message received on the last heartbeat.\n    </blockquote>")))
 (idp7364640
  ((file records.html)
   (html
    "<blockquote>\n      Given this, we can rewrite <code>register_heartbeat</code>\n      more concisely.\n    </blockquote>")))
 (idp7364080
  ((file records.html)
   (html
    "<blockquote>\n      The purpose of the functional update is to create a new record\n      based on an existing one, with a set of field changes layered on\n      top.\n    </blockquote>")))
 (idp7361392
  ((file records.html)
   (html
    "<blockquote>\n      This is fairly verbose, given that there's only one field that we\n      actually want to change, and all the others are just being copied\n      over from <code>t</code>. We can use OCaml's\n      <span><em>functional update</em></span> syntax to do this more\n      tersely. The syntax of a functional update is as follows.\n    </blockquote>")))
 (idp7358816
  ((file records.html)
   (html
    "<blockquote>\n      Fairly often, you will find yourself wanting to create a new\n      record that differs from an existing record in only a subset of\n      the fields. For example, imagine our logging server had a record\n      type for representing the state of a given client, including when\n      the last heartbeat was received from that client. The following\n      defines a type for representing this information, as well as a\n      function for updating the client information when a new heartbeat\n      arrives.\n    </blockquote>")))
 (idp7357168
  ((file records.html)
   (html
    "<blockquote>\n      For functions defined within the module where a given record is\n      defined, the module qualification goes away entirely. And indeed,\n      for things like constructors, defining it within the module is\n      often the best solution.\n    </blockquote>")))
 (idp7354016
  ((file records.html)
   (html
    "<blockquote>\n      The module name <code>Log_entry</code> is required to\n      qualify the fields, because this function is outside of the\n      <code>Log_entry</code> module where the record was defined.\n      OCaml only requires the module qualification for one record field,\n      however, so we can write this more concisely.\n    </blockquote>")))
 (idp7352224
  ((file records.html)
   (html
    "<blockquote>\n      Now, our heartbeat-creation function can be rendered as follows.\n    </blockquote>")))
 (idp7350272
  ((file records.html)
   (html
    "<blockquote>\n      Another approach is to mint a module for each type. This is\n      actually a broadly useful idiom, providing for each type a\n      namespace within which to put related values. Using this style we\n      would write:\n    </blockquote>")))
 (idp7349680
  ((file records.html)
   (html
    "<blockquote>\n      This eliminates the collisions and is simple enough to do. But it\n      leaves you with awkwardly named record fields, and adds needless\n      repetition and verbosity to your code.\n    </blockquote>")))
 (idp7347824
  ((file records.html)
   (html
    "<blockquote>\n      There are two common solutions to this problem. The first is to\n      add a prefix to each field name to make it unique, as shown below.\n    </blockquote>")))
 (idp7341584
  ((file records.html)
   (html
    "<blockquote>\n      The problem is that the declaration of <code>logon</code>\n      (and <code>heartbeat</code>) shadowed some of the fields of\n      <code>log_entry</code>. As a result, the fields\n      <code>time</code> and <code>session_id</code> are\n      assumed to be fields of <code>logon</code>, and\n      <code>important</code> and <code>message</code>, which\n      were not shadowed, are assumed to be fields of\n      <code>log_entry</code>. The compiler therefore complains\n      that we're trying to construct a record with fields from two\n      different record types.\n    </blockquote>")))
 (idp7339808
  ((file records.html)
   (html
    "<blockquote>\n      The fact that we reused field names will cause trouble when we try\n      to construct a message.\n    </blockquote>")))
 (idp7335808
  ((file records.html)
   (html
    "<blockquote>\n      Below, the <code>log_entry</code> message is used to deliver\n      a log entry to the server for processing. The\n      <code>logon</code> message is sent when a client initiates a\n      connection, and includes the identity of the user connecting and\n      credentials used for authentication. Finally, the\n      <code>heartbeat</code> message is periodically sent by the\n      client to demonstrate to the server that the client is alive and\n      connected. All of these messages include a session id and the time\n      the message was generated.\n    </blockquote>")))
 (idp7335136
  ((file records.html)
   (html
    "<blockquote>\n      Defining records with the same field names can be problematic.\n      Let's consider a simple example: building types to represent the\n      protocol used for a logging server. The following types represent\n      messages a server might receive from a client.\n    </blockquote>")))
 (idp7333408
  ((file records.html)
   (html
    "<blockquote>\n      Together, labeled arguments, field names, and field and label\n      punning, encourage a style where you propagate the same names\n      throughout your code-base. This is generally good practice, since\n      it encourages consistent naming, which makes it easier for new\n      people to navigate your source.\n    </blockquote>")))
 (idp7331776
  ((file records.html)
   (html
    "<blockquote>\n      This is considerably more concise than what you would get without\n      punning at all.\n    </blockquote>")))
 (idp7330160
  ((file records.html)
   (html
    "<blockquote>\n      You can take advantage of both field punning and label punning\n      when writing a function for constructing a record from labeled\n      arguments, as shown below.\n    </blockquote>")))
 (idp7329568
  ((file records.html)
   (html
    "<blockquote>\n      In the above code, we defined variables corresponding to the\n      record fields first, and then the record declaration itself simply\n      listed the fields that needed to be included.\n    </blockquote>")))
 (idp7326912
  ((file records.html)
   (html
    "<blockquote>\n      Field punning can also be used to construct a record. Consider the\n      following code for generating a <code>host_info</code>\n      record.\n    </blockquote>")))
 (idp7324448
  ((file records.html)
   (html
    "<blockquote>\n      When the name of a variable coincides with the name of a record\n      field, OCaml provides some handy syntactic shortcuts. For example,\n      the pattern in the following function binds all of the fields in\n      question to variables of the same name. This is called\n      <span><em>field punning</em></span>.\n    </blockquote>")))
 (idp7322272
  ((file records.html)
   (html
    "<blockquote>\n      Generally, the right default is to turn the warning for incomplete\n      record matches on, and to explicitly disable it with an\n      <code>_</code> where necessary.\n    </blockquote>")))
 (idp7320512
  ((file records.html)
   (html
    "<blockquote>\n      We can disable the warning for a given pattern by explicitly\n      acknowledging that we are ignoring extra fields. This is done by\n      adding an underscore to the pattern, as shown below.\n    </blockquote>")))
 (idp7317024
  ((file records.html)
   (html
    "<blockquote>\n      Happily, OCaml does offer an optional warning for missing fields\n      in a record pattern. With that warning turned on (which you can do\n      in the toplevel by typing\n      <code>#warnings &quot;+9&quot;</code>), the compiler will\n      warn about the missing field.\n    </blockquote>")))
 (idp7315088
  ((file records.html)
   (html
    "<blockquote>\n      The code for <code>host_info_to_string</code> would continue\n      to compile without change. In this particular case, it's pretty\n      clear that you might want to update\n      <code>host_info_to_string</code> in order to take into\n      account the new field, and it would be nice if the type system\n      would give you a warning about the change.\n    </blockquote>")))
 (idp7312320
  ((file records.html)
   (html
    "<blockquote>\n      As an example, imagine that we wanted to add a new field to our\n      <code>host_info</code> record called\n      <code>os_version</code>, as shown below.\n    </blockquote>")))
 (idp7311472
  ((file records.html)
   (html
    "<blockquote>\n      Another important characteristic of record patterns is that they\n      don't need to be complete; a pattern can mention only a subset of\n      the fields in the record. This can be convenient, but it's can\n      also be error prone. In particular, this means that when new\n      fields are added to the record, code that should be updated to\n      react to the presence of those new fields will not be flagged by\n      the compiler.\n    </blockquote>")))
 (idp7309520
  ((file records.html)
   (html
    "<blockquote>\n      Note that the pattern that we used had only a single case, rather\n      than using several cases separated by <code>|</code>s. We\n      only needed a single pattern because record patterns are\n      <span><em>irrefutable</em></span>, meaning that, because the layout\n      of a record is always the same, a record pattern match will never\n      fail at runtime. In general, types with a fixed structure, like\n      records and tuples, have irrefutable patterns, whereas types with\n      variable structure, like lists and variants, do not.\n    </blockquote>")))
 (idp7306848
  ((file records.html)
   (html
    "<blockquote>\n      Another way of getting information out of a record is by using a\n      pattern match, as in the definition of\n      <code>host_info_to_string</code> below.\n    </blockquote>")))
 (idp7304496
  ((file records.html)
   (html
    "<blockquote>\n    Once we have a record value in hand, we can extract elements from\n    the record field using dot-notation.\n  </blockquote>")))
 (idp7302432
  ((file records.html)
   (html
    "<blockquote>\n    You might wonder how the compiler inferred that\n    <code>my_host</code> is of type <code>host_info</code>.\n    The hook that the compiler uses in this case to figure out the type\n    is the record field names. It turns out that, within a given scope,\n    each record field name is associated with a unique record type.\n    Later in the chapter, we'll talk about what to do when you want to\n    have the same record fields in multiple records.\n  </blockquote>")))
 (idp7298368
  ((file records.html)
   (html
    "<blockquote>\n    We can construct a <code>host_info</code> just as easily. The\n    following code uses the <code>Shell</code> module from\n    <code>Core_extended</code> to dispatch commands to the shell\n    to extract the information we need about the computer we're running\n    on.\n  </blockquote>")))
 (idp7296256
  ((file records.html)
   (html
    "<blockquote>\n    Here's a simple example, a <code>host_info</code> record that\n    summarizes information about a given computer.\n  </blockquote>")))
 (idp7294640
  ((file records.html)
   (html
    "<blockquote>\n    A record represents a collection of values stored together as one,\n    where each component is identified by a different field name. The\n    basic syntax for a record type declaration is as follows.\n  </blockquote>")))
 (idp7292624
  ((file records.html)
   (html
    "<blockquote>\n    One of OCaml's best features is its concise and expressive system\n    for declaring new datatypes. Two key elements of that system are\n    <span><em>records</em></span> and <span><em>variants</em></span>, both\n    of which we discussed briefly in\n    <a href=\"a-guided-tour.html\">Chapter\194\1601, <i>A Guided Tour</i></a>. In this chapter we'll\n    cover records in more depth, covering more of the details of how\n    they work, as well as advice on how to use them effectively in your\n    software designs.\n  </blockquote>")))
 (idp9100064
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        The mixin pattern isn't limited to non-polymorphic classes, of\n        course. We can use it to implement generic features as well. The\n        following mixin defines functional-style iteration in terms of\n        the imperative iterator pattern.\n      </blockquote>")))
 (idp9097904
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        In this particular case, the mixin works only for a collection\n        of integers, so we can't add the mixin to the polymorphic class\n        definition <code>['a] slist</code> itself. However, the\n        result of using the mixin is that the integer collection has a\n        method <code>sum</code>, and it is done with very little\n        of the fuss we would need if we used object composition instead.\n      </blockquote>")))
 (idp9095424
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        The collections are different is some ways, but they share a\n        common pattern for iteration that we can re-use. For a simple\n        example, let's define a mixin that implements an arithmetic sum\n        for a collection of integers.\n      </blockquote>")))
 (idp9091984
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        That's too abstract, so let's give an example based on\n        collections. In Section XXX:Objecttypes, we introduced the\n        <span><em>iterator</em></span> pattern, where an\n        <span><em>iterator</em></span> object is used to enumerate the\n        elements of a collection. Lots of containers can have iterators,\n        singly-linked lists, dictionaries, vectors, etc.\n      </blockquote>")))
 (idp9087696
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        In any case, if you're programming with objects, there's one\n        general pattern for multiple inheritance that is both useful and\n        reasonably simple, the <span><em>mixin</em></span> pattern.\n        Generically, a <span><em>mixin</em></span> is just a virtual\n        class that implements a feature based on another one. If you\n        have a class that implements methods <span><em>A</em></span>, and\n        you have a mixin <span><em>M</em></span> that provides methods\n        <span><em>B</em></span> from <span><em>A</em></span>, then you can\n        inherit from <span><em>M</em></span> -- &quot;mixing&quot; it in\n        -- to get features <span><em>B</em></span>.\n      </blockquote>")))
 (idp9086816
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        When should you use multiple inheritance? If you ask multiple\n        people, you're likely to get multiple (perhaps heated) answers.\n        Some will argue that multiple inheritance is overly complicated;\n        others will argue that inheritance is problematic in general,\n        and one should use object composition instead. But regardless of\n        who you talk to, you will rarely hear that multiple inheritance\n        is great and you should use it widely.\n      </blockquote>")))
 (idp9078016
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        To reiterate, to understand what inheritance means, replace each\n        <code>inherit</code> directive with its definition, and\n        take the last definition of each method or field. This holds\n        even for private methods. However, it does\n        <span><em>not</em></span> hold for private methods that are\n        &quot;really&quot; private, meaning that they have been hidden\n        by a type constraint. In the following definitions, there are\n        three definitions of the private method <code>g</code>.\n        However, the definition of <code>g</code> in\n        <code>m8</code> is not overridden, because it is not part\n        of the class type for <code>m8</code>.\n      </blockquote>")))
 (idp9074272
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Of course, it is unlikely that you will define two methods or\n        two fields of the same name in the same class. However, the\n        rules for inheritance follow the same pattern: the last\n        definition wins. In the following definition, the\n        <code>inherit</code> declaration comes last, so the method\n        definition <code>method get = 2</code> overrides the\n        previous definition, always returning 2.\n      </blockquote>")))
 (idp9072448
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Fields have similar behavior, though the compiler produces a\n        warning message about the override.\n      </blockquote>")))
 (idp9069808
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        First, let's consider what happens when we define a method more\n        than once. In the following example, the method\n        <code>get</code> is defined twice; the second definition\n        &quot;wins,&quot; meaning that it overrides the first one.\n      </blockquote>")))
 (idp9069120
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        If there is one thing to remember about inheritance in OCaml, it\n        is this: inheritance is like textual inclusion. If there is more\n        than one definition for a name, the last definition wins. Let's\n        look at some artificial, but illustrative, examples.\n      </blockquote>")))
 (idp9068336
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        The main &quot;trickiness&quot; of multiple inheritance is due\n        to naming -- what happens when a method or field with some name\n        is defined in more than one class?\n      </blockquote>")))
 (idp9065952
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      When a class inherits from more than one superclass, it is using\n      <span><em>multiple inheritance</em></span>. Multiple inheritance\n      extends the variety of ways in which classes can be combined, and\n      it can be quite useful, particularly with virtual classes.\n      However, it can be tricky to use, particularly when the\n      inheritance hierarchy is a graph rather than a tree, so it should\n      be used with care.\n    </blockquote>")))
 (idp9063232
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      This level of dependency on the implementation details is\n      possible, but it is hard to justify the use of a virtual class --\n      why not just define the <code>swap</code> method as part of\n      the concrete class? Virtual classes are better suited for\n      situations where there are multiple (useful) implementations of\n      the virtual parts. In most cases, this will be public virtual\n      methods.\n    </blockquote>")))
 (idp9061392
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      We've been mentioning that fields can be virtual too. Here is\n      another implementation of the swapper, this time with direct\n      access to the array of values.\n    </blockquote>")))
 (idp9059632
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      One way to view a <code>virtual</code> class is that it is\n      like a functor, where the &quot;inputs&quot; are the declared, but\n      not defined, virtual methods and fields. The functor application\n      is implemented through inheritance, when virtual methods are given\n      concrete implementations.\n    </blockquote>")))
 (idp9057136
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      Here's a different implementation using\n      <code>HashTbl</code>.\n    </blockquote>")))
 (idp9052944
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      At some future time, we may settle on a concrete implementation\n      for the vector. We can inherit from the\n      <code>abstract_swappable_bvector</code> to get the\n      <code>swap</code> method &quot;for free.&quot; Here's one\n      implementation using arrays.\n    </blockquote>")))
 (idp9048016
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      One way to do this is to declare the\n      <code>swappable_vector</code> abstractly, declaring the\n      methods <code>get</code> and <code>set</code>, but\n      leaving the implementation for later. However, the\n      <code>swap</code> method can be defined immediately.\n    </blockquote>")))
 (idp9042464
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      In the previous section, we defined a class\n      <code>swappable_vector</code> that inherits from\n      <code>array_vector</code> and adds a <code>swap</code>\n      method. In fact, the <code>swap</code> method could be\n      defined for any object with <code>get</code> and\n      <code>set</code> methods; it doesn't have to be the specific\n      class <code>array_vector</code>.\n    </blockquote>")))
 (idp9039920
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      A <span><em>virtual</em></span> class is a class where some methods\n      or fields are declared, but not implemented. This should not be\n      confused with the word &quot;virtual&quot; as it is used in C++.\n      In C++, a &quot;virtual&quot; method uses dynamic dispatch,\n      regular non-virtual methods use static dispatched. In OCaml,\n      <span><em>all</em></span> methods use dynamic dispatch, but the\n      keyword <span><em>virtual</em></span> means the method or field is\n      not implemented.\n    </blockquote>")))
 (idp9035264
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      The key property of private methods is that they are visible to\n      subclasses, but not anywhere else. If you want the stronger\n      guarantee that a method is <span><em>really</em></span> private,\n      not even accessible in subclasses, you can use an explicit typing\n      that omits the method. In the following code, the\n      <code>move_up</code> method is explicitly omitted from the\n      object type, and it can't be invoked in subclasses.\n    </blockquote>")))
 (idp9033984
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      The method <code>move_up</code> implements the process of\n      restoring heap order as a recursive method (though it would be\n      straightforward avoid the recursion and use iteration here).\n    </blockquote>")))
 (idp9028896
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      Yet another reason for private methods is to factor the\n      implementation and support recursion. Moving along with this\n      example, let's build a binary heap, which is a binary tree in heap\n      order: where the label of parent elements is smaller than the\n      labels of its children. One efficient implementation is to use an\n      array to represent the values, where the root is at index 0, and\n      the children of a parent node at index <code>i</code> are at\n      indexes <code>2 * i</code> and <code>2 * i + 1</code>.\n      To insert a node into the tree, we add it as a leaf, and then\n      recursively move it up the tree until we restore heap order.\n    </blockquote>")))
 (idp9024048
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      To be precise, the method <code>ensure_capacity</code> is\n      part of the class type, but it is not part of the object type.\n      This means the object <code>v</code> has no method\n      <code>ensure_capacity</code>. However, it is available to\n      subclasses. We can extend the class, for example, to include a\n      method <code>swap</code> that swaps two elements.\n    </blockquote>")))
 (idp9017104
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      To illustrate, let's build a class <code>vector</code> that\n      contains an array of integers, resizing the storage array on\n      demand. The field <code>values</code> contains the actual\n      values, and the <code>get</code>, <code>set</code>,\n      and <code>length</code> methods implement the array access.\n      For clarity, the resizing operation is implemented as a private\n      method <code>ensure_capacity</code> that resizes the array\n      if necessary.\n    </blockquote>")))
 (idp9015664
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      Methods can be declared <span><em>private</em></span>, which means\n      that they may be called by subclasses, but they are not visible\n      otherwise (similar to a <span><em>protected</em></span> method in\n      C++).\n    </blockquote>")))
 (idp9009152
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        The binary method <code>equals</code> is now implemented\n        in terms of the concrete type <code>shape_repr</code>. In\n        fact, the objects are now isomorphic to the\n        <code>shape_repr</code> type. When using this pattern, you\n        will not be able to hide the <code>repr</code> method, but\n        you can hide the type definition using the module system.\n      </blockquote>")))
 (idp9006288
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        If we want to define equality for shapes in general, the\n        remaining solution is to use the same approach as we described\n        for narrowing. That is, introduce a\n        <span><em>representation</em></span> type implemented using\n        variants, and implement the comparison based on the\n        representation type.\n      </blockquote>")))
 (idp9005472
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        The problem here is that the builtin polymorphic equality\n        compares the method implementations, not their return values.\n        The method implementations (the function values that implement\n        the methods) are different, so the equality comparison is false.\n        There are other reasons not to use the builtin polymorphic\n        equality, but these false negatives are a showstopper.\n      </blockquote>")))
 (idp9003056
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        One proposal we could consider is, since the problematic method\n        is equality, why not just drop it from the base type\n        <code>shape</code> and use polymorphic equality instead?\n        Unfortunately, the builtin equality has very poor behavior when\n        applied to objects.\n      </blockquote>")))
 (idp9002448
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        This problem is fundamental. Many languages solve it either with\n        narrowing (with dynamic type checking), or by method\n        overloading. Since OCaml has neither of these, what can we do?\n      </blockquote>")))
 (idp8999808
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        The problem is that a <code>square</code> expects to be\n        compared with a <code>square</code>, not an arbitrary\n        shape; similarly for <code>rectangle</code>.\n      </blockquote>")))
 (idp8994768
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        This works, but there is a problem lurking here. The method\n        <code>equals</code> takes an object of the exact type\n        <code>square</code> or <code>rectangle</code>.\n        Because of this, we can't define a common base class\n        <code>shape</code> that also includes an equality method.\n      </blockquote>")))
 (idp8990896
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        A <span><em>binary method</em></span> is a method that takes an\n        object of <code>self</code> type. One common example is\n        defining a method for equality.\n      </blockquote>")))
 (idp8988960
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        This pattern works, but it has drawbacks. In particular, the\n        recursive type definition should make it clear that this pattern\n        is essentially equivalent to using variants, and that objects do\n        not provide much value here.\n      </blockquote>")))
 (idp8985776
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Regardless, there is a solution if you find yourself in this\n        situation, which is to augment the classes with variants. You\n        can define a method <code>variant</code> that injects the\n        actual object into a variant type.\n      </blockquote>")))
 (idp8983280
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        In this case, it is much less clear how to augment the\n        <code>Shape</code> class to support this kind of pattern\n        analysis. It is also not obvious that object-oriented\n        programming is well-suited for this situation. Pattern matching\n        seems like a better fit.\n      </blockquote>")))
 (idp8980192
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        However, the situation is not always so obvious. The following\n        code checks whether an array of shapes looks like a\n        &quot;barbell,&quot; composed to two <code>Circle</code>\n        objects separated by a <code>Line</code>, where the\n        circles have the same radius.\n      </blockquote>")))
 (idp8977712
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Most programmers would consider this code to be\n        &quot;wrong.&quot; Instead of performing a case analysis on the\n        type of object, it would be better to define a method to return\n        the name of the shape. Instead of calling\n        <code>GetShapeName(s)</code>, we should call\n        <code>s.Name()</code> instead.\n      </blockquote>")))
 (idp8976128
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        More commonly, narrowing leads to poor object-oriented style.\n        Consider the following Java code, which returns the name of a\n        shape object.\n      </blockquote>")))
 (idp8973216
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        The design argument is this: narrowing violates abstraction. In\n        fact, with a structural typing system like in OCaml, narrowing\n        would essentially provide the ability to enumerate the methods\n        in an object. To check whether an object <code>obj</code>\n        has some method <code>foo : int</code>, one would attempt\n        a coercion <code>(obj :&gt; &lt; foo : int &gt;)</code>.\n      </blockquote>")))
 (idp8972624
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Why? There are two reasonable explanations, one based on a\n        design principle, and another technical (the technical reason is\n        simple: it is hard to implement).\n      </blockquote>")))
 (idp8971744
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Narrowing is <span><em>not permitted</em></span> in OCaml.\n        Period.\n      </blockquote>")))
 (idp8964928
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Narrowing, also called <span><em>down casting</em></span>, is the\n        ability to coerce an object to one of its subtypes. For example,\n        if we have a list of shapes <code>shape slist</code>, we\n        might know (for some reason) what the actual type of each shape\n        is. Perhaps we know that all objects in the list have type\n        <code>square</code>. In this case,\n        <span><em>narrowing</em></span> would allow the re-casting of the\n        object from type <code>shape</code> to type\n        <code>square</code>. Many languages support narrowing\n        through dynamic type checking. For example, in Java, a coercion\n        <code>(Square) x</code> is allowed if the value\n        <code>x</code> has type <code>Square</code> or one\n        of its subtypes; otherwise the coercion throws an exception.\n      </blockquote>")))
 (idp8959392
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        OCaml supports an abbreviation in this case, but it works only\n        for classes, not object types. The type expression\n        <code># classname</code> is an abbreviation for an elided\n        type containing all of the methods in the named class, and more.\n        Since <code>shape</code> is an object type, we can't write\n        <code>#shape</code>. However, if a class definition is\n        available, this abbreviation can be useful. The following\n        definition is exactly equivalent to the preceeding.\n      </blockquote>")))
 (idp8957328
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        This works, and it removes the need for explicit coercions. This\n        type is still fairly simple, but it does have the drawback that\n        the programmer needs to remember that the types\n        <code>&lt; area : float; ..&gt;</code> and\n        <code>shape</code> are related.\n      </blockquote>")))
 (idp8953488
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        A solution is to use an elided type. Instead of\n        <code>shape</code>, we can use the elided type\n        <code>&lt; area : float; .. &gt;</code>. In fact, once we\n        do this, it also becomes possible to use the\n        <code>slist</code> type.\n      </blockquote>")))
 (idp8951376
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Before we move to the next topic, there is one more thing to\n        address. The typing we gave above, using\n        <code>readonly_shape_slist</code>, requires that the\n        caller perform an explicit coercion before calling the\n        <code>total_area</code> function. We would like to give a\n        better type that avoids the coercion.\n      </blockquote>")))
 (idp8945760
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        This reasoning may seem fairly long and complicated, but it\n        should be pointed out that this typing\n        <span><em>works</em></span>, and in the end the type annotations\n        are fairly minor. In most typed object-oriented languages, the\n        coercion would simply not be possible. For example, in C++, a\n        STL type <code>slist&lt;T&gt;</code> is invariant in\n        <code>T</code>, it is simply not possible to use\n        <code>slist&lt;square&gt;</code> where\n        <code>slist&lt;shape&gt;</code> is expected (at least\n        safely). The situation is similar in Java, although Java\n        supports has an escape hatch that allows the program to fall\n        back to dynamic typing. The situation in OCaml is much better;\n        it works, it is statically checked, and the annotations are\n        pretty simple.\n      </blockquote>")))
 (idp8939392
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        In this particular case, depth subtyping on the\n        <code>iterator</code> method requires that\n        <code>square iterator</code> be a subtype of\n        <code>shape iterator</code>. Expanding the type definition\n        for the type <code>iterator</code>, we again invoke depth\n        subtyping, and we need to show that the type\n        <code>&lt; get : square &gt;</code> is a subtype of\n        <code>&lt;get : shape &gt;</code>, which follows because\n        <code>square</code> is a subtype of\n        <code>shape</code>.\n      </blockquote>")))
 (idp8932032
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Why does this work, why is a <code>square slist</code> a\n        subtype of <code>readonly_shape_slist</code>. The\n        reasoning is in two steps. First, the easy part is width\n        subtyping: we can drop the other methods to see that\n        <code>square slist</code> is a subtype of\n        <code>&lt; iterator : square iterator &gt;</code>. The\n        next step is to use <span><em>depth</em></span> subtyping, which,\n        in its general form, says that an object type\n        <code>&lt; m : t1 &gt;</code> is a subtype of a type\n        <code>&lt; m : t2&gt;</code> iff <code>t1</code> is\n        a subtype of <code>t2</code>. In other words, instead of\n        reasoning about the number of methods in a type (the width), the\n        number of methods is fixed, and we look within the method types\n        themselves (the &quot;depth&quot;).\n      </blockquote>")))
 (idp8927648
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n        Still, the <code>total_area</code> function should be\n        fine, in principle. It doesn't call <code>insert</code>,\n        so it isn't making that error. To make it work, we need to use a\n        more precise type that indicates we are not going to be mutating\n        the list. We define a type\n        <code>readonly_shape_slist</code> and confirm that we can\n        coerce the list of squares.\n      </blockquote>")))
 (idp8919840
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      It might seem tempting to give up at this point, especially\n      because the subtyping is not even true -- the type\n      <code>square slist</code> is not a subtype of\n      <code>shape slist</code>. The problem is with the\n      <code>insert</code> method. For\n      <code>shape slist</code>, the <code>insert</code>\n      method takes an arbitrary <code>shape</code> and inserts it\n      into the list. So if we could coerce a\n      <code>square slist</code> to a\n      <code>shape slist</code>, then it would be possible to\n      insert an arbitrary shape into the list, which would be an error.\n    </blockquote>")))
 (idp8914864
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      We can also define a function to calculate the total area of a\n      list of shapes. There is no reason to restrict this to squares, it\n      should work for any list of shapes with type\n      <code>shape slist</code>. The problem is that doing so\n      raises some serious typing questions -- can a\n      <code>square slist</code> be passed to a function that\n      expects a <code>shape slist</code>? If we try it, the\n      compiler produces a verbose error message.\n    </blockquote>")))
 (idp8912352
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      Next, let's take a seemingly tiny step forward, and start building\n      collections of shapes. It is easy enough to define a\n      <code>slist</code> of squares.\n    </blockquote>")))
 (idp8911024
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      This may seem absurd, but this concept is expressible in all\n      object-oriented languages. The contradiction is semantic -- we\n      know that in the real world, not all rectangles are squares; but\n      in the programming world, rectangles have all of the features of\n      squares (according to our definition), so they can be used just\n      like squares. Suffice it to say that it is usually better to avoid\n      such apparent contradictions.\n    </blockquote>")))
 (idp8906896
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      The subtyping rules are purely technical, they have no relation to\n      object semantics. We can define a class\n      <code>rectangle</code> that has all of the methods of a\n      <code>square</code>, so it is a subtype of square and can be\n      used wherever a <code>square</code> is expected.\n    </blockquote>")))
 (idp8900880
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      What are the rules for subtyping? In general, object subtyping has\n      two general forms, called <span><em>width</em></span> and\n      <span><em>depth</em></span> subtyping. Width subtyping means that\n      an object type <span><em>A</em></span> is a a subtype of\n      <span><em>B</em></span>, if <span><em>A</em></span> has all of the\n      methods of <span><em>B</em></span>, and possibly more. A\n      <code>square</code> is a subtype of <code>shape</code>\n      because it implements all of the methods of\n      <code>shape</code> (the <code>area</code> method).\n    </blockquote>")))
 (idp8893792
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      A <code>square</code> has a method <code>area</code>\n      just like a <code>shape</code>, and an additional method\n      <code>width</code>. Still, we expect a\n      <code>square</code> to be a <code>shape</code>, and it\n      is. The coercion <code>:&gt;</code> must be explicit.\n    </blockquote>")))
 (idp8890560
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      To explore this, let's define some simple classes for geometric\n      shapes. The generic type <code>shape</code> has a method to\n      compute the area, and a <code>square</code> is a specific\n      kind of shape.\n    </blockquote>")))
 (idp8884096
  ((file object-subtyping-and-inheritance.html)
   (html
    "<blockquote>\n      Subtyping is a central concept in object-oriented programming. It\n      governs when an object with one type <span><em>A</em></span> can be\n      used in an expression that expects an object of another type\n      <span><em>B</em></span>. When this is true, we say that\n      <span><em>A</em></span> is a <span><em>subtype</em></span> of\n      <span><em>B</em></span>. Actually, more concretely, subtyping\n      determines when the coercion operator <code>e :&gt; t</code>\n      can be applied. This coercion works only if the expression\n      <code>e</code> has some type <code>s</code> and\n      <code>s</code> is a subtype of <code>t</code>.\n    </blockquote>")))
 (idp8525104
  ((file object-oriented-programming.html)
   (html "<blockquote>\n      TODO: example\n    </blockquote>")))
 (idp8523072
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The Cryptokit library can be installed via OPAM by\n      <code>opam install cryptokit</code>. The OCamlfind package\n      also has the same name, so you just need to\n      <code>#require &quot;cryptokit&quot;</code> in your toplevel\n      to load the library and make the modules available.\n    </blockquote>")))
 (idp8521936
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Let's take a break from describing the object system with a more\n      practical example.\n    </blockquote>")))
 (idp8516768
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      One more thing, in this example the function\n      <code>make</code> has type\n      <code>unit -&gt; 'a slist</code>. But wait, we've stressed\n      <span><em>classes are not types</em></span>, so what's up with\n      that? In fact, what we've said is entirely true, classes and class\n      names <span><em>are not</em></span> types. However, class names can\n      be used to stand for types. When the compiler sees a class name in\n      type position, it automatically constructs an object type from it\n      by erasing all the fields and keeping only the method types. In\n      this case, the type expression <code>'a slist</code> is\n      exactly equivalent to <code>'a t</code>.\n    </blockquote>")))
 (idp8512912
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      In this signature, we've chosen to make nearly everything visible.\n      The class type for <code>slist</code> specifies the types of\n      the fields <code>first</code> and <code>last</code>,\n      as well ad the types of each of the methods. We've also included a\n      class type for <code>slist_iterator</code>, which is of\n      somewhat more questionable value, since the type doesn't appear in\n      the type for <code>slist</code> at all.\n    </blockquote>")))
 (idp8508656
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The abstract signature is simple because we ignore the classes.\n      But what if we want to include them in the signature, so that\n      other modules can inherit from the class definitions? For this, we\n      need to specify types for the classes, called <span><em>class\n      types</em></span>. Class types do not appear in mainstream\n      object-oriented programming languages, so you may not be familiar\n      with them, but the concept is pretty simple. A class type\n      specifies the type of each of the visible parts of the class,\n      including both fields and methods. Just like for module types, you\n      don't have to give a type for everything; anything you omit will\n      be hidden.\n    </blockquote>")))
 (idp8506896
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      We have multiple choices in definining the module type, depending\n      on how much of the implementation we want to expose. At one\n      extreme, a maximally-abstract signature would completely hide the\n      class definitions.\n    </blockquote>")))
 (idp8503312
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Before we begin, let's wrap up the implementation in an explicit\n      module (we'll use explicit modules for illustration, but the\n      process is similar when we want to define a\n      <code>.mli</code> file). In keeping with the usual style for\n      modules, we define a type <code>'a t</code> to represent the\n      type of list values.\n    </blockquote>")))
 (idp8502064
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Once we have defined the list implementation, the next step is to\n      wrap it in a module or <code>.ml</code> file and give it a\n      type so that it can be used in the rest of our code. What is the\n      type?\n    </blockquote>")))
 (idp8498656
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      We use the same object type <code>iterator</code> for\n      iterators, but implement it differently.\n    </blockquote>")))
 (idp8497328
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      There are some restriction on the use of the expression\n      <code>{&lt; ... &gt;}</code>. It can be used only within a\n      method body, and only the values of fields may be updated. Method\n      implementations are fixed at the time the object is created, they\n      cannot be changed dynamically.\n    </blockquote>")))
 (idp8492880
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      A key part of the implementation is the definition of the method\n      <code>insert</code>. The expression\n      <code>{&lt; ... &gt;}</code> produces a copy of the current\n      object, with the same type, and the specified fields updated. In\n      other words, the <code>new_fst new_x</code> method produces\n      a copy of the object, with <code>x</code> replaced by\n      <code>new_x</code>. The original object is not modified, and\n      the value of <code>y</code> is also unaffected.\n    </blockquote>")))
 (idp8489952
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Indeed, in many programs, this makes sense, but it is by no means\n      required. Let's define an object-oriented version of lists similar\n      to the imperative list above. We'll implement it with a regular\n      list type <code>'a list</code>, and insertion will be to the\n      beginning of the list instead of to the end.\n    </blockquote>")))
 (idp8489296
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Many people consider object-oriented programming to be\n      intrinsically imperative, where an object is like a state machine.\n      Sending a message to an object causes it to change state,\n      possibily sending messages to other objects.\n    </blockquote>")))
 (idp8484912
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The solution is to use a type quantifier, as shown in the\n      following example. The method type must be specified directly\n      after the method name, which means that method parameters must be\n      expressed using a <code>fun</code> or\n      <code>function</code> expression.\n    </blockquote>")))
 (idp8479280
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      What about functional operations similar to\n      <code>List.map</code> or <code>List.fold</code>? In\n      general, these methods take a function that produces a value of\n      some other type than the elements of the set. For example, the\n      function <code>List.fold</code> has type\n      <code>'a list -&gt; ('b -&gt; 'a -&gt; 'b) -&gt; 'b -&gt; 'b</code>,\n      where <code>'b</code> is an arbitrary type. To replicate\n      this in the <code>slist</code> class, we need a method type\n      <code>('b -&gt; 'a -&gt; 'b) -&gt; 'b -&gt; 'b</code>, where\n      the method type is polymorphic over <code>'b</code>.\n    </blockquote>")))
 (idp8476512
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      We may also wish to define functional-style methods,\n      <code>iter f</code> takes a function <code>f</code>\n      and applies it to each of the elements of the list.\n    </blockquote>")))
 (idp8471744
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Finally, we add a method <code>iterator</code> to the slist\n      class to produce an iterator. To do so, we construct an\n      <code>slist_iterator</code> that refers to the first node in\n      the list, but we want to return a value with the object type\n      <code>iterator</code>. This requires an explicit coercion\n      using the <code>:&gt;</code> operator.\n    </blockquote>")))
 (idp8468608
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Next, we'll define an actual iterator for the class\n      <code>slist</code>. We can represent the position in the\n      list with a field <code>current</code>, following links as\n      we traverse the list.\n    </blockquote>")))
 (idp8466544
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      First, we'll define an object type <code>iterator</code>\n      that specifies the methods in an iterator.\n    </blockquote>")))
 (idp8465392
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      OCaml support both styles. In fact, OCaml is more flexible than\n      these approaches because an object type can be implemented by any\n      object with the appropriate methods, it does not have to be\n      specified by the object's class <span><em>a priori</em></span>.\n      We'll leave abstract classes for later. Let's demonstrate the\n      technique using object types.\n    </blockquote>")))
 (idp8463024
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      There are two common styles for defining abstract interfaces like\n      this. In Java, an iterator would normally be specified with an\n      interface, which specifies a set of method types. In languages\n      without interfaces, like C++, the specification would normally use\n      <span><em>abstract</em></span> classes to specify the methods\n      without implementing them (C++ uses the &quot;= 0&quot; definition\n      to mean &quot;not implemented&quot;).\n    </blockquote>")))
 (idp8460944
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      This definition of the class <code>slist</code> is not\n      complete, we can construct lists, but we also need to add the\n      ability to traverse the elements in the list. One common style for\n      doing this is to define a class for an <code>iterator</code>\n      object. An iterator provides a generic mechanism to inspect and\n      traverse the elements of a collection. This pattern isn't\n      restricted to lists, it can be used for many different kinds of\n      collections.\n    </blockquote>")))
 (idp8456032
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Next, we can define the list itself. We'll keep a field\n      <code>head</code> the refers to the first element in the\n      list, and <code>last</code> refers to the final element in\n      the list. The method <code>insert</code> adds an element to\n      the end of the list.\n    </blockquote>")))
 (idp8455120
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      In general, we need to provide enough constraints so that the\n      compiler will infer the correct type. We can add type constraints\n      to the parameters, to the fields, and to the methods. It is a\n      matter of preference how many constraints to add. You can add type\n      constraints in all three places, but the extra text may not help\n      clarity. A convenient middle ground is to annotate the fields\n      and/or class parameters, and add constraints to methods only if\n      necessary.\n    </blockquote>")))
 (idp8449648
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The type annotations on the <code>val</code> declarations\n      are used to constrain type inference. If we omit these\n      annotations, the type inferred for the class will be &quot;too\n      polymorphic,&quot; <code>x</code> could have some type\n      <code>'b</code> and <code>next_node</code> some type\n      <code>'c option</code>.\n    </blockquote>")))
 (idp8445760
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The <code>value</code> is the value stored in the node, and\n      it can be retrieved and changed with the <code>get</code>\n      and <code>set</code> methods. The\n      <code>next_node</code> field is the link to the next element\n      in the stack. Note that the type parameter <code>['a]</code>\n      in the definition uses square brackets, but other uses of the type\n      can omit them (or use parentheses if there is more than one type\n      parameter).\n    </blockquote>")))
 (idp8441920
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Let's build an example of an imperative singly-linked list using\n      object-oriented techniques. First, we'll want to define a class\n      for a single element of the list. We'll call it a\n      <code>node</code>, and it will hold a value of type\n      <code>'a</code>. When defining the class, the type\n      parameters are placed in square brackets before the class name in\n      the class definition. We also need a parameter\n      <code>x</code> for the initial value.\n    </blockquote>")))
 (idp8440352
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      A class definition serves as the <span><em>constructor</em></span>\n      for the class. In general, a class definition may have parameters\n      that must be provided as arguments when the object is created with\n      <code>new</code>.\n    </blockquote>")))
 (idp8433744
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Inheritance uses an existing class to define a new one. For\n      example, the following class definition supports an addition\n      method <code>moveby</code> that moves the point by a\n      relative amount. This also makes use of the\n      <code>(self : 'self)</code> binding after the\n      <code>object</code> keyword. The variable\n      <code>self</code> stands for the current object, allowing\n      self-invocation, and the type variable <code>'self</code>\n      stands for the type of the current object (which in general is a\n      subtype of <code>movable_point</code>).\n    </blockquote>")))
 (idp8432608
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n<span><em>(yminsky: You say that inheritance uses an existing\n      class to define a new one, but the example below looks like using\n      an existing class to define a new module. Is that what's going on?\n      Or is a new class being created implicitly? If the latter, it\n      might be better to be more explicit in this example and name the\n      new class.)</em></span>\n</blockquote>")))
 (idp8430320
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      To produce an object, classes are instantiated with the keyword\n      <code>new</code>.\n    </blockquote>")))
 (idp8425184
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The type <code>class point : ... end</code> is a\n      <span><em>class type</em></span>. This particular type specifies\n      that the <code>point</code> class defines a mutable field\n      <code>x</code>, a method <code>get</code> that returns\n      an <code>int</code>, and a method <code>set</code>\n      with type <code>int -&gt; unit</code>.\n    </blockquote>")))
 (idp8422496
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      In OCaml, class definitions must be defined as top-level\n      statements in a module. A class is not an object, and a class\n      definition is not an expression. The syntax for a class definition\n      uses the keyword <code>class</code>.\n    </blockquote>")))
 (idp8420944
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Programming with objects directly is great for encapsulation, but\n      one of the main goals of object-oriented programming is code\n      re-use through inheritance. For inheritance, we need to introduce\n      <span><em>classes</em></span>. In object-oriented programming, a\n      class is a &quot;recipe&quot; for creating objects. The recipe can\n      be changed by adding new methods and fields, or it can be changed\n      by modifying existing methods.\n    </blockquote>")))
 (idp8414816
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      An object of type <code>&lt; get:int; .. &gt;</code> can be\n      any object with a method <code>get:int</code>, it doesn't\n      matter how it is implemented. So far, we've constructed two\n      objects with that type; the function <code>make</code>\n      constructed one, and so did <code>average</code>. When the\n      method <code>#get</code> is invoked, the actual method that\n      is run is determined by the object.\n    </blockquote>")))
 (idp8411584
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      In other words, the type <code>'a point</code> is equal to\n      <code>'a</code>, where\n      <code>'a = &lt; get : int; .. &gt;</code>. That may seem\n      like an odd way to say it, and in fact, this type definition is\n      not really an abbreviation because <code>'a</code> refers to\n      the entire type.\n    </blockquote>")))
 (idp8407360
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      A <code>..</code> in an object type is called a\n      <span><em>row variable</em></span> and this typing scheme is called\n      <span><em>row polymorphism</em></span>. Even though\n      <code>..</code> doesn't look like a type variable, it\n      actually is. The error message suggests a solution, which is to\n      add the <code>as 'a</code> type constraint.\n    </blockquote>")))
 (idp8404672
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The <code>..</code> in an object type is an elision,\n      standing for &quot;possibly more methods.&quot; It may not be\n      apparent from the syntax, but an elided object type is actually\n      polymorphic. If we try to write a type definition, we get an\n      obscure error.\n    </blockquote>")))
 (idp8398304
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Note that the type for <code>average</code> uses the object\n      type <code>&lt; get : int; .. &gt;</code>. The\n      <code>..</code> are ellipsis, standing for any other\n      methods. The type <code>&lt; get : int; .. &gt;</code>\n      specifies an object that must have at least a\n      <code>get</code> method, and possibly some others as well.\n      If we try using the exact type\n      <code>&lt; get : int &gt;</code> for an object with more\n      methods, type inference will fail.\n    </blockquote>")))
 (idp8395056
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Functions can also take object arguments. Let's construct a new\n      object <code>average</code> that's the average of any two\n      objects with a <code>get</code> method.\n    </blockquote>")))
 (idp8394176
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n<span><em>(yminsky: Maybe this is a good time to talk about the\n      nature of object subtyping?)</em></span>\n</blockquote>")))
 (idp8390128
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Note that the types of the function <code>make</code> and\n      the returned object now use the polymorphic type\n      <code>'a</code>. When make is invoked on a concrete value\n      <code>5</code>, we get the same object type as before, with\n      type <code>int</code> for the value.\n    </blockquote>")))
 (idp8388224
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Objects can also be constructed by functions. If we want to\n      specify the initial value of the object, we can define a function\n      that takes the initial value and produces an object.\n    </blockquote>")))
 (idp8385072
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The object type is enclosed in angle brackets\n      <code>&lt; ... &gt;</code>, containing just the types of the\n      methods. Fields, like x, are not part of the public interface of\n      an object. All interaction with an object is through its methods.\n      The syntax for a method invocation (also called &quot;sending a\n      message&quot; to the object) uses the <code>#</code>\n      character.\n    </blockquote>")))
 (idp8382816
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      The object has an integer value <code>x</code>, a method\n      <code>get</code> that returns x, and a method\n      <code>set</code> that updates the value of x.\n    </blockquote>")))
 (idp8380656
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      OCaml is entirely different. Classes are used to construct objects\n      and support inheritance, including non-subtyping inheritance.\n      Classes are not types. Instead, objects have <span><em>object\n      types</em></span>, and if you want to use objects, you aren't\n      required to use classes at all. Here is an example of a simple\n      object.\n    </blockquote>")))
 (idp8378368
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      If you already know about object oriented programming in a\n      language like Java or C++, the OCaml object system may come as a\n      surprise. Foremost is the complete separation of subtyping and\n      inheritance in OCaml. In a language like Java, a class name is\n      also used as the type of objects created by instantiating it, and\n      the subtyping rule corresponds to inheritance. For example. if we\n      implement a class <code>Stack</code> in Java by inheriting\n      from a class <code>Deque</code>, we would be allowed to pass\n      a stack anywhere a deque is expected (this is a silly example of\n      course, practitioners will point out that we shouldn't do it).\n    </blockquote>")))
 (idp8376208
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      In this chapter, we'll introduce you to the basics of object\n      definition and use in OCaml, and then demonstrate their use with\n      an example using Cryptokit. We'll return to the more advanced\n      areas of object use later on in the book in\n      <a href=\"object-subtyping-and-inheritance.html\">Chapter\194\16012, <i>Object Subtyping and Inheritance</i></a>.\n    </blockquote>")))
 (idp8374080
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      In general, a rule of thumb might be: use classes and objects in\n      situations where dynamic binding is a big win, for example if you\n      have many similar variations in the implementation of a concept.\n      Two good examples is Xavier Leroy's\n      <a href=\"http://gallium.inria.fr/~xleroy/software.html#cryptokit\" target=\"_top\">Cryptokit</a>,\n      which provides a variety of cryptographic primitives that can be\n      combined in building-block style, and the\n      <a href=\"TODO%20XREF\" target=\"_top\">Camlgraphics</a> library which\n      manipulates various graphical file formats.\n    </blockquote>")))
 (idp8373376
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      In contrast, modules use static (lexical) scoping. If you want to\n      parameterize your module code so that some part of it can be\n      implemented later, you would write a function/functor. This is\n      more explicit, but often more verbose than overriding a method in\n      a class.\n    </blockquote>")))
 (idp8372064
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      Modules already provide these features in some form, but the main\n      focus of classes is on code re-use through inheritance and late\n      binding of methods. This is a critical property of classes: the\n      methods that implement an object are determined when the object is\n      instantiated, a form of <span><em>dynamic</em></span> binding. In\n      the meantime, while classes are being defined, it is possible (and\n      necessary) to refer to methods without knowing statically how they\n      will be implemented.\n    </blockquote>")))
 (idp8370912
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n<span><em>Inheritance</em></span>: the definition of one kind\n          of object can be re-used to produce a new kind of object.\n        </blockquote>")))
 (idp8367264
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n<span><em>Subtyping</em></span>: if an object\n          <code>a</code> has all the functionality of an object\n          <code>b</code>, then we may use <code>a</code> in\n          any context where <code>b</code> is expected.\n        </blockquote>")))
 (idp8365808
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n<span><em>Dynamic lookup</em></span>: when a message is sent to\n          an object, the method to be executed is determined by the\n          implementation of the object, not by some static property of\n          the program. In other words, different objects may react to\n          the same message in different ways.\n        </blockquote>")))
 (idp8364480
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n<span><em>Abstraction</em></span>: the details of the\n          implementation are hidden in the object; the interface is just\n          the set of publically-accessible methods.\n        </blockquote>")))
 (idp8363440
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      What exactly is object-oriented programming? Mitchell (TODO: xref)\n      points out four fundamental properties.\n    </blockquote>")))
 (idp8362672
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n      You might wonder when to use objects. First-class modules are more\n      expressive (a module can include types, classes and objects\n      cannot), and modules, functors, and algebraic data types offer a\n      wide range of ways to express program structure. In fact, many\n      seasoned OCaml programmers rarely use classes and objects, if at\n      all.\n    </blockquote>")))
 (idp8361056
  ((file object-oriented-programming.html)
   (html
    "<blockquote>\n    We've already seen several tools that OCaml provides for organizing\n    programs, particularly first-class modules. In addition, OCaml also\n    supports object-oriented programming. There are objects, classes,\n    and their associated types. Objects are good for encapsulation and\n    abstraction, and classes are good for code re-use.\n  </blockquote>")))
 (idp9146064
  ((file installation.html)
   (html
    "<blockquote>\n      Package listings are obtained by adding\n      <span><em>remotes</em></span> that provide package descriptions,\n      installation instructions and URLs.\n    </blockquote>")))
 (idp9144240
  ((file installation.html)
   (html
    "<blockquote>\n        Eclipse plugins: which one is maintained?\n      </blockquote>")))
 (idp9143024
  ((file installation.html)
   (html
    "<blockquote>\n        Vim users can use the built-in style, and\n        <a href=\"http://github.com/avsm/ocaml-annot\" target=\"_top\">ocaml-annot</a>\n        may also be useful.\n      </blockquote>")))
 (idp9141856
  ((file installation.html)
   (html
    "<blockquote>\n        Emacs users have tuareg and\n        <a href=\"http://www.typerex.org/\" target=\"_top\">Typerex</a>.\n      </blockquote>")))
 (idp9138704
  ((file installation.html)
   (html
    "<blockquote>\n        TODO: the <code>.ocamlinit</code> handling in OPAM is\n        being finalised and is tracked in\n        <a href=\"https://github.com/OCamlPro/opam/issues/185\" target=\"_top\">issue\n        185</a>.\n      </blockquote>")))
 (idp9134720
  ((file installation.html)
   (html
    "<blockquote>\n        The <code>utop</code> tool provides a convenient\n        interactive top-level, with full command history, command macros\n        and module name completion. An <code>.ocamlinit</code>\n        file in your home directory will initialise\n        <code>utop</code> with common libraries and syntax\n        extensions open, e.g.:\n      </blockquote>")))
 (idp9130880
  ((file installation.html)
   (html
    "<blockquote>\n        The new compiler will be compiled and installed into\n        <code>~/.opam/4.00.1+short-types</code> and the libraries\n        will be tracked separately from your system installation. You\n        can have any number of compilers installed simultaneously, but\n        only one can be active at any time.\n      </blockquote>")))
 (idp9128576
  ((file installation.html)
   (html
    "<blockquote>\n        The default compiler installed by OPAM uses the system OCaml\n        installation. You can use <code>opam switch</code> to swap\n        between different compiler versions, or experiment with a\n        different set of libraries or new compiler versions. For\n        instance, one of the alternate compilers is patched to simplify\n        the types that are output in the top-level. You can switch it to\n        by:\n      </blockquote>")))
 (idp9122160
  ((file installation.html)
   (html
    "<blockquote>\n        This will initialise OPAM with the default package set from\n        <code>opam.ocamlpro.com</code>, and install the\n        <code>utop</code> interactive top-level and the\n        <code>Async</code> library. OPAM figures out the minimal\n        set of dependencies required, and installs those too. The\n        <code>eval</code> command is sets your\n        <code>PATH</code> variable to point to the current active\n        compiler, and you should add this to your shell\n        <code>.profile</code> to run every time you open a new\n        command shell.\n      </blockquote>")))
 (idp9120080
  ((file installation.html)
   (html
    "<blockquote>\n        All of the OPAM state is held in the <code>.opam</code>\n        directory in your home directory, including compiler\n        installations. You should never need to switch to an admin user\n        to install packages.\n      </blockquote>")))
 (idp9118352
  ((file installation.html)
   (html
    "<blockquote>\n        Investigate Protzenko's Windows installer.\n      </blockquote>")))
 (idp9116752
  ((file installation.html)
   (html "<blockquote>\n        On Fedora/RHEL...?\n      </blockquote>")))
 (idp9115328
  ((file installation.html)
   (html
    "<blockquote>\n        On Debian Linux, you should install OCaml via binary packages,\n        and then install the latest OPAM release from source.\n      </blockquote>")))
 (idp9112128
  ((file installation.html)
   (html
    "<blockquote>\n        The easiest way to install OCaml on MacOS X is via the\n        <code>homebrew</code> package manager, available from\n        [http://github.com/mxcl/homebrew].\n      </blockquote>")))
 (idp9108800
  ((file installation.html)
   (html
    "<blockquote>\n      OPAM maintains multiple compiler and library installations, but\n      this can clash with a global installation of the\n      <code>ocamlfind</code> tool. Uninstall any existing copies\n      of <code>ocamlfind</code> before installing OPAM, and use\n      the OPAM version instead.\n    </blockquote>")))
 (idp9106752
  ((file installation.html)
   (html
    "<blockquote>\n      To install OPAM, you will need a working OCaml installation to\n      bootstrap the package manager. Once installed, all of the OPAM\n      state is held in the <code>$HOME/.opam</code> directory, and\n      you can reinitialise it by deleting this directory and starting\n      over.\n    </blockquote>")))
 (idp9104736
  ((file installation.html)
   (html
    "<blockquote>\n    For the purposes of this book, we'll use the OPAM source manager.\n    There are other alternatives available such as GODI and ODB, but not\n    covered here. Let's get started with OPAM now, as you will need it\n    to run the examples in the rest of the book. OPAM manages multiple\n    simultaneous OCaml compiler and library installations, tracks\n    library versions across upgrades, and recompiles dependencies\n    automatically if they get out of date.\n  </blockquote>")))
 (idp9104096
  ((file installation.html)
   (html
    "<blockquote>\n    The easiest way to install OCaml is via the binary packages\n    available in many operating systems. For day-to-day code\n    development, it is easier to use a source-based manager that lets\n    you recompile individual libraries easily.\n  </blockquote>")))
 (idp8359232
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      However, there are times when imperative programming might provide\n      efficiency (as with lazy evaluation, or memoization), or you might\n      require techniques or data structures that are traditional\n      imperative (like graphs represented with adjacency lists), and in\n      these cases OCaml usually shines. Used with discretion, imperative\n      programming can lead to smaller, simpler programs.\n    </blockquote>")))
 (idp8358352
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The OCaml language supports a fairly standard imperative\n      programming model, with looping, assignment, mutable arrays,\n      records, and objects. If desired, we can write programs that\n      correspond directly to what we would have written in some other\n      imperative language like C or Java. Of course, doing so is really\n      not the best match -- if you want to write imperative programs,\n      you should probably use an imperative programming language.\n    </blockquote>")))
 (idp8352416
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        For another example, consider the parsing a date string that\n        might be in one of two forms, <span><em>month day,\n        year</em></span> or <span><em>month/day/year</em></span>. The\n        <code>scanf</code> functions raise the exception\n        <code>Scan_failure</code> on error, so we can read a date\n        string by trying both kinds of format.\n      </blockquote>")))
 (idp8347808
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The <code>scanf</code> function can be used for reading\n        input, similar to <code>printf</code>. The general form\n        takes a format string and a &quot;receiver&quot; function that\n        is applied to the input. The format string contains literal\n        characters, which must be read literally, and conversion\n        specifications similar to <code>printf</code>. The result\n        of the receiver function is returned as the result of\n        <code>scanf</code>.\n      </blockquote>")))
 (idp8342768
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>bprintf buffer format arg1 ... argN</code>.\n            Print to a string buffer <code>buffer</code> of type\n            <code>Buffer.t</code>.\n          </blockquote>")))
 (idp8341376
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>sprintf format arg1 ... argN</code>. Produce a\n            string as output.\n          </blockquote>")))
 (idp8339360
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>fprintf channel format arg1 ... argN</code>.\n            Print to the channel <code>channel</code>.\n          </blockquote>")))
 (idp8337344
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>eprintf format arg1 ... argN</code>. Print to\n            the standard error channel <code>stderr</code>.\n          </blockquote>")))
 (idp8335200
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The function <code>printf</code> prints to the standard\n        output channel <code>stdout</code>. There are alse several\n        variations.\n      </blockquote>")))
 (idp8330080
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Actually, this is not entirely true. The\n        <code>printf</code> function takes a format string of type\n        <code>('a, 'b, 'c) format</code> and it is only the type\n        conversion from <code>string</code> to\n        <code>format</code> where the string is required to be a\n        literal.\n      </blockquote>")))
 (idp8327584
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        A consequence of strong typing is that the format string must\n        ultimately be a string <span><em>literal</em></span>, known at\n        compile time. It can't be computed by the program at runtime.\n      </blockquote>")))
 (idp8324240
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        In OCaml, <code>printf</code> is type safe. The format is\n        checked against the arguments at compile time, and rejected if\n        the format string is malformed, or if the format does not match\n        the arguments. In the following examples, <code>%v</code>\n        is not a valid conversion specification, and floating-point\n        values can't be printed with a decimal conversion specification.\n      </blockquote>")))
 (idp8321008
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Note that the width specifies a <span><em>minimum</em></span>\n        width. If the value requires more width to print completely the\n        width is increased. The price <code>4136.00</code> and the\n        size <code>enormous</code> both overflow the width,\n        breaking the tabular form.\n      </blockquote>")))
 (idp8318816
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The format specification\n        <code>&quot;| %-6s | 0x%08x | %6.2f |\\n&quot;</code>\n        specifies that the first argument is a string that is to be\n        left-justified and printed six characters wide; the second\n        argument is an integer that should be printed in hexidecimal\n        (format type <code>x</code>) eight characters wide with\n        leading zeroes; and the third argument is a floating point value\n        that should be printed right-justified, six characters wide,\n        with two digits after the decimal point.\n      </blockquote>")))
 (idp8315120
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        There are several flags of interest, the flag\n        <code>'-'</code> left-justifies the output, and the flag\n        <code>'0'</code> pads numerical values with leading\n        zeroes. Let's write a program to print a price list in a tabular\n        form.\n      </blockquote>")))
 (idp8313568
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Conversions can also specify additional parameters for\n        formatting the value. The general form has flags, width\n        specified in number of characters, and decimal precision used\n        for printing floating-point values. These parameters are\n        optional.\n      </blockquote>")))
 (idp8308960
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The format string can contain character literals, which are\n        printed without change, as well as conversion specifications,\n        which specify how to print an value that is provided as an\n        argument. A conversion specification begins with a percent\n        (<code>%</code>) character, some flags, and a type\n        specification. For example, <code>%d</code> is a\n        conversion specification for printing an integer,\n        <code>%s</code> prints a string, and <code>%f</code>\n        prints a floating-point value.\n      </blockquote>")))
 (idp8302880
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Output with the standard library functions like\n        <code>output_char</code>, <code>output_int</code>,\n        <code>output_string</code>, etc. is simple, but there is\n        little flexibility, and it is often verbose. OCaml also supports\n        <span><em>formatted</em></span> output using the\n        <code>printf</code> function, which is modeled after\n        <code>printf</code> in the C standard library. The\n        <code>printf</code> function takes a <span><em>format\n        string</em></span> that describe what to print and how to format\n        it, as well as arguments to be printed.\n      </blockquote>")))
 (idp8299312
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>flush : out_channel -&gt; unit</code>\n</blockquote>")))
 (idp8296656
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        It is important to close channels when you are finished with\n        them, for two reasons. One reason is that the runtime system\n        will usually have a limit on the number of channels that may be\n        open simultaneously. To avoid problems, you should close\n        channels you are not using. In addition, for efficiency, output\n        is buffered and written to output channels in larger blocks. The\n        output may not actually be written to the file unless the\n        <code>out_channel</code> is closed, or with an explicit\n        call to the <code>flush</code> function.\n      </blockquote>")))
 (idp8291888
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The functions for input and output are similar to the\n        <code>print_...</code> and <code>read_...</code>\n        functions, but they use the prefix <code>output_</code>\n        and <code>input_</code> and they take a channel as an\n        argument. Let's write a function to print the contents of a\n        file.\n      </blockquote>")))
 (idp8290624
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>close_in : in_channel -&gt; unit</code> close an\n            input channel.\n          </blockquote>")))
 (idp8289120
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>close_out : out_channel -&gt; unit</code> close\n            an output channel, flushing any pending output to the file.\n          </blockquote>")))
 (idp8287728
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>open_in : string -&gt; in_channel</code> open a\n            file for reading.\n          </blockquote>")))
 (idp8286336
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>open_out : string -&gt; out_channel</code> open\n            a file for writing.\n          </blockquote>")))
 (idp8285264
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        It isn't necessary to perform all input through the standard\n        channels. There are also functions to open files for reading and\n        writing.\n      </blockquote>")))
 (idp8280096
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      In this loop, the value returns from a successful call to\n      <code>read_int ()</code> is added to the\n      <code>items</code> list by side-effect. When\n      <code>read_int ()</code> reaches the end of input, it raises\n      the <code>End_of_file</code> exception, terminating the\n      loop. The <code>while</code> loop never terminates; the\n      <code>[]</code> value afterward is only to satisfy the type\n      checker.\n    </blockquote>")))
 (idp8278272
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Another way to address the input issue is to use iteration, rather\n      than recursion. This requires collecting the input in a container\n      than can be mutated by side-effect.\n    </blockquote>")))
 (idp8274288
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Using exceptions to signal the end of input is a little awkward.\n      The <code>read_input</code> loop above converts the\n      exception into an <code>int option</code>, so that matching\n      can be performed with <code>match</code> and the function is\n      tail-recursive. The following function is <span><em>not</em></span>\n      tail recursive, and should be avoided.\n    </blockquote>")))
 (idp8271024
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Here is a function to read a sequence of integers from\n      <code>stdin</code>, sorting them and printing the result to\n      <code>stdout</code>.\n    </blockquote>")))
 (idp8269920
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      These functions raise the exception <code>End_of_file</code>\n      if the input channel is terminated before the input is read.\n    </blockquote>")))
 (idp8268032
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>read_float : unit -&gt; float</code> reads a\n          floating-point number from <code>stdin</code>.\n        </blockquote>")))
 (idp8266016
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>read_int : unit -&gt; int</code> reads a decimal\n          integer from <code>stdin</code>.\n        </blockquote>")))
 (idp8264000
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>read_line : unit -&gt; string</code> reads a line\n          of input from <code>stdin</code>.\n        </blockquote>")))
 (idp8263024
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Input is similar, but there are only a few functions.\n    </blockquote>")))
 (idp8259072
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Functions to write to <code>stderr</code> have similar\n      names, using the prefix <code>prerr_</code> rather than\n      <code>print_</code> (for example,\n      <code>prerr_string</code>).\n    </blockquote>")))
 (idp8257184
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>print_float : float -&gt; unit</code> prints a\n          floating-point number to <code>stdout</code>.\n        </blockquote>")))
 (idp8255168
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>print_int : int -&gt; unit</code> prints an\n          integer to <code>stdout</code>.\n        </blockquote>")))
 (idp8252448
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>print_string : string -&gt; unit</code> prints a\n          <code>string</code> to <code>stdout</code> as a\n          sequence of characters, without quotes.\n        </blockquote>")))
 (idp8250432
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>print_char : char -&gt; unit</code> prints a\n          single character to <code>stdout</code>.\n        </blockquote>")))
 (idp8249408
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The standard library has several functions for reading from and\n      writing to the standard channels.\n    </blockquote>")))
 (idp8247344
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>stderr : out_channel</code>. The &quot;standard\n          error&quot; channel. This is similar to\n          <code>stdout</code>, but it is intended for error\n          messages.\n        </blockquote>")))
 (idp8245056
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>stdout : out_channel</code>. The &quot;standard\n          output&quot; channel. By default, output written to\n          <code>stdout</code> appears on the user terminal.\n        </blockquote>")))
 (idp8243280
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>stdin : in_channel</code>. The &quot;standard\n          input&quot; channel. By default, input comes from the\n          terminal, which handles keyboard input.\n        </blockquote>")))
 (idp8240528
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      For basic I/O OCaml models input and output with\n      <span><em>channels</em></span>. An <code>in_channel</code> is\n      used for reading input, and and <code>out_channel</code> for\n      producing output. Each OCaml process has three standard channels,\n      similar to the three standard files in Unix.\n    </blockquote>")))
 (idp8236880
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Input and output I/O is another kind of imperative operation,\n      where the purpose is to either read input from a file, stream, or\n      device, <span><em>consuming</em></span> the input by side-effect;\n      or write output to a file, stream, or device,\n      <span><em>modifying</em></span> the output by side-effect. There\n      are several I/O libraries in OCaml. There is the basic builtin I/O\n      library in the <code>Pervasives</code> module, and there are\n      moe advanced I/O libraries in the <code>Unix</code> and\n      <code>Async</code> modules. Let's look at the basic library\n      -- the advanced libraries will be described elsewhere.\n    </blockquote>")))
 (idp8233648
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        One advantage of this relaxed iteration semantics is peformance,\n        since iteration is largely unsynchronized. Another advantage is\n        that deadlock is less likely. If we were to\n        <span><em>lock</em></span> the bucket during iteration, then\n        changes to that bucket would not be allowed during iteration\n        (even by the iterating thread). We might allow lock recursion to\n        allow mutations by the iterating thread, but in general the\n        synchronization might involve multiple threads, resulting in\n        deadlock. Lock-free iteration ensures that the\n        <code>ConcurrentHashMap</code> will not be involved in a\n        deadlock cycle.\n      </blockquote>")))
 (idp8231552
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        All method are unsychronized except the method\n        <code>remove</code>, which mutates the bucket. As a\n        consequence, it means that hash operations that add and remove\n        elements from the list can happen concurrently with iteration.\n        Again, this is great from a performance perspective, but it\n        means that iteration has non-sequential semantics. In\n        particular, whenever iteration enters a new bucket, subsequent\n        concurrent operations that add new elements or remove old ones\n        from that bucket have <span><em>no effect</em></span> on the\n        iteration. Iteration advances through that bucket as if it were\n        unchanged.\n      </blockquote>")))
 (idp8223616
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        For the final part of the implementation, let's define\n        imperative iteration. The iterator object contains a bucket\n        index, and the field <code>elements</code> refers to some\n        suffix of the list stored in the bucket. The\n        <code>value</code> method returns the current elements,\n        and the <code>next</code> method advances the\n        <code>elements</code> field. The method\n        <code>normalize</code> is used to maintain the invariant\n        that the <code>elements</code> field always refers to a\n        value in the table unless the iterator has advanced past the\n        final element. The <code>remove</code> method removes the\n        current element from the bucket in which it is stored.\n      </blockquote>")))
 (idp8220704
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Note, OCaml does not a <span><em>guarantee</em></span> this\n        semantics. The OCaml implementation may change to support\n        parallelism. If it does, the memory semantics will change\n        accordingly. The simplest fix is just to synchronize the access.\n        Performance of <code>find</code> operations will decrease\n        somewhat due to contention.\n      </blockquote>")))
 (idp8219728
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Unfortunately, for some processor architectures, primary memory\n        does not have sequential semantics, due to caching and other\n        effects. Fortunately for us, OCaml does provide sequential\n        memory semantics due to its threading model where: 1) only one\n        thread executes at a time, and 2) there is a memory barrier the\n        prevents reordering of thread context switches and memort\n        operations, and 3) the compiler does not reorder memory\n        operations in ways that would violate sequential memory\n        semantics.\n      </blockquote>")))
 (idp8213248
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The reasoning has to do with two things: 1) the semantics we\n        expect from the table, and 2) the OCaml memory model. Ideally,\n        the semantics we would expect is <span><em>sequential\n        semantics</em></span>, meaning that all memory operations are\n        processed in <span><em>some</em></span> sequence that is\n        compatible with the order in which they were performed in each\n        thread. Thus, if some thread adds two entries for keys\n        <code>K1</code> and <code>K2</code> in sequential\n        order, then all other threads will see either, 1) neither entry,\n        or 2) a entry for <code>K1</code>, or 3) a entry for both\n        <code>K1</code> and <code>K2</code>, but it will\n        <span><em>not</em></span> see an entry for <code>K2</code>\n        without also having an entry for <code>K1</code>.\n      </blockquote>")))
 (idp8212672
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        From a performance perspective, this is clearly a win, because\n        retrieving elements from the table has no locking at all. But\n        why is it valid?\n      </blockquote>")))
 (idp8210528
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The function to find an association in the table is similar --\n        we jsut find the entry in the table and return the value part.\n        However, this particular implementation is somewhat more subtle,\n        because it omits the synchronization step, examining the bucket\n        <span><em>without</em></span> acquiring the lock.\n      </blockquote>")))
 (idp8208720
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Removing an element from the table is similar. If here is a\n        previous entry in the table, the entry is removed. Otherwise,\n        the table is left unchanged.\n      </blockquote>")))
 (idp8204928
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        To add a new entry to the table, the <code>add</code>\n        function acquires the bucket lock, then uses\n        <code>find_assoc</code> to look for an existing\n        association. If one is found, the <code>value</code> is\n        updated in-place to the new value. Otherwise, a new entry is\n        added to the beginning of the bucket.\n      </blockquote>")))
 (idp8201392
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Note that the <code>synchronize</code> function is\n        <span><em>not</em></span> exception-safe, meaning that if\n        evaluation of <code>f ()</code> raises an exception, the\n        lock will not be released. An exception-safe version would catch\n        all exceptions; when an exception is raised, the lock would be\n        released, and the exception re-raised.\n      </blockquote>")))
 (idp8198912
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The locks are intended to partition the table into multiple\n        sub-parts, where each lock provides synchronization for a\n        contiguous range of buckets. To make synchronization each we\n        define a function <code>synchronize</code> that takes a\n        bucket index and a function, and evaluates the function with the\n        bucket lock acquired, releasing the lock before returning.\n      </blockquote>")))
 (idp8194448
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Each bucket is an <span><em>association list</em></span>, meaning\n        that it is list of key/value pairs that implement a dictionary.\n        We can start the implementation by defining dictionary\n        operations for association lists. The function\n        <code>find_assoc</code> finds the value associated with a\n        key, and <code>remove_assoc</code> removes an association.\n        Both functions raise an exception <code>Not_found</code>\n        if the list does not contain the association.\n      </blockquote>")))
 (idp8192592
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Each <code>element</code> is a key/value pair, where the\n        value is mutable so that the <code>add</code> function can\n        mutate it in place. For this implementation, we'll use 32 locks,\n        and start with 256 buckets.\n      </blockquote>")))
 (idp8189664
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        We'll use the same basic construction that we used to implement\n        the <code>HashMap</code> -- a hash table contains an array\n        of buckets. In addition we'll add locking to ensure that\n        concurrent operations do not interfere. In addition, to reduce\n        lock contention, we'll use an array of locks to partition the\n        table into multiple parts. If operations are randomly\n        disitribted, this should reduce lock contention.\n      </blockquote>")))
 (idp8187760
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Let's extend our hash table example to support concurrency. To\n        begin, let's first give the signature of the module we will\n        implement. The table has operations to add, remove, and find\n        elements, and it also supports imperative iterators.\n      </blockquote>")))
 (idp8185392
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Out of all of these choices, the simplest one is to use the\n        <code>Async</code> model and cooperative multitasking.\n        However, let's go ahead and work through some examples of using\n        traditional concurrent programming using locks and other\n        synchronization primitives to build a concurrency library.\n      </blockquote>")))
 (idp8183968
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n            Give in, and use threads, and the standard synchronization\n            toolkit that comes with OCaml, including locks\n            (<code>Mutex</code>), condition variables, etc.\n          </blockquote>")))
 (idp8182976
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n            Do not share mutable data between threads. In practice, this\n            usually includes explicit communication channels between\n            threads that otherwise have isolated state.\n          </blockquote>")))
 (idp8180704
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n            Use <span><em>cooperative</em></span> multitasking, where\n            only one thread runs at a time, and context switches are\n            <span><em>voluntary</em></span>. This is the dominant model\n            in <code>Async</code>.\n          </blockquote>")))
 (idp8179808
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n            Do not use assignment, mutable data structures, or perform\n            input/output in threads.\n          </blockquote>")))
 (idp8178704
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        In general the interaction of concurrency with imperative\n        programs causes problems with races. There are many techniques\n        you can use to address the issue.\n      </blockquote>")))
 (idp8176720
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      When we run this program, it produces a deterministic output.\n    </blockquote>")))
 (idp8173696
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      If this is not the behavior that was expected, one solution is to\n      use a <code>Mutex</code> to ensure that the increment\n      operation is atomic. We can allocate a lock with\n      <code>Mutex.create</code>, then acquire the lock in the loop\n      body.\n    </blockquote>")))
 (idp8171664
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      This represents a nearly perfect interleaving of the thread\n      executions. Each thread fetches the value from the\n      <code>value</code> reference cell, prints the value, then\n      performs the assignment. Since both threads effectively run in\n      lockstep, the final value in the <code>value</code>\n      reference cell is the same as if there were just one thread\n      running.\n    </blockquote>")))
 (idp8170240
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The exact behavior of the program is nondeterminstic -- it depends\n      on the relative sopeed of the two theads. One output is listed\n      below.\n    </blockquote>")))
 (idp8167120
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The reference cell <code>value</code> holds a shared value\n      that is incremented 10 times, in a loop, by the\n      <code>loop</code> function. Each iteration of the loop\n      prints the current value, then assigns the new value. We create\n      two threads with the <code>Thread.create</code> expressions,\n      then use <code>Thread.join</code> to block until the threads\n      terminate.\n    </blockquote>")))
 (idp8164768
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      When threads share imperative state, this gives rise to the\n      standard synchronization issues, where multiple threads may be\n      mutating shared state at the same time. To illustrate, let's write\n      a program with two threads that increment a shared reference cell\n      concurrently.\n    </blockquote>")))
 (idp8163696
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The OCaml standard library supports threads, where individual\n      threads of control can be created that run concurrently (but only\n      one thread at a time), and context switches are\n      <span><em>involuntary</em></span>, meaning that a thread may be\n      preempted at any time.\n    </blockquote>")))
 (idp8162896
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Concurrency is another tool OCaml programmers can use to simplify\n      programs in certain cases. In OCaml, threads do not introduce\n      parallelism; only one thread may be running at a time. However,\n      threads can be used to simplify control flow -- a program can\n      devote some threads to reading input, others for performing work,\n      others for producing output, etc.\n    </blockquote>")))
 (idp8156080
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The module <code>WeakHash</code> has the semantics of a\n        set of elements. The <code>WeakHash.merge</code> function\n        retrieves an element if it already exists, or adds it otherwise.\n        The constructors are much as before.\n      </blockquote>")))
 (idp8153424
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The weak hash table requires that hash and equality functions be\n        provided explicitly, so we construct a module\n        <code>HashExp</code> that defines the\n        <code>equal</code> and <code>hash</code> functions.\n        Note that equality and hashing are both constant-time functions\n        -- equality can rely on physical equality of subexpressions, and\n        hashing can use the explcitly represented hash values.\n      </blockquote>")))
 (idp8151088
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        We define the type <code>WExp.t</code> much as before,\n        except including the hash code for the <code>Plus</code>\n        and <code>Times</code> expressions.\n      </blockquote>")))
 (idp8149680
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        To deal with this problem, we can use &quot;weak&quot; hash\n        tables, implemented in the <code>Weak</code> module in the\n        OCaml standard library. The main difference is that a weak table\n        may drop values that are no longer being used elsewhere. Weak\n        tables are tied into the garbage collector, which removes values\n        that are no longer live.\n      </blockquote>")))
 (idp8148592
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        A more serious problem is that the hash table holds onto\n        expressions <span><em>forever</em></span>, even if they are no\n        longer used in the program. This can result in a space leak that\n        cancels out any space saving we had in the first place, perhaps\n        making it even worse.\n      </blockquote>")))
 (idp8147760
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        There is two issues with hash-consing as we have just defined\n        it. A minor problem is that hashing is linear in the size of the\n        expression. This can be fixed by storing the hash code in the\n        expression itself, avoiding the recursive computation. If\n        expressions are small, this won't be much of a benefit, but it\n        can save time if large expressions are frequently constructed.\n      </blockquote>")))
 (idp8144432
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Expressions that are not equal are equal are not physically\n        equal either, however common subexpressions are equal.\n      </blockquote>")))
 (idp8142688
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Note that expressions that are structurally equal are now also\n        physically equal.\n      </blockquote>")))
 (idp8140624
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The implementation defines a hash table\n        <code>table</code>, and a <code>merge</code>\n        function that merges an expression into the table, returning the\n        previous value if there was one, or inserting a new value if\n        there is not. The constructors can rely on the fact that\n        subexpressions have already been hash-consed, so they simply\n        call the merge function to memoize the value.\n      </blockquote>")))
 (idp8133664
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The type <code>Exp.t</code> is declared as\n        <code>private</code>, meaning that pattern matching can be\n        used on the expressions outside the module, but expressions\n        can't be constructed without explicitly using the constructors\n        <code>num</code>, <code>var</code>,\n        <code>plus</code>, <code>times</code> provided by\n        the <code>Exp</code> module. These functions enforce the\n        hash-consing, ensuring that structurally equal expressions are\n        mapped to physically equal representations.\n      </blockquote>")))
 (idp8132240
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        One of the simplest ways to implement hash-consing is to use a\n        hash-table to remember (memoize) values that have already been\n        created. To illustrate, let's define a kind of numerical\n        expression <code>Exp.t</code> consisting of integers,\n        variables, addition, and multiplication (we can define more\n        operators, but let's keep the example simple).\n      </blockquote>")))
 (idp8130096
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        &quot;Hash consing&quot; is a technique to share values that are\n        structurally equal. The term comes from Lisp, where the\n        technique is used to share s-expressions that are equal. In some\n        situations, hash-consing can result in dramatic performance\n        improvements in two ways. First, space can be reduced by using a\n        single physical representation for values that are equal.\n        Second, values can be compared for equality using the\n        constant-time physical equality operator <code>==</code>.\n      </blockquote>")))
 (idp8128480
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Note that this use of memoization relies on side-effects to\n        cache intermediate computations, but it doesn't change the\n        values of the function. Its purpose is to improve performance.\n      </blockquote>")))
 (idp8126208
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Next, let's construct a memoized version of the function, where\n        the recursive calls are made through a memo table. This makes a\n        dramatic improvement in performance. Since the recursive calls\n        are computed just once, the complexity is linear, and the\n        computation is fast.\n      </blockquote>")))
 (idp8123344
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The complexity of this function is exponential\n        <span><em>O(2^i)</em></span>, because for large inputs the\n        function computes two similar-sized subproblems. To illustrate,\n        let's time the computation using the <code>Sys.time</code>\n        function to measure the wall clock.\n      </blockquote>")))
 (idp8120784
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        Memoization is useful for <span><em>dynamic\n        programming</em></span>, where problems are solved by breraking\n        them down into simpler subproblems. If subproblems occur more\n        than once, memoization can be used to avoid recomputing the\n        subproblem. A canonical example of this is the Fibonacci\n        sequence, which is defined by the following program, which\n        produces the sequence <span><em>0, 1, 1, 2, 3, 5, 8, 13, 21,\n        ...</em></span> starting from 0.\n      </blockquote>")))
 (idp8117936
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        We can generalize lazy computations to function\n        <span><em>memoization</em></span>, where we save the result of\n        function applications to avoid their recomputation. One simple\n        implementation is to use a hash table to save the values by side\n        effect.\n      </blockquote>")))
 (idp8111184
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The <code>'a delayed</code> type contains a delayed value\n      represented as a function, or else an actual value. The\n      <code>ImpLazy.force</code> function forces the computation;\n      if it is delayed, the function is evaluated, and the value is\n      mutated to save the resulting value. Subsequent calls to\n      <code>ImpLazy.force</code> will fall into the\n      <code>Value</code> case, without needing to reevaluate the\n      function. The main difference between our module\n      <code>ImpLazy</code> and the builtin module\n      <code>Lazy</code> is the nice syntax for the latter. Rather\n      than writing <code>ImpLazy.create (fun () -&gt; e)</code>,\n      the builtin syntax is just <code>lazy e</code>.\n    </blockquote>")))
 (idp8108272
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The builtin <code>lazy</code> computation has a nice syntax,\n      but the technique is pretty generic, and we can implement it with\n      a mutable value.\n    </blockquote>")))
 (idp8104688
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      One of the simplest of these is the builtin lazy computation. The\n      keyword <code>lazy</code> can be used to prefix any\n      expression, returning a value of type\n      <code>'a Lazy.t</code>. The computation is delayed until\n      forced with the <code>Lazy.force</code> function, and then\n      saved thereafter.\n    </blockquote>")))
 (idp8103920
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      There are many instances where imperative programming is used to\n      change or improve the performance characteristics of a program,\n      without otherwise changing the behavior. In other words, the\n      program could be written without side-effects, but performance is\n      improved by techniques like lazy computation, caching,\n      memoization, etc.\n    </blockquote>")))
 (idp8100944
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The <code>iterator</code> function returns in iterator that\n      refers to the first element in the table (if the table is\n      non-empty). The <code>find</code> function searches for an\n      element in the table, returning an iterator referring to that\n      value if found, or else the an iterator at the end of the table.\n    </blockquote>")))
 (idp8098560
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Now that the iterator is defined, we can complete the\n      <code>IterableHashMap</code> implementation.\n    </blockquote>")))
 (idp8092160
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      There are several more things to note. The syntax\n      <code>object (self) ... end</code> means that the variable\n      <code>self</code> refers to the object itself, allowing\n      other method in the object to be called (like\n      <code>self#normalize</code>). The fields\n      <code>index</code> and <code>dlist_it</code> are\n      declared as <code>val mutable</code>, which means that they\n      can be modified by assignment using the <code>&lt;-</code>\n      syntax seen in the <code>normalize</code> method. Finally,\n      the object also has an <code>initializer</code> expression,\n      which is called when the object is first created, in this case\n      normalizing the iterator.\n    </blockquote>")))
 (idp8087040
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The <code>normalize</code> method is declared a\n      <code>private</code>, so that it does not appear as part of\n      the iterator type. The <code>has_value</code> and\n      <code>value</code> methods delagate directly to the list\n      iterator. The <code>next</code> and\n      <code>remove</code> methods also delagate to the list\n      iterator; however, since the iterator has been mutated, the\n      <code>normalize</code> method is called to advance to the\n      next element.\n    </blockquote>")))
 (idp8085376
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The iterator implementation relies on a &quot;normal&quot; form,\n      where the list iterator <span><em>always</em></span> refers to an\n      element. This is handled by the <code>normalize</code>\n      method, which advances past empty buckets until either a non-empty\n      bucket is found, or the end of the table is reached.\n    </blockquote>")))
 (idp8080464
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      We can define iterators in the hash table as a pair of a bucket\n      index and <code>DList</code> iterator into the bucket. To\n      define this as an object, we'll introduce a few more object\n      concepts, including mutable fields, private methods, and\n      initializers. The function\n      <code>make_iterator table index_ dlist_it_</code> returns an\n      iterator for the bucket with index <code>index_</code> and\n      list iterator <code>dlist_it_</code>.\n    </blockquote>")))
 (idp8075072
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The implementation of <code>IterableHashMap</code> is\n      similar to the original <code>HashMap</code> using lists,\n      except now we will use doubly-linked lists. The\n      <code>create</code> function creates an array of\n      doubly-linked lists. The <code>add</code> function first\n      removes any existing entry, then add the new element to the front\n      of the bucket.\n    </blockquote>")))
 (idp8071696
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Let's return to the example of hash tables, but this time let's\n      define an iterator-style interface. We'll use the same\n      <code>iterator</code> object type as we did for\n      doubly-linked lists, but this time the iteration is over key/value\n      pairs. The signature changes slightly, the main change being tat\n      the <code>find</code> function returns an iterator. This\n      allows retrieval of the value associated with a key, and it also\n      allows the entry to be deleted.\n    </blockquote>")))
 (idp8068096
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      We have seen the definition of all of the functions except\n      <code>find</code>, which searches for an element in the list\n      (sequentially), returning an iterator that refers to that element\n      if it exists. The implementation simply creates an iterator, then\n      uses a loop to search sequentially for the element. If the element\n      is found, the returned iterator refers to that value, otherwise\n      the iterator does not have a value.\n    </blockquote>")))
 (idp8064752
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Now that we have defined iterators, let's declare the complete\n      signature for doubly-linked lists as a module. The type of\n      elements <code>'a element</code> is internal to the\n      implementation, and the type of lists\n      <code>'a DList.t</code> is abstract.\n    </blockquote>")))
 (idp8061472
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Note that the doubly-linked list is a <span><em>cyclic</em></span>\n      data structure. Most notably, the builtin equality <span><em>does\n      not work</em></span> in general with cyclic values.\n    </blockquote>")))
 (idp8052896
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The reference cell <code>current</code> holds the current\n      position in the list. The method <code>has_value</code>\n      returns true if <code>current</code> refers to an element,\n      <code>value</code> returns the element, and\n      <code>next</code> advances the iterator. The method\n      <code>remove</code> unlinks the <code>current</code>\n      element by setting the previous element's <code>next</code>\n      pointer, and the next's elements <code>previous</code>\n      pointer, then advancing <code>current</code> to the next\n      element. The following example illustrates the semantics.\n    </blockquote>")))
 (idp8049136
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Next, to define the iterator implementation, we implement each of\n      the methods, bracketed by <code>object ... end</code>,\n      declaring each method with the <code>method</code> keyword.\n    </blockquote>")))
 (idp8046736
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Each of the labeled parts <code>has_value</code>,\n      <code>value</code>, etc. are object\n      <span><em>methods</em></span>. This object type corresponds to an\n      <span><em>interface</em></span> consisting of a set of methods.\n    </blockquote>")))
 (idp8044336
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      First, we need to define a generic iterator type. For clarity,\n      we'll use a more verbose type than in Java. We'll separate\n      retrieving a value from advacing to the next element. The object\n      type is specified like a record type, but using angle brackets\n      <code>&lt; ... &gt;</code>.\n    </blockquote>")))
 (idp8043600
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      You can skip forward to the Objects chapter for more informatation\n      about objects, but we'll be using basic objects, which are just\n      collections of methods, similar to having a record of functions --\n      we could also implement the iterator as a record of functions, but\n      the code would be somewhat more verbose.\n    </blockquote>")))
 (idp8041904
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      When we define a similar iterator concept in OCaml, we need to\n      choose how to represent it. We <span><em>could</em></span> define a\n      separate iterator type for each kind of container, but this would\n      be inconvenient, since iterators have similar behavior for many\n      different kinds of containers. To define a\n      <span><em>generic</em></span> iterator, there are several\n      reasonable choices: we can use first-class modules, or we can use\n      objects. One of the simpler approaches is to use objects.\n    </blockquote>")))
 (idp8038656
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      At any time, a <code>Iterator</code> object refers\n      (optionally) to some element of a container. The\n      <code>hasNext()</code> method returns true if the iterator\n      refers to an element; the method <code>next()</code> returns\n      the element, and also advances to the next one; and\n      <code>remove()</code> removes the last element returned by\n      the iterator.\n    </blockquote>")))
 (idp8037088
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Let's define a Java-style kind of generic iterator object that\n      allows manual enumeration and mutation of the container. Here is\n      the Java interface.\n    </blockquote>")))
 (idp8034960
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      This style of iteration is concise and completely general.\n      However, with imperative containers, we often want more control.\n      We may not want to iterate through all elements, and we often want\n      to mutate the container as we iterate. One conventional way to do\n      this is to define a generic <code>iterator</code> type that\n      can be used to enumerate and/or mutate the elements in a\n      container. This is a style seen, for example, in Java (type\n      <code>Iterator</code>) or the C++ Standard Template Library.\n    </blockquote>")))
 (idp8032336
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Defining this for doubly-linked lists is simple enough. The\n      following function iterates through the list, applying the\n      function <code>f</code> to each element in turn.\n    </blockquote>")))
 (idp8027792
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      When defining containers like lists, dictionaries, trees, etc. it\n      is conventional to define some kind of iteration to allow the\n      elements of the collection to be enumerated. When the containers\n      are immutable, like <code>'a list</code>, this is normaly\n      done with functions like <code>iter</code>,\n      <code>map</code>, and <code>fold</code>. Each of these\n      iteration functions takes a function that will be applied to each\n      of the elements in order.\n    </blockquote>")))
 (idp8021280
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The <code>remove</code> function unlinks the element from\n      the list, the resets the <code>previous</code> and\n      <code>next</code> links to <code>None</code>. For\n      safety, we detect duplicate removals with a check. In the case\n      where the previous element is <code>None</code>, the element\n      must be first in the list. Here is the implementation of the\n      <code>check_is_first_element</code> function.\n    </blockquote>")))
 (idp8019376
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      To complete this initial part of the implementation, let's define\n      a function for removal.\n    </blockquote>")))
 (idp8016272
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Also note, the precedence of a <code>match</code> expression\n      is very low, so to separate it from the following assignment\n      <code>l := Some new_front</code>, we surround the match in a\n      <code>begin ... end</code> bracketing (we could also use\n      parentheses). If we did not, the final assignment would become\n      part of the <code>None -&gt; ...</code> case, which is not\n      what we want.\n    </blockquote>")))
 (idp8013536
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      There are a few more things to note. First, semicolon\n      <code>;</code> is a <span><em>separator</em></span>, not a\n      terminator, like it is in C or Java. The compiler is somewhat\n      relaxed about parsing a terminating semicolon, so it may work for\n      you, but you should not rely on it.\n    </blockquote>")))
 (idp8007328
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      In general, when a sequence expression\n      <code>expr1; expr2</code> is evaluated,\n      <code>expr1</code> is evaluated first, and then\n      <code>expr2</code>. The expression <code>expr1</code>\n      must have type <code>unit</code>, and the the value of\n      <code>expr2</code> is returned as the value of the entire\n      sequence. For example, the sequence\n      <code>print_string &quot;hello world&quot;; 1 + 2</code>\n      first prints the string\n      <code>&quot;hello world&quot;</code>, then returns the\n      integer <code>3</code>.\n    </blockquote>")))
 (idp8003024
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      This example introduces the sequencing operator\n      <code>;</code> to separate the steps to be executed in\n      order: first, create the new element <code>elt</code>; then\n      set <code>old_first.previous</code> to point to it; then set\n      the list <code>l</code> to refer to the\n      <code>elt</code> element; then return the element\n      <code>elt</code>.\n    </blockquote>")))
 (idp8000640
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Next, let's define the function that inserts a value into the list\n      as a new first element. We define a new element\n      <code>elt</code>, link it into the list, and set the list\n      reference.\n    </blockquote>")))
 (idp7995104
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The function <code>create</code> creates an empty list. The\n      function <code>is_empty l</code> dereferences the list using\n      the <code>!</code> operator, returning true if the value is\n      <code>None</code>, or false otherwise. The\n      <code>value</code> function returns the value stored in an\n      element. The <code>first</code>, <code>next</code>,\n      and <code>previous</code> functions allow navigation through\n      the list.\n    </blockquote>")))
 (idp7990816
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The list itself is either empty, or it refers to the first element\n      of the list. We use the type\n      <code>type 'a dlist = 'a element option ref</code>; the\n      <code>ref</code> allows the list to be mutated, and the\n      value is either <code>None</code> for the empty list, or\n      <code>Some first_element</code> if the list is non-empty.\n    </blockquote>")))
 (idp7988128
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Core defines a standard doubly-linked list, but let's define our\n      own implementation for illustration. First, we define an element\n      <code>'a element</code> with a reference both to the\n      previous and next elements. The elements at the ends have nothing\n      to refer to, so we use an option to allow the reference to be\n      <code>None</code>. The element record fields are declared as\n      <code>mutable</code> to allow them to be modified when the\n      list is mutated.\n    </blockquote>")))
 (idp7986432
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Another common imperative data structure is the doubly-linked\n      list, which allows traversal in both directions, as well as O(1)\n      deletion of any element. Doubly-linked lists are a cyclic data\n      structure, meaning that it is possible to follow a nontrivial\n      sequence of references from an element, through other elements,\n      back to itself. In general, building cyclic data structures\n      requires the use of side-effects (although in some limited cases,\n      they can be constructed using <code>let rec</code>). This is\n      done by constructing the data elements first, and then adding\n      cycles using assignment afterwards.\n    </blockquote>")))
 (idp7983840
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      A while-loop iterates until the condition is false.\n    </blockquote>")))
 (idp7980352
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      A <code>downto</code> loop advances downward by 1 on each\n      iteration. Again, the bounds <code>&lt;initial&gt;</code>\n      and <code>&lt;final&gt;</code> are inclusive.\n    </blockquote>")))
 (idp7975712
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      A loop using <code>to</code> advances by from the\n      <code>&lt;initial&gt;</code> integer to the\n      <code>&lt;final&gt;</code> one (inclusive). No iterations\n      are evaluated if <code>&lt;final&gt;</code> is smaller than\n      <code>&lt;initial&gt;</code>.\n    </blockquote>")))
 (idp7971712
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      The <code>iter</code> function iterates through all of the\n      elements in the table using a <code>for</code> loop. There\n      are two kinds of loops in OCaml, <code>for</code> loops and\n      <code>while</code> loops.\n    </blockquote>")))
 (idp7965504
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      As the example shows, reference cells are actually just a short\n      form for record operations. The <code>ref</code> type is a\n      record with a single mutable field <code>contents</code>,\n      with the following definition. The expression\n      <code>!x</code> is equivalent to\n      <code>x.contents</code>, and <code>x := e</code> is\n      equivalent to <code>x.contents &lt;- e</code>.\n    </blockquote>")))
 (idp7963056
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>refcell := expr</code> replaces the contents of\n          the reference cell.\n        </blockquote>")))
 (idp7961584
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>! refcell</code> returns the contents of the\n          reference cell.\n        </blockquote>")))
 (idp7959456
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n<code>ref expr</code> constructs a reference cell\n          containing the value defined by the expression\n          <code>expr</code>.\n        </blockquote>")))
 (idp7958176
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      Note that variables are not mutable. Variables can refer to\n      mutable data, but the binding of a variable cannot be changed. For\n      convenience, OCaml defines a type of &quot;reference cell,&quot;\n      which is a like a &quot;box&quot; where the contents can be\n      mutated.\n    </blockquote>")))
 (idp7955584
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n          Object fields can be mutated with the expression\n          <code>object.label &lt;- expr</code>. The field\n          <code>label</code> must be declared as\n          <code>mutable</code> in the object definition.\n        </blockquote>")))
 (idp7952784
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n          Record fields can be mutated with the expression\n          <code>record.label &lt;- expr</code>. The field\n          <code>label</code> must be declared as\n          <code>mutable</code> in the type definition for the\n          record.\n        </blockquote>")))
 (idp7950592
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n          Strings. String elements can be mutated with the expression\n          <code>string.[index]   &lt;- char</code>. See the\n          <code>String</code> module for other imperative\n          operations.\n        </blockquote>")))
 (idp7947728
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n          Arrays. Array elements can be assigned with the expression\n          <code>array.(index) &lt;-   expr</code>. See the\n          <code>Array</code> module for other imperative\n          operations. Bigarray elements can be mutated with the syntax\n          <code>bigarray.{index} &lt;- expr</code>.\n        </blockquote>")))
 (idp7946656
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n      This example illustrates one of the mutating operations in OCaml:\n      array element assignment. There are a handful of other mutable\n      data types.\n    </blockquote>")))
 (idp7944416
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The <code>iter</code> function iterates through each of\n        the elements in the buckets.\n      </blockquote>")))
 (idp7942880
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The <code>find</code> function performs a linear search\n        through the appropriate bucket to find the value associated with\n        a key.\n      </blockquote>")))
 (idp7939648
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The <code>add</code> function uses the hash function to\n        determine the appropriate bucket, then adds a new key/value\n        association to the bucket through an array\n        <span><em>assignment</em></span>\n<code>table.(index) &lt;- (key, data) :: table.(index)</code>,\n        which <span><em>replaces</em></span> the bucket with a new one\n        where the new key/value pair is added to the front of the list.\n      </blockquote>")))
 (idp7938160
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n        The <code>create</code> function creates a new array where\n        all buckets are empty.\n      </blockquote>")))
 (idp7936304
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n    The table is implemented as an array of buckets (the array is\n    fixed-size, in this example). The OCaml runtime provides a builtin\n    polymorphic hash function <code>Hashtbl.hash</code> that works\n    for almost any value in OCaml, excluding functions and values from C\n    libraries that live outside the heap.\n  </blockquote>")))
 (idp7933312
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n    The signature for the <code>HashMap</code> declares the type\n    of dictionaries <code>('a, 'b) t</code>, with keys of type\n    <code>'a</code> and associated values of type\n    <code>'b</code>. It also includes functions for add, removing,\n    and enumerating entries in the dictionary.\n  </blockquote>")))
 (idp7929504
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n    To illustrate imperative programming, let's start by implementing a\n    hash table. Hash tables are an efficient way to implement imperative\n    <span><em>dictionaries</em></span>, which implement a map from keys\n    to values. There are full-featured implementations of hash tables in\n    Core as well as in the OCaml standard library. For illustration,\n    we'll construct just a basic dictionary using <span><em>open\n    hashing</em></span>, where the hash table consists of an array of\n    buckets, each of which contain a linked list of elements. We'll use\n    regular (pure) OCaml lists, and an array for the buckets.\n  </blockquote>")))
 (idp7928480
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n    While the majority of code you write in OCaml may be pure,\n    imperative programming can be used effectively. The language\n    includes assignment and mutable values like arrays and strings.\n    Evaluation order is strict and sequential. In principle, you can\n    port many imperative programs directly to OCaml. If you find\n    yourself using imperative features a lot, then you're probably not\n    using OCaml to its fullest. However, there are times when imperative\n    programming is both appropriate and efficient, and OCaml shines at\n    supporting programs with both functional and imperative aspects.\n  </blockquote>")))
 (idp7927152
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n    Pure functions behave like mathematical functions, which means that\n    they always evaluate to the same result on the same arguments,\n    without any side-effects on the state or input/output. In pure\n    programs, evaluation order may affect performance, but it doesn't\n    affect correctness. In contrast, <span><em>imperative</em></span>\n    programs operate through side-effects on the state (as well as\n    input/output). Imperative programs define sequences of commands for\n    the computer to perform, and evaluation order is strict.\n  </blockquote>")))
 (idp7925824
  ((file imperative-programming-1.html)
   (html
    "<blockquote>\n    The OCaml programming language is <span><em>functional</em></span>,\n    meaning that functions are first-class values that can be passed\n    around like any other. However, this doesn't mean that OCaml\n    programs are <span><em>pure</em></span>.\n  </blockquote>")))
 (idp8776176
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      We'll also return to the Github example here later in the book\n      when discussing the Async networking library, and you can find the\n      full ATD specification for Github in the\n      <a href=\"http://github.com/avsm/ocaml-github\" target=\"_top\"><code>ocaml-github</code></a>\n      repository.\n    </blockquote>")))
 (idp8774064
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The full ATD specification is quite sophisticated (and well\n      documented online at its homepage). The ATD compiler can also\n      target formats other than JSON, and also outputs code for other\n      languages such as Java if you need more interoperability. There\n      are also several similar projects you can investigate which\n      automate the code generation process:\n      <a href=\"http://piqi.org\" target=\"_top\">Piqi</a> uses the Google protobuf\n      format, and <a href=\"http://thrift.apache.org\" target=\"_top\">Thrift</a>\n      supports a huge variety of other programming languages.\n    </blockquote>")))
 (idp8772656
  ((file handling-json-data.html)
   (html
    "<blockquote>\n<code>-j-defaults</code>: force the output a JSON value\n          even if the specification defines it as the default value for\n          that field.\n        </blockquote>")))
 (idp8771120
  ((file handling-json-data.html)
   (html
    "<blockquote>\n<code>-j-custom-fields FUNCTION</code>: call a custom\n          function for every unknown field encountered, instead of\n          raising a parsing exception.\n        </blockquote>")))
 (idp8769616
  ((file handling-json-data.html)
   (html
    "<blockquote>\n<code>-j-std</code>: work in standard JSON mode, and\n          never print non-standard JSON extensions.\n        </blockquote>")))
 (idp8767808
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      This is pretty convenient! We've written a single ATD file, and\n      all the OCaml boilerplate to convert between JSON and a strongly\n      typed record has been generated for us. You can control various\n      aspects of the serializer by passing flags to\n      <code>atdgen</code>. The important ones for JSON are:\n    </blockquote>")))
 (idp8763552
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The <code>Github_t</code> module only contains the type\n      definitions, while <code>Github_j</code> has a concrete\n      serialization module to and from JSON. You can read the\n      <code>github_j.mli</code> to see the full interface, but the\n      important functions for most uses are the conversion functions to\n      and from a string. For our example above, this looks like:\n    </blockquote>")))
 (idp8760896
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      There is an obvious correspondence to the ATD definition. Note in\n      particular that field names in separate OCaml records cannot\n      shadow each other, and so we specifically prefix every field with\n      a prefix to distinguish it from other records. For example,\n      <code>&lt;ocaml field_prefix=&quot;auth_req_&quot;&gt;</code>\n      in the ATD spec prefixes every field name in the generated\n      <code>authorization_request</code> record with\n      <code>auth_req</code>.\n    </blockquote>")))
 (idp8757696
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      This will generate some new files in your current directory.\n      <code>Github_t.ml</code> and <code>Github_t.mli</code>\n      will contain an OCaml module with types defines that correspond to\n      the ATD file. It looks like this:\n    </blockquote>")))
 (idp8756256
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The ATD spec can be compiled to a number of OCaml targets. Let's\n      run the compiler twice, to generate some OCaml type definitions,\n      and a JSON serialiser.\n    </blockquote>")))
 (idp8754864
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      ATD is (deliberately) similar to OCaml type definitions. Each\n      field can include extra annotations to customise the parsing code\n      for a particular backend. For example, the Github\n      <code>scope</code> field above is defined as a variant type,\n      but with the actual JSON values being defined explicitly (as\n      lower-case versions).\n    </blockquote>")))
 (idp8751904
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      Let's go straight into looking at an example of how this works, by\n      using a small portion of the Github API. Github is a popular code\n      hosting and sharing website that provides a JSON-based web\n      <a href=\"http://developer.github.com\" target=\"_top\">API</a>. The ATD code\n      fragment below describes the Github authorization API. It is based\n      on a pseudo-standard web protocol known as OAuth, and is used to\n      authorized users to access Github services.\n    </blockquote>")))
 (idp8750560
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The idea behind ATD is to specify the format of the JSON in a\n      separate file, and then run a compiler (<code>atdgen</code>)\n      that outputs OCaml code to construct and parse JSON values. This\n      means that you don't need to write any OCaml parsing code at all,\n      as it will all be auto-generated for you.\n    </blockquote>")))
 (idp8749280
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The combinators described earlier make it fairly easy to extract\n      fields from JSON records, but the process is still pretty manual.\n      We'll talk about how to do larger-scale JSON parsing now, using a\n      domain-specific language known as\n      <a href=\"http://oss.wink.com/atdgen/\" target=\"_top\">ATD</a>.\n    </blockquote>")))
 (idp8744192
  ((file handling-json-data.html)
   (html
    "<blockquote>\n        The only purpose of these extensions is to make the data\n        representation more expressive without having to refer to the\n        original OCaml types. You can always cast a\n        <code>Safe.json</code> to a <code>Basic.json</code>\n        type by using the <code>to_basic</code> function as\n        follows:\n      </blockquote>")))
 (idp8741584
  ((file handling-json-data.html)
   (html
    "<blockquote>\n            The <code>Variant</code> type encodes OCaml variants\n            more explicitly, as\n            <code>&lt;&quot;Foo&quot;&gt;</code> or\n            <code>&lt;&quot;Bar&quot;:123&gt;</code> for a variant\n            with parameters.\n          </blockquote>")))
 (idp8739568
  ((file handling-json-data.html)
   (html
    "<blockquote>\n            The <code>Tuple</code> type is stored as\n            <code>(&quot;abc&quot;, 123)</code> instead of a list.\n          </blockquote>")))
 (idp8736192
  ((file handling-json-data.html)
   (html
    "<blockquote>\n            The <code>lit</code> suffix denotes that the value is\n            stored as a JSON string. For example, a\n            <code>Floatlit</code> will be stored as\n            <code>&quot;1.234&quot;</code> instead of\n            <code>1.234</code>.\n          </blockquote>")))
 (idp8735216
  ((file handling-json-data.html)
   (html
    "<blockquote>\n        The extensions includes with Yojson include:\n      </blockquote>")))
 (idp8731360
  ((file handling-json-data.html)
   (html
    "<blockquote>\n        You should immediately be able to spot a benefit of using\n        polymorphic variants here. A standard JSON type such as a\n        <code>String</code> will type-check against both the\n        <code>Basic</code> module and also the non-standard\n        <code>Safe</code> module. However, if you use extension\n        values such as <code>Tuple</code> with the\n        <code>Basic</code> module, they will not be a valid\n        sub-type and the compiler will complain.\n      </blockquote>")))
 (idp8727824
  ((file handling-json-data.html)
   (html
    "<blockquote>\n        The standard JSON types are <span><em>really</em></span> basic,\n        and OCaml types are far more expressive. Yojson supports an\n        extended JSON format for those times when you're not\n        interoperating with external systems and just want a convenient\n        human-readable local format. The\n        <code>Yojson.Safe.json</code> type is a superset of the\n        <code>Basic</code> polymorphic variant, and looks like\n        this:\n      </blockquote>")))
 (idp8726096
  ((file handling-json-data.html)
   (html
    "<blockquote>\n<span><em>avsm</em></span>: segway into memory representation of\n      polyvariants here?\n    </blockquote>")))
 (idp8722064
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      In this case, we've marked the <code>x</code> as being of\n      type <code>Yojson.Basic.json</code>, and the compiler\n      immediately spots that the argument to the\n      <code>Assoc</code> variant has the incorrect type. This\n      illustrates the strengths and drawbacks of using polymorphic\n      variants: they make it possible to easily subtype across module\n      boundaries (the <code>Basic</code> and\n      <code>Safe</code> in Yojson's case), but the error messages\n      can be more confusing. However, a bit of careful manual type\n      annotation is all it takes to make tracking down such issues much\n      easier.\n    </blockquote>")))
 (idp8719744
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The type error above isn't <span><em>wrong</em></span> as such, but\n      can be inconvenient to wade through for larger values. An easy way\n      to narrow down this sort of type error is to add explicit type\n      annotations as a compiler hint about your intentions:\n    </blockquote>")))
 (idp8713424
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      In the example above, although the value that <code>x</code>\n      has is compatible with the type <code>json</code>, it's not\n      explicitly defined as such. The type inference engine will figure\n      out a type that is based on how the value <code>x</code> is\n      used, and in this case only the <code>Assoc</code> and\n      <code>String</code> variants are present. One difficulty you\n      will encounter is that type errors involving polymorphic variants\n      can be quite verbose if you make a mistake in your code. For\n      example, suppose you build an <code>Assoc</code> and include\n      a single value instead of a list of keys:\n    </blockquote>")))
 (idp8710336
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      To build and print JSON values, you can just construct values of\n      type <code>json</code> and call the\n      <code>to_string</code> function. There are also\n      pretty-printing functions that lay out the output in a more\n      human-readable style:\n    </blockquote>")))
 (idp8708400
  ((file handling-json-data.html)
   (html
    "<blockquote>\n        In the last part of the example, we simply print the parsed\n        fields since they are just normal OCaml values. This technique\n        of using chained parsing functions is very powerful in\n        combination with the OCaml type system. Many errors that don't\n        make sense at runtime (for example, mixing up lists and objects)\n        will be caught statically via a type error.\n      </blockquote>")))
 (idp8703824
  ((file handling-json-data.html)
   (html
    "<blockquote>\n            The <code>is_online</code> and\n            <code>is_translated</code> fields are optional in our\n            JSON schema, and no error is raised if they are not present\n            in the JSON array. The resulting OCaml type is a\n            <code>string option</code> to reflect this. In our\n            example, only <code>is_online</code> is present and\n            <code>is_translated</code> will be\n            <code>None</code>.\n          </blockquote>")))
 (idp8700304
  ((file handling-json-data.html)
   (html
    "<blockquote>\n            The <code>tags</code> field is similar to\n            <code>title</code>, but are passed through the\n            <code>to_list</code> combinator since they are a JSON\n            list. The <code>filter_string</code> combinator folds\n            all of the strings in the JSON list into an OCaml list (any\n            non-strings also in there are simply ignored).\n          </blockquote>")))
 (idp8698096
  ((file handling-json-data.html)
   (html
    "<blockquote>\n            For the <code>title</code> string, the\n            <code>member</code> combinator extracts the key from\n            the array, and casts it to an OCaml string. An exception is\n            raised if the JSON value is not a string.\n          </blockquote>")))
 (idp8695264
  ((file handling-json-data.html)
   (html
    "<blockquote>\n        This introduces the <code>Yojson.Basic.Util</code> module,\n        which contains <span><em>combinator</em></span> functions for\n        JSON manipulation. Combinators are a style of function that can\n        be chained together using the <code>|!</code> pipe\n        operator to select and convert values out of the JSON structure.\n        Let's examine some of them in more detail:\n      </blockquote>")))
 (idp8692256
  ((file handling-json-data.html)
   (html
    "<blockquote>\n        Now that we've figured out how to parse the example JSON, lets\n        see how we can manipulate it from OCaml code with a more\n        complete example.\n      </blockquote>")))
 (idp8689424
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      If you feel like hanging your OCaml interpreter, you can verify\n      what happens with recursive values for yourself:\n    </blockquote>")))
 (idp8684880
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      It's quite easy to mix up the use of <code>=</code> and\n      <code>==</code>, so Core disables the <code>==</code>\n      operator and provides <code>phys_equal</code> instead.\n      You'll see a type error if you use <code>==</code> anywhere:\n    </blockquote>")))
 (idp8682608
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The <code>=</code> structural equality operator recursively\n      inspects each field in the two values and tests them individually\n      for equality. In the JSON parsing example, every field will be\n      traversed and checked, and they will check out as equal.\n      Crucially, if your data structure is cyclical (that is, a value\n      recursively points back to another field within the same\n      structure), the <code>=</code> operator will never\n      terminate, and your program will hang! In this situation, you must\n      use the physical equality operator, or write a custom comparison\n      function that breaks the recursion.\n    </blockquote>")))
 (idp8679952
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The <code>==</code> physical equality test will match if two\n      data structures have precisely the same pointer in memory. Two\n      data structures that have identical contents, but are constructed\n      separately, will not match using this operator. In the JSON\n      example, the <code>json1</code> and <code>json2</code>\n      values are not identical and so would fail the physical equality\n      test.\n    </blockquote>")))
 (idp8676832
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      If you come from a C/C++ background, you will probably reflexively\n      use <code>==</code> to test two values for equality. In\n      OCaml, <code>==</code> tests for\n      <span><em>physical</em></span> equality, and <code>=</code>\n      tests for <span><em>structural</em></span> equality.\n    </blockquote>")))
 (idp8671152
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The <code>from_file</code> function accepts an input\n      filename and takes care of opening and closing it for you. It's\n      far more common to use <code>from_string</code> to construct\n      a JSON value from an OCaml <code>string</code>. These\n      strings can come from a network connection (we'll see more of this\n      in <a href=\"\">???</a>)\n      or even a database. Finally, the example checks that the two input\n      mechanisms actually resulted in the same OCaml data structure.\n    </blockquote>")))
 (idp8667760
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The <code>in_channel</code> constructor is from the original\n      OCaml standard library, and its use is considered deprecated when\n      using the Core standard library. This leaves us with two ways of\n      parsing the JSON: either from a string buffer, or from a file on a\n      filesystem. The next example shows both in action, assuming the\n      JSON record is stored in a file called\n      <span><em>book.json</em></span>:\n    </blockquote>")))
 (idp8665984
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      When first reading these interfaces, you can generally ignore the\n      optional arguments (which have the question marks in the type\n      signature), as they will be filled in with sensible values. The\n      signature for these values with the optional elements removed\n      makes their purpose quite clear:\n    </blockquote>")))
 (idp8662960
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      Let's parse the earlier JSON string example into this type now.\n      The first stop is the <code>Yojson.Basic</code>\n      documentation, where we find these helpful functions:\n    </blockquote>")))
 (idp8659296
  ((file handling-json-data.html)
   (html
    "<blockquote>\n      The JSON specification has very few data types, and Yojson\n      implements these in the <code>Yojson.Basic</code> module.\n      The <code>json</code> type shown below is sufficient to\n      express any valid JSON structure. Note that some of the types are\n      recursive, so that fields can contain references to more JSON\n      fields, and that it also specifically includes a\n      <code>Null</code> variant for empty fields.\n    </blockquote>")))
 (idp8655472
  ((file handling-json-data.html)
   (html
    "<blockquote>\n    There are several JSON libraries available for OCaml. For this\n    chapter, we've picked the\n    <a href=\"http://mjambon.com/yojson.html\" target=\"_top\"><code>Yojson</code></a>\n    library. The easiest way to install it is by using the OPAM package\n    manager (see <a href=\"\">???</a>\n    for installation instructions). Once OPAM is working, you will need\n    to run <code>opam install yojson</code>.\n  </blockquote>")))
 (idp8653376
  ((file handling-json-data.html)
   (html
    "<blockquote>\n    Our first task is to parse the JSON into a more structured OCaml\n    type so that we can use static typing more effectively. When\n    manipulating JSON in Python or Ruby, you might write unit tests to\n    check that you have handled unusual inputs. The OCaml model prefers\n    compile-time static checking as well as unit tests. For example,\n    using pattern matching can warn you if you've not checked that a\n    value can be <code>Null</code> as well as contain an actual\n    value.\n  </blockquote>")))
 (idp8651392
  ((file handling-json-data.html)
   (html
    "<blockquote>\n    This free-form nature of JSON types is both a blessing and a curse.\n    It's very easy to generate JSON values, but code parsing them also\n    has to cope with handling subtle variations in how values are\n    represented. For example, what if the <code>pages</code> value\n    above is actually represented as a string value of\n    <code>&quot;450&quot;</code> instead of an integer?\n  </blockquote>")))
 (idp8649408
  ((file handling-json-data.html)
   (html
    "<blockquote>\n    JSON values usually start with an object at the top level that\n    contains a set of key/value pairs. The keys must be strings, but\n    values can be any JSON type. In the example above,\n    <code>tags</code> is a string list, while the\n    <code>authors</code> field contains a list of records. Unlike\n    OCaml lists, JSON lists can contain completely different JSON types\n    within them.\n  </blockquote>")))
 (idp8647488
  ((file handling-json-data.html)
   (html
    "<blockquote>\n    JSON consists of just two basic structures: an unordered collection\n    of key/value pairs, and an ordered list of values. Values can be\n    strings, booleans, floats, integers or null. Let's see what an\n    example JSON record for a book description looks like:\n  </blockquote>")))
 (idp8646032
  ((file handling-json-data.html)
   (html
    "<blockquote>\n    JSON is a lightweight data-interchange format often used in web\n    services and browsers. It is described in\n    <a href=\"http://www.ietf.org/rfc/rfc4627.txt\" target=\"_top\">RFC4627</a>,\n    and is designed to be easy to parse and generate. You'll run into\n    JSON very often when working with modern APIs, and so we'll cover\n    several different ways to manipulate it in this chapter. Along the\n    way we'll introduce new libraries and syntax extensions which make\n    the job easier.\n  </blockquote>")))
 (idp8645344
  ((file handling-json-data.html)
   (html
    "<blockquote>\n    We'll start off by looking at JSON and XML first, as they are very\n    common third-party data formats. After that, we'll introduce some\n    syntax extensions in Core that make it really easy to manipulate\n    s-expressions and safe binary serialisers directly from OCaml types.\n  </blockquote>")))
 (idp8644160
  ((file handling-json-data.html)
   (html
    "<blockquote>\n    Data serialization, <span><em>i.e.</em></span> reading and writing\n    program data to a sequence of bytes, is an important and common\n    programming task. Sometimes you need to match someone else's data\n    format (such as XML), and other times you just want to quickly dump\n    some values to disk and read them back later. To this end, OCaml\n    comes with several techniques for data serialization depending on\n    what your problem is.\n  </blockquote>")))
 (idp7921696
  ((file functors.html)
   (html
    "<blockquote>\n          Support for so-called monadic libraries, like the ones\n          discussed in <a href=\"error-handling.html\">Chapter\194\1605, <i>Error Handling</i></a> and\n          <a href=\"\">???</a>.\n          Here, the functor is used to provide a collection of standard\n          helper functions based on the core <code>bind</code> and\n          <code>return</code> operators.\n        </blockquote>")))
 (idp7920816
  ((file functors.html)
   (html
    "<blockquote>\n          Adding hash-based datastructures like hash sets and hash\n          heaps.\n        </blockquote>")))
 (idp7919312
  ((file functors.html)
   (html
    "<blockquote>\n          Adding comparison-based datastructures like maps and sets,\n          based on the <code>Comparable</code> interface.\n        </blockquote>")))
 (idp7918304
  ((file functors.html)
   (html
    "<blockquote>\n      This pattern comes up quite a bit in Core, and is used to for a\n      variety of purposes.\n    </blockquote>")))
 (idp7913216
  ((file functors.html)
   (html
    "<blockquote>\n      In order to apply the functor, we'll put the definition of\n      <code>Fqueue</code> in a sub-module called\n      <code>T</code>, and then call\n      <code>Foldable.Extend</code> on <code>T</code>.\n    </blockquote>")))
 (idp7910336
  ((file functors.html)
   (html
    "<blockquote>\n      Now we can apply this to <code>Fqueue</code>. We can rewrite\n      the interface of <code>Fqueue</code> as follows.\n    </blockquote>")))
 (idp7904224
  ((file functors.html)
   (html
    "<blockquote>\n      We'll create a new module, <code>Foldable</code> that\n      automates the process of adding helper functions to a\n      fold-supporting container. As you can see,\n      <code>Foldable</code> contains a module signature\n      <code>S</code> which defines the signature that is required\n      to support folding; and a functor <code>Extend</code> that\n      allows one to extend any module that matches\n      <code>Foldable.S</code>.\n    </blockquote>")))
 (idp7902848
  ((file functors.html)
   (html
    "<blockquote>\n      As it happens, many of these helper functions can be derived\n      mechanically from just the fold function we already implemented.\n      Rather than write all of these helper functions by hand for every\n      new container type, we can instead use a functor that will let us\n      add this functionality to any container that has a\n      <code>fold</code> function.\n    </blockquote>")))
 (idp7900128
  ((file functors.html)
   (html
    "<blockquote>\n      One problem with our <code>Fqueue</code> is that the\n      interface is quite skeletal. There are lots of useful helper\n      functions that one might want that aren't there. For example, for\n      lists we have <code>List.iter</code> which runs a function\n      on each node; and a <code>List.find</code> that finds the\n      first element on the list that matches a given predicate. Such\n      helper functions come up for pretty much every container type, and\n      implementing them over and over is a bit of a dull and repetitive\n      affair.\n    </blockquote>")))
 (idp7895552
  ((file functors.html)
   (html
    "<blockquote>\n      Now let's implement <code>Fqueue</code>. A standard trick is\n      for the <code>Fqueue</code> to maintain an input and an\n      output list, so that one can efficiently\n      <code>enqueue</code> on the first list, and can efficiently\n      dequeue from the out list. If you attempt to dequeue when the\n      output list is empty, the input list is reversed and becomes the\n      new output list. Here's an implementation that uses that trick.\n    </blockquote>")))
 (idp7893824
  ((file functors.html)
   (html "<blockquote>\n      Here's a reasonable mli\n    </blockquote>")))
 (idp7893008
  ((file functors.html)
   (html
    "<blockquote>\n      Another common use of functors is to generate type-specific\n      functionality for a given module in a standardized way. Let's see\n      how this works in the context of a functional queue, which is just\n      a functional version of a FIFO (first-in, first-out) queue. Being\n      functional, operations on the queue return new queues, rather than\n      modifying the queues that were passed in.\n    </blockquote>")))
 (idp7890304
  ((file functors.html)
   (html
    "<blockquote>\n        And now, we can use that sexp-converter in the ordinary way:\n      </blockquote>")))
 (idp7887440
  ((file functors.html)
   (html
    "<blockquote>\n        Also note that we have been careful to override the\n        sexp-converter here to ensure that the datastructures invariants\n        are still maintained when reading in from an s-expression.\n      </blockquote>")))
 (idp7884880
  ((file functors.html)
   (html
    "<blockquote>\n        We can modify <code>Make_interval</code> to use the\n        <code>Sexpable</code> interface, for both its input and\n        its output. Note the use of destructive substitution to combine\n        multiple signatures together. This is important because it stops\n        the <code>type t</code>'s from the different signatures\n        from interfering with each other.\n      </blockquote>")))
 (idp7882752
  ((file functors.html)
   (html
    "<blockquote>\n        Happily, Core comes with a built in interface for just this\n        purpose called <code>Sexpable</code>, which is defined as\n        follows:\n      </blockquote>")))
 (idp7878960
  ((file functors.html)
   (html
    "<blockquote>\n        The problem is that <code>with sexp</code> adds code for\n        defining the s-expression converters, and that code assumes that\n        <code>Endpoint</code> has the appropriate sexp-conversion\n        functions for <code>Endpoint.t</code>. But all we know\n        about <code>Endpoint</code> is that it satisfies the\n        <code>Comparable</code> interface, which doesn't say\n        anything about s-expressions.\n      </blockquote>")))
 (idp7875232
  ((file functors.html)
   (html
    "<blockquote>\n        Another feature that we might want for our interval module is\n        the ability to serialize the type, in particular, by converting\n        to s-expressions. If we simply invoke the\n        <code>sexplib</code> macros by adding\n        <code>with sexp</code> to the definition of\n        <code>t</code>, though, we'll get an error:\n      </blockquote>")))
 (idp7870576
  ((file functors.html)
   (html
    "<blockquote>\n        The interface is precisely what we want, and we didn't need to\n        define the <code>endpoint</code> type alias in the body of\n        the module. If we instantiate this module, we'll see that it\n        works properly: we can construct new intervals, but\n        <code>t</code> is abstract, and so we can't directly\n        access the constructors and violate the invariants of the data\n        structure.\n      </blockquote>")))
 (idp7867344
  ((file functors.html)
   (html
    "<blockquote>\n        There's now no mention of n <code>endpoint</code>, all\n        occurrences of that type having been replaced by\n        <code>int</code>. As with sharing constraints, we can also\n        use this in the context of a functor.\n      </blockquote>")))
 (idp7865040
  ((file functors.html)
   (html
    "<blockquote>\n        Here's an example of what we get if we use destructive\n        substitution to specialize the <code>Interval_intf</code>\n        interface to integer intervals.\n      </blockquote>")))
 (idp7863952
  ((file functors.html)
   (html
    "<blockquote>\n        The following shows how we could use this with\n        <code>Make_interval</code>.\n      </blockquote>")))
 (idp7858704
  ((file functors.html)
   (html
    "<blockquote>\n        Sharing constraints basically do the job, but they have some\n        downsides. In particular, we've now been stuck with the useless\n        type declaration of <code>endpoint</code> that clutters up\n        both the interface and the implementation. A better solution\n        would be to modify the <code>Interval_intf</code>\n        signature by replacing <code>endpoint</code> with\n        <code>Endpoint.t</code> everywhere it shows up, and\n        deleting the definition of <code>endpoint</code> from the\n        signature. We can do just this using what's called\n        <span><em>destructive substitution</em></span>. Here's the basic\n        syntax.\n      </blockquote>")))
 (idp7854848
  ((file functors.html)
   (html
    "<blockquote>\n        So now, the interface is as it was, except that\n        <code>endpoint</code> is now known to be equal to\n        <code>Endpoint.t</code>. As a result of that type\n        equality, we can now do things like construct intervals again.\n      </blockquote>")))
 (idp7851440
  ((file functors.html)
   (html
    "<blockquote>\n        And we can also use it in the context of a functor, where the\n        right-hand side of the sharing constraint is an element of the\n        functor argument. Thus, we expose an equality between a type in\n        the output of the functor (in this case, the type\n        <code>endpoint</code>) and a type in its input\n        (<code>Endpoint.t</code>).\n      </blockquote>")))
 (idp7844592
  ((file functors.html)
   (html
    "<blockquote>\n        where <code>S</code> is a module type,\n        <code>s</code> is a type inside of <code>S</code>,\n        and <code>t</code> is a type defined outside of\n        <code>S</code>. The result of this expression is a new\n        signature that's been modified so that it exposes the fact that\n        <code>s</code> is equal to <code>t</code>. We can\n        use a sharing constraint to create a specialized version of\n        <code>Interval_intf</code> for integer intervals.\n      </blockquote>")))
 (idp7840064
  ((file functors.html)
   (html
    "<blockquote>\n        To fix this, we need to expose the fact that\n        <code>endpoint</code> is equal to <code>Int.t</code>\n        (or more generally, <code>Endpoint.t</code>, where\n        <code>Endpoint</code> is the argument to the functor). One\n        way of doing this is through a <span><em>sharing\n        constraint</em></span>, which allows you to tell the compiler to\n        expose the fact that a given type is equal to some other type.\n        The syntax for a sharing constraint on a module type is as\n        follows.\n      </blockquote>")))
 (idp7837600
  ((file functors.html)
   (html
    "<blockquote>\n        The resulting module is abstract, but unfortunately, it's too\n        abstract. In particular, we haven't exposed the type\n        <code>endpoint</code>, which means that we can't even\n        construct an interval anymore.\n      </blockquote>")))
 (idp7832080
  ((file functors.html)
   (html
    "<blockquote>\n        This interface includes the type <code>endpoint</code> to\n        represent the type of the endpoints of the interval. Given this\n        interface, we can redo our definition of\n        <code>Make_interval</code>. Notice that we added the type\n        <code>endpoint</code> to the implementation of the module\n        to make the implementation match\n        <code>Interval_intf</code>.\n      </blockquote>")))
 (idp7828960
  ((file functors.html)
   (html
    "<blockquote>\n        To make <code>Int_interval.t</code> abstract, we need to\n        apply an interface to the output of the\n        <code>Make_interval</code>. Here's an explicit interface\n        that we can use for that purpose.\n      </blockquote>")))
 (idp7825360
  ((file functors.html)
   (html
    "<blockquote>\n        There's a problem with <code>Make_interval</code>. The\n        code we wrote depends on the invariant that the upper bound of\n        an interval is greater than its lower bound, but that invariant\n        can be violated. The invariant is enforced by the create\n        function, but because <code>Interval.t</code> is not\n        abstract, we can bypass the <code>create</code> function.\n      </blockquote>")))
 (idp7823856
  ((file functors.html)
   (html
    "<blockquote>\n      This is important, because confusing the two kinds of intervals\n      would be a semantic error, and it's an easy one to make. The\n      ability of functors to mint new types is a useful trick that comes\n      up a lot.\n    </blockquote>")))
 (idp7820912
  ((file functors.html)
   (html
    "<blockquote>\n      Importantly, <code>Rev_int_interval.t</code> is a different\n      type than <code>Int_interval.t</code>, even though its\n      physical representation is the same. Indeed, the type system will\n      prevent us from confusing them.\n    </blockquote>")))
 (idp7818176
  ((file functors.html)
   (html
    "<blockquote>\n      The behavior of <code>Rev_int_interval</code> is of course\n      different from <code>Int_interval</code>, as we can see\n      below.\n    </blockquote>")))
 (idp7816528
  ((file functors.html)
   (html
    "<blockquote>\n      This design gives us the freedom to use any comparison function we\n      want for comparing the endpoints. We could, for example, create a\n      type of int interval with the order of the comparison reversed, as\n      follows:\n    </blockquote>")))
 (idp7814368
  ((file functors.html)
   (html
    "<blockquote>\n      Now we can use the newly defined <code>Int_interval</code>\n      module like any ordinary module.\n    </blockquote>")))
 (idp7811792
  ((file functors.html)
   (html
    "<blockquote>\n      This works because many modules in Core, including\n      <code>Int</code> and <code>String</code>, satisfy an\n      extended version of the <code>Comparable</code> signature\n      described above. Standardized signatures are generally good\n      practice, both because they makes functors easier to use, and\n      because they make the codebase generally easier to navigate.\n    </blockquote>")))
 (idp7808944
  ((file functors.html)
   (html
    "<blockquote>\n      When we choose our interfaces that are aligned with the standards\n      of our libraries, we don't need to construct a custom module to\n      feed to the functor. In this case, for example, we can directly\n      use the <code>Int</code> or <code>String</code>\n      modules provided by Core.\n    </blockquote>")))
 (idp7807072
  ((file functors.html)
   (html
    "<blockquote>\n      We can instantiate the functor by applying it to a module with the\n      right signature. In the following, we provide the functor input as\n      an anonymous module.\n    </blockquote>")))
 (idp7801264
  ((file functors.html)
   (html
    "<blockquote>\n      The functor for creating the interval module is shown below. We\n      represent an interval with a variant type, which is either\n      <code>Empty</code> or <code>Interval (x,y)</code>,\n      where <code>x</code> and <code>y</code> are the bounds\n      of the interval.\n    </blockquote>")))
 (idp7798208
  ((file functors.html)
   (html
    "<blockquote>\n      The comparison function follows the standard OCaml idiom for such\n      functions, returning <code>0</code> if the two elements are\n      equal, a positive number if the first element is larger than the\n      second, and a negative number if the first element is smaller than\n      the second. Thus, we could rewrite the standard comparison\n      functions on top of <code>compare</code> as shown below.\n    </blockquote>")))
 (idp7795632
  ((file functors.html)
   (html
    "<blockquote>\n      First we'll define a module type that captures the information\n      we'll need about the endpoint type. This interface, which we'll\n      call <code>Comparable</code>, contains just two things: a\n      comparison function, and the type of the values to be compared.\n    </blockquote>")))
 (idp7794976
  ((file functors.html)
   (html
    "<blockquote>\n      Let's now consider a more realistic example of how to use\n      functors: a library for computing with intervals. This library\n      will be functorized over the type of the endpoints of the\n      intervals and the ordering of those endpoints.\n    </blockquote>")))
 (idp7788208
  ((file functors.html)
   (html
    "<blockquote>\n      In this case, we applied <code>Increment</code> to a module\n      whose signature is exactly equal to <code>X_int</code>. But\n      we can apply <code>Increment</code> to any module that\n      satisfies the interface <code>X_int</code>, in the same way\n      that a the contents of an <code>ml</code> file can satisfy\n      the <code>mli</code>. That means that the module type can\n      omit some information available in the module, either by dropping\n      fields or by leaving some fields abstract. Here's an example:\n    </blockquote>")))
 (idp7786144
  ((file functors.html)
   (html
    "<blockquote>\n      We can now use <code>Increment</code> to define new modules.\n    </blockquote>")))
 (idp7784960
  ((file functors.html)
   (html
    "<blockquote>\n      We can see that the inferred module type of the output is now\n      written out explicitly, rather than being a reference to the named\n      signature <code>X_int</code>.\n    </blockquote>")))
 (idp7783344
  ((file functors.html)
   (html
    "<blockquote>\n      The following shows what happens when we omit the module type for\n      the output of the functor.\n    </blockquote>")))
 (idp7781824
  ((file functors.html)
   (html
    "<blockquote>\n      One thing that immediately jumps out about functors is that\n      they're considerably more heavyweight syntactically than ordinary\n      functions. For one thing, functors require explicit (module) type\n      annotations, which ordinary functions do not. Here, we've\n      specified the module type <code>X_int</code> for both the\n      input and output of the functor. Technically, only the type on the\n      input is mandatory, although in practice, one often specifies\n      both.\n    </blockquote>")))
 (idp7778784
  ((file functors.html)
   (html
    "<blockquote>\n      More precisely, we'll create a functor that takes a module\n      containing a single integer variable <code>x</code>, and\n      returns a new module with <code>x</code> incremented by one.\n    </blockquote>")))
 (idp7778272
  ((file functors.html)
   (html
    "<blockquote>\n      We'll start by considering the simplest possible example: a\n      functor for incrementing an integer.\n    </blockquote>")))
 (idp7776048
  ((file functors.html)
   (html
    "<blockquote>\n<span><em>Instantiating modules with state</em></span>. Modules\n        can contain mutable state, and that means that you'll\n        occasionally want to have multiple instantiations of a\n        particular module, each with its own separate and independent\n        mutable state. Functors let you automate the construction of\n        such modules.\n      </blockquote>")))
 (idp7774384
  ((file functors.html)
   (html
    "<blockquote>\n<span><em>Auto-extension of modules</em></span>. Sometimes, there\n        is some functionality that you want to build in a standard way\n        for different types, in each case based on a some piece of\n        type-specific logic. For example, you might want to add a slew\n        of comparison operators derived from a base comparison function.\n        To do this by hand would require a lot of repetitive code for\n        each type, but functors let you write this logic just once and\n        apply it to many different types.\n      </blockquote>")))
 (idp7773008
  ((file functors.html)
   (html
    "<blockquote>\n<span><em>Dependency injection</em></span>, or making the\n        implementations of some components of a system swappable. This\n        is particularly useful when you want to mock up parts of your\n        system for testing and simulation purposes.\n      </blockquote>")))
 (idp7771936
  ((file functors.html)
   (html
    "<blockquote>\n    Functors are, roughly speaking, functions from modules to modules,\n    and they can be used to solve a variety of code-structuring\n    problems, including:\n  </blockquote>")))
 (idp7771152
  ((file functors.html)
   (html
    "<blockquote>\n    Up until now, we've seen OCaml's module system play an important but\n    limited role. In particular, we've seen them as a mechanism for\n    organizing code into units with specified interfaces. But modules\n    can do much more than that, acting as a powerful toolset for\n    building generic code and structuring large-scale systems. Much of\n    that power comes from functors.\n  </blockquote>")))
 (idp7768496
  ((file error-handling.html)
   (html
    "<blockquote>\n        And then we can re-raise that exception:\n      </blockquote>")))
 (idp7764800
  ((file error-handling.html)
   (html
    "<blockquote>\n        And <code>Result</code> and <code>Or_error</code>\n        have similar <code>try_with</code> functions. So, we could\n        write:\n      </blockquote>")))
 (idp7762672
  ((file error-handling.html)
   (html
    "<blockquote>\n        Both exceptions and error-aware types are necessary parts of\n        programming in OCaml. As such, you often need to move between\n        these two worlds. Happily, Core comes with some useful helper\n        functions to help you do just that. For example, given a piece\n        of code that can throw an exception, you can capture that\n        exception into an option as follows:\n      </blockquote>")))
 (idp7761280
  ((file error-handling.html) (html "<blockquote>\n</blockquote>")))
 (idp7759072
  ((file error-handling.html)
   (html
    "<blockquote>\n        Backtraces can also be obtained at runtime. In particular,\n        <code>Exn.backtrace</code> will return the backtrace of\n        the most recently thrown exception.\n      </blockquote>")))
 (idp7756848
  ((file error-handling.html)
   (html
    "<blockquote>\n        We can get more information from OCaml if we turn on stack\n        traces. This can be done by setting the\n        <code>OCAMLRUNPARAM</code> environment variable, as shown:\n      </blockquote>")))
 (idp7756176
  ((file error-handling.html)
   (html
    "<blockquote>\n        The example in question is short enough that it's quite easy to\n        see where the error came from. But in a complex program, simply\n        knowing which exception was thrown is usually not enough\n        information to figure out what went wrong.\n      </blockquote>")))
 (idp7754816
  ((file error-handling.html)
   (html
    "<blockquote>\n        If we build and run this program, we'll get a pretty\n        uninformative error:\n      </blockquote>")))
 (idp7752864
  ((file error-handling.html)
   (html
    "<blockquote>\n        A big part of the point of exceptions is to give useful\n        debugging information. But at first glance, OCaml's exceptions\n        can be less than informative. Consider the following simple\n        program.\n      </blockquote>")))
 (idp7750736
  ((file error-handling.html)
   (html
    "<blockquote>\n        At which point, it makes sense to simply use the non-exception\n        throwing function, <code>List.Assoc.find</code>, instead.\n      </blockquote>")))
 (idp7748816
  ((file error-handling.html)
   (html
    "<blockquote>\n        This kind of problem is hard to detect in advance, because the\n        type system doesn't tell us what kinds of exceptions a given\n        function might throw. Because of this kind of confusion, it's\n        usually better to avoid catching specific exceptions. In this\n        case, we can improve the code by catching the exception in a\n        narrower scope.\n      </blockquote>")))
 (idp7745248
  ((file error-handling.html)
   (html
    "<blockquote>\n        This implementation is more problematic than it looks. In\n        particular, what happens if <code>compute_weight</code>\n        itself throws an exception? Ideally,\n        <code>lookup_weight</code> should propagate that exception\n        on, but if the exception happens to be\n        <code>Not_found</code>, then that's not what will happen:\n      </blockquote>")))
 (idp7743568
  ((file error-handling.html)
   (html
    "<blockquote>\n        We can implement such a function using exceptions as follows:\n      </blockquote>")))
 (idp7739616
  ((file error-handling.html)
   (html
    "<blockquote>\n        OCaml's exception-handling system allows you to tune your\n        error-recovery logic to the particular error that was thrown.\n        For example, <code>List.find_exn</code> always throws\n        <code>Not_found</code>. You can take advantage of this in\n        your code, for example, let's define a function called\n        <code>lookup_weight</code>, with the following signature:\n      </blockquote>")))
 (idp7733904
  ((file error-handling.html)
   (html
    "<blockquote>\n        We can fix this using Core's <code>protect</code>\n        function. The basic purpose of <code>protect</code> is to\n        ensure that the <code>finally</code> thunk will be called\n        when <code>f</code> exits, whether it exited normally or\n        with an exception. Here's how it could be used to fix\n        <code>load_config</code>.\n      </blockquote>")))
 (idp7731888
  ((file error-handling.html)
   (html
    "<blockquote>\n        The problem with this code is that the function that loads the\n        s-expression and parses it into a <code>Config.t</code>\n        might throw an exception if the config file in question is\n        malformed. Unfortunately, that means that the\n        <code>In_channel.t</code> that was opened will never be\n        closed, leading to a file-descriptor leak.\n      </blockquote>")))
 (idp7730240
  ((file error-handling.html)
   (html
    "<blockquote>\n        One headache with exceptions is that they can terminate your\n        execution at unexpected places, leaving your program in an\n        awkward state. Consider the following code snippet:\n      </blockquote>")))
 (idp7727120
  ((file error-handling.html)
   (html
    "<blockquote>\n        But if evaluating <code>&lt;expr&gt;</code> leads to an\n        exception being thrown, then the exception will be fed to the\n        pattern match statements following the <code>with</code>.\n        If the exception matches a pattern, then the expression on the\n        right hand side of that pattern will be evaluated. Otherwise,\n        the original exception continues up the call stack, to be\n        handled by the next outer exception handler, or terminate the\n        program if there is none.\n      </blockquote>")))
 (idp7724080
  ((file error-handling.html)
   (html
    "<blockquote>\n        A <code>try</code>/<code>with</code> clause would\n        first evaluate <code>&lt;expr&gt;</code>, and if that\n        evaluation completes without returning an exception, then the\n        value of the overall expression is the value of\n        <code>&lt;expr&gt;</code>.\n      </blockquote>")))
 (idp7721392
  ((file error-handling.html)
   (html
    "<blockquote>\n        In OCaml, an exception handler is declared using a\n        <code>try</code>/<code>with</code> statement. Here's\n        the basic syntax.\n      </blockquote>")))
 (idp7720368
  ((file error-handling.html)
   (html
    "<blockquote>\n        So far, we've only seen exceptions fully terminate the execution\n        of a computation. But often, we want a program to be able to\n        respond to and recover from an exception. This is achieved\n        through the use of <span><em>exception handlers</em></span>.\n      </blockquote>")))
 (idp7717344
  ((file error-handling.html)
   (html
    "<blockquote>\n      The period in front of <code>Wrong_date</code> is there\n      because the representation generated by\n      <code>with sexp</code> includes the full module path of the\n      module where the exception in question is defined. This is quite\n      useful in tracking down which precise exception is being reported.\n      In this case, since we've declared the exception at the toplevel,\n      that module path is trivial.\n    </blockquote>")))
 (idp7715088
  ((file error-handling.html)
   (html
    "<blockquote>\n      But if you declare the exception using\n      <code>with sexp</code> (and the constituent types have sexp\n      converters), we'll get something with more information.\n    </blockquote>")))
 (idp7713504
  ((file error-handling.html)
   (html
    "<blockquote>\n      OCaml can't always generate a useful textual representation of\n      your exception, for example:\n    </blockquote>")))
 (idp7710976
  ((file error-handling.html)
   (html
    "<blockquote>\n      This all matters because it means that the return type of\n      <code>raise</code> can be whatever it needs to be to fit in\n      to the context it is called in. Thus, the type system will let us\n      throw an exception anywhere in a program.\n    </blockquote>")))
 (idp7709872
  ((file error-handling.html)
   (html
    "<blockquote>\n<code>forever</code> doesn't return a value for a different\n      reason: it is an infinite loop.\n    </blockquote>")))
 (idp7705552
  ((file error-handling.html)
   (html
    "<blockquote>\n      Having the return type be an otherwise unused type variable\n      <code>'a</code> suggests that <code>raise</code> could\n      return a value of any type. That seems impossible, and it is.\n      <code>raise</code> has this type because it never returns at\n      all. This behavior isn't restricted to functions like\n      <code>raise</code> that terminate by throwing exceptions.\n      Here's another example of a function that doesn't return a value.\n    </blockquote>")))
 (idp7703536
  ((file error-handling.html)
   (html
    "<blockquote>\n      In the above example, <code>raise</code> throws the\n      exception, thus terminating the computation. The type of raise is\n      a bit surprising when you first see it:\n    </blockquote>")))
 (idp7702384
  ((file error-handling.html)
   (html
    "<blockquote>\n      Note that we named the function <code>find_exn</code> to\n      warn the user that the function routinely throws exceptions, a\n      convention that is used heavily in Core.\n    </blockquote>")))
 (idp7699744
  ((file error-handling.html)
   (html
    "<blockquote>\n      Here's an example of a function for looking up a key in an\n      <span><em>association list</em></span>, <span><em>i.e.</em></span> a\n      list of key/value pairs which uses this newly-defined exception:\n    </blockquote>")))
 (idp7697680
  ((file error-handling.html)
   (html
    "<blockquote>\n      In addition to built-in exceptions like\n      <code>Divide_by_zero</code>, OCaml lets you define your own.\n    </blockquote>")))
 (idp7696064
  ((file error-handling.html)
   (html
    "<blockquote>\n      And an exception can terminate a computation even if it happens\n      nested a few levels deep in a computation.\n    </blockquote>")))
 (idp7694688
  ((file error-handling.html)
   (html
    "<blockquote>\n      We'll see an exception triggered in OCaml if, for example, we try\n      to divide an integer by zero:\n    </blockquote>")))
 (idp7693920
  ((file error-handling.html)
   (html
    "<blockquote>\n      Exceptions in OCaml are not that different from exceptions in many\n      other languages, like Java, C# and Python. In all these cases,\n      exceptions are a way to terminate a computation and report an\n      error, while providing a mechanism to catch and handle (and\n      possibly recover from) exceptions that are triggered by\n      sub-computations.\n    </blockquote>")))
 (idp7690208
  ((file error-handling.html)
   (html
    "<blockquote>\n        These error-handling functions are valuable because they let you\n        express your error handling both explicitly and concisely. We've\n        only discussed these functions in the context of the\n        <code>Option</code> module, but similar functionality is\n        available in both <code>Result</code> and\n        <code>Or_error</code>.\n      </blockquote>")))
 (idp7684880
  ((file error-handling.html)
   (html
    "<blockquote>\n        There are other useful idioms encoded in the functions in\n        <code>Option</code>. Another example is\n        <code>Option.both</code>, which takes two optional values\n        and produces a new optional pair that is <code>None</code>\n        if either of its arguments are <code>None</code>. Using\n        <code>Option.both</code>, we can make\n        <code>compute_bounds</code> even shorter.\n      </blockquote>")))
 (idp7683216
  ((file error-handling.html)
   (html
    "<blockquote>\n        This is a bit easier to read if we write it with fewer\n        parentheses and less indentation, as follows.\n      </blockquote>")))
 (idp7679760
  ((file error-handling.html)
   (html
    "<blockquote>\n        Note that we locally open the\n        <code>Option.Monad_infix</code> module to get access to\n        the infix operator <code>&gt;&gt;=</code>. The module is\n        called <code>Monad_infix</code> because the bind operator\n        is part of a sub-interface called <code>Monad</code>,\n        which we'll talk about more in\n        <a href=\"\">???</a>.\n      </blockquote>")))
 (idp7673520
  ((file error-handling.html)
   (html
    "<blockquote>\n<code>bind</code> is a way of sequencing together\n        error-producing functions so that that the first one to produce\n        an error terminates the computation. In particular,\n        <code>None &gt;&gt;= f</code> returns\n        <code>None</code> without calling <code>f</code>,\n        and <code>Some x &gt;&gt;= f</code> returns\n        <code>f x</code>. We can use a nested sequence of these\n        binds to express a multi-stage computation that can fail at any\n        stage. Here's a rewrite <code>compute_bounds</code> in\n        this style.\n      </blockquote>")))
 (idp7669296
  ((file error-handling.html)
   (html
    "<blockquote>\n        As you write more error handling code, you'll discover that\n        certain patterns start to emerge. A number of these common\n        patterns been codified in the interfaces of modules like\n        <code>Option</code> and <code>Result</code>. One\n        particularly useful one is built around the function\n        <code>bind</code>, which is both an ordinary function and\n        an infix operator <code>&gt;&gt;=</code>, both with the\n        same type signature:\n      </blockquote>")))
 (idp7665456
  ((file error-handling.html)
   (html
    "<blockquote>\n        The type <code>'a Or_error.t</code> is just a shorthand\n        for <code>('a,Error.t) Result.t</code>, and it is, after\n        <code>option</code>, the most common way of returning\n        errors in Core.\n      </blockquote>")))
 (idp7663568
  ((file error-handling.html)
   (html
    "<blockquote>\n        Error also has operations for transforming errors. For example,\n        it's often useful to augment an error with some extra\n        information about the context of the error, or to combine\n        multiplier errors together. <code>Error.of_list</code> and\n        <code>Error.tag</code> fill these roles.\n      </blockquote>")))
 (idp7662352
  ((file error-handling.html)
   (html
    "<blockquote>\n        Here, the declaration\n        <code>&lt;:sexp_of&lt;float * string list * int&gt;&gt;</code>\n        asks Sexplib to generate the sexp-converter for the tuple.\n      </blockquote>")))
 (idp7657856
  ((file error-handling.html)
   (html
    "<blockquote>\n        Here, the value <code>Time.epoch</code> is included in the\n        error, but <code>Time.sexp_of_t</code>, which is used for\n        converting the time to an s-expression, isn't run until the\n        error is converted to a string. Using the Sexplib\n        syntax-extension, which is discussed in more detail in chapter\n        <a href=\"data-serialization-with-json-xml-and-s-expressions\" target=\"_top\">xref</a>,\n        we can inline create an s-expression converter for a collection\n        of types, thus allowing us to register multiple pieces of data\n        in an <code>Error.t</code>.\n      </blockquote>")))
 (idp7655440
  ((file error-handling.html)
   (html
    "<blockquote>\n        We can also create an <code>Error.t</code> based on an\n        s-expression converter. This is probably the most common idiom\n        in Core.\n      </blockquote>")))
 (idp7653728
  ((file error-handling.html)
   (html
    "<blockquote>\n        In this case, we can benefit from the laziness of\n        <code>Error</code>, since the thunk won't be called until\n        the <code>Error.t</code> is converted to a string.\n      </blockquote>")))
 (idp7651552
  ((file error-handling.html)
   (html
    "<blockquote>\n        A more interesting construction message from a performance point\n        of view is to construct an <code>Error.t</code> from a\n        thunk:\n      </blockquote>")))
 (idp7648560
  ((file error-handling.html)
   (html
    "<blockquote>\n<code>Error</code> gets around this issue through\n        laziness. In particular, an <code>Error.t</code> allows\n        you to put off generation of the actual error string until you\n        actually need, which means a lot of the time you never have to\n        construct it at all. You can of course construct an error\n        directly from a string:\n      </blockquote>")))
 (idp7647840
  ((file error-handling.html)
   (html
    "<blockquote>\n        It might not be obvious at first why efficiency is an issue at\n        all. But generating error messages is an expensive business. An\n        ASCII representation of a type can be quite time-consuming to\n        construct, particularly if it includes expensive-to-convert\n        numerical datatypes.\n      </blockquote>")))
 (idp7646672
  ((file error-handling.html)
   (html
    "<blockquote>\n        Core's answer to this question is the <code>Error.t</code>\n        type, which tries to forge a good compromise between efficiency,\n        convenience and control over the presentation of errors.\n      </blockquote>")))
 (idp7646128
  ((file error-handling.html)
   (html
    "<blockquote>\n        But which type to choose? Is it better to represent errors as\n        strings? Or S-expressions? Or something else entirely?\n      </blockquote>")))
 (idp7644816
  ((file error-handling.html)
   (html
    "<blockquote>\n<code>Result.t</code> gives you complete freedom to choose\n        the type of value you use to represent errors, but it's often\n        useful to standardize on an error type. Among other things, this\n        makes it easier to write utility functions to automate common\n        error handling patterns.\n      </blockquote>")))
 (idp7641808
  ((file error-handling.html)
   (html
    "<blockquote>\n        without first opening the <code>Result</code> module.\n      </blockquote>")))
 (idp7636304
  ((file error-handling.html)
   (html
    "<blockquote>\n        A <code>Result.t</code> is essentially an option augmented\n        with the ability to store other information in the error case.\n        Like <code>Some</code> and <code>None</code> for\n        options, the constructors <code>Ok</code> and\n        <code>Error</code> are promoted to the top-level by\n        <code>Core.Std</code>. As such, we can write:\n      </blockquote>")))
 (idp7634224
  ((file error-handling.html)
   (html
    "<blockquote>\n<code>Result.t</code> is meant to address this deficiency.\n        Here's the definition:\n      </blockquote>")))
 (idp7632960
  ((file error-handling.html)
   (html
    "<blockquote>\n        Options aren't always a sufficiently expressive way to report\n        errors. Specifically, when you encode an error as\n        <code>None</code>, there's nowhere to say anything about\n        the nature of the error.\n      </blockquote>")))
 (idp7630768
  ((file error-handling.html)
   (html
    "<blockquote>\n      The use of options to encode errors underlines the fact that it's\n      not clear whether a particular outcome, like not finding something\n      on a list, is really an error, or just another valid outcome of\n      your function. This turns out to be very context-dependent, and\n      error-aware return types give you a uniform way of handling the\n      result that works well for both situations.\n    </blockquote>")))
 (idp7625472
  ((file error-handling.html)
   (html
    "<blockquote>\n      The match statement is used to handle the error cases, propagating\n      an error in <code>hd</code> or <code>last</code> into\n      the return value of <code>compute_bounds</code>. On the\n      other hand, in <code>find_mismatches</code> below, errors\n      encountered during the computation do not propagate to the return\n      value of the function. <code>find_mismatches</code> takes\n      two hashtables as its arguments and tries to find keys that are\n      stored in both. As such, a failure to find a key in one of the\n      tables isn't really an error.\n    </blockquote>")))
 (idp7620912
  ((file error-handling.html)
   (html
    "<blockquote>\n      The function <code>compute_bounds</code> below is an example\n      of how you can handle errors in this style. The function takes a\n      list and a comparison function, and returns upper and lower bounds\n      for the list by finding the smallest and largest element on the\n      list. <code>List.hd</code> and <code>List.last</code>,\n      which return <code>None</code> when they encounter an empty\n      list, are used to extract the largest and smallest element of the\n      list.\n    </blockquote>")))
 (idp7620240
  ((file error-handling.html)
   (html
    "<blockquote>\n      Having errors be explicit in the return values of your functions\n      tells the caller that there is an error that needs to be handled.\n      The caller can then handle the error explicitly, either recovering\n      from the error or propagating it onward.\n    </blockquote>")))
 (idp7618560
  ((file error-handling.html)
   (html
    "<blockquote>\n      The option in the return type indicates that the function may not\n      succeed in finding a suitable element, as you can see below.\n    </blockquote>")))
 (idp118208
  ((file error-handling.html)
   (html
    "<blockquote>\n      The best way in OCaml to signal an error is to include that error\n      in your return value. Consider the type of the\n      <code>find</code> function in the list module.\n    </blockquote>")))
 (idp116656
  ((file error-handling.html)
   (html
    "<blockquote>\n    We'll start by describing the two basic approaches for reporting\n    errors in OCaml: error-aware return types and exceptions.\n  </blockquote>")))
 (idp115952
  ((file error-handling.html)
   (html
    "<blockquote>\n    Thankfully, OCaml has powerful tools for handling errors reliably\n    and with a minimum of pain. In this chapter we'll discuss some of\n    the different approaches in OCaml to handling errors, and give some\n    advice on how to design interfaces that help rather than hinder\n    error handling.\n  </blockquote>")))
 (idp115216
  ((file error-handling.html)
   (html
    "<blockquote>\n    Nobody likes dealing with errors. It's tedious, it's easy to get\n    wrong, and it's usually just not as fun as planning out how your\n    program is going to succeed. But error handling is important, and\n    however much you don't like thinking about it, having your software\n    fail due to poor error handling code is worse.\n  </blockquote>")))
 (idp8638240
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n      Similarly, sometimes you simultaneously want an accessor to a\n      field of a record and a textual representation of the name of that\n      field. This might come up if you were validating a field and\n      needed the string representation to generate an error message, or\n      if you wanted to scaffold a form in a GUI automatically based on\n      the fields of a record. Fieldslib provides a module\n      <code>Field</code> for this purpose. Here's some code for\n      creating <code>Field.t</code>'s for all the fields of our\n      type <code>t</code>.\n    </blockquote>")))
 (idp8636672
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n      One common idiom when using records is to provide field accessor\n      functions for a particular record.\n    </blockquote>")))
 (idp8631760
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n      Here's a small complete example of a program that can read and\n      write values using bin-io. Here, the serialization is of types\n      that might be used as part of a message-queue, where each message\n      has a topic, some content, and a source, which is in turn a\n      hostname and a port.\n    </blockquote>")))
 (idp8630320
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n      Bin_prot is a library designed to address these issues by\n      providing fast serialization in a compact binary format. Kicking\n      off the syntax extension is done by putting\n      <code>with bin_io</code>. (This looks a bit unsightly in the\n      top-level because of all the definitions that are generated. We'll\n      elide those definitions here, but you can see it for yourself in\n      the toplevel.)\n    </blockquote>")))
 (idp8626736
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n      S-expressions are a good serialization format when you need\n      something machine-parseable as well as human readable and\n      editable. But Sexplib's s-expressions are not particularly\n      performant. There are a number of reasons for this. For one thing,\n      s-expression serialization goes through an intermediate type,\n      <code>Sexp.t</code>, which must be allocated and is then\n      typically thrown away, putting non-trivial pressure on the GC. In\n      addition, parsing and printing to strings in an ASCII format can\n      be expensive for types like <code>int</code>s,\n      <code>float</code>s and <code>Time.t</code>s where\n      some real computation needs to be done to produce or parse the\n      ASCII representation.\n    </blockquote>")))
 (idp8623120
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n          You might prefer to make the syntax a bit less\n          parenthesis-laden by dropping the parentheses around the list.\n          <code>sexp_list</code> gives us this alternate syntax:\n        </blockquote>")))
 (idp8621344
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n          One problem with the auto-generated sexp-converters is that\n          they can have more parentheses than one would ideally like.\n          Consider, for example, the following variant type:\n        </blockquote>")))
 (idp8617072
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n          But what if we want a field to be optional,\n          <span><em>i.e.</em></span>, we want to allow it to be omitted\n          from the record entirely? In that case, we can mark it with\n          <code>sexp_option</code>:\n        </blockquote>")))
 (idp8611888
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n          Another common directive is <code>sexp_opaque</code>,\n          which is used to make an optional field in a record. Ordinary\n          optional values are represented either as\n          <code>()</code> for <code>None</code>, or as\n          <code>(x)</code> for <code>Some x</code>. If you\n          put an option in a record field, then the record field will\n          always be required, and its value will be presented in the way\n          an ordinary optional value would. For example:\n        </blockquote>")))
 (idp8608352
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n          And if we now convert a value of this type to an s-expression,\n          we'll see the contents of field <code>a</code> marked as\n          opaque:\n        </blockquote>")))
 (idp8606128
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n          But with <code>sexp_opaque</code>, we won't:\n        </blockquote>")))
 (idp8602128
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n          The most commonly used directive is\n          <code>sexp_opaque</code>, whose purpose is to mark a\n          given component of a type as being unconvertible. Anything\n          marked with <code>sexp_opaque</code> will be presented\n          as the atom <code>&lt;opaque&gt;</code> by the to-sexp\n          converter, and will trigger an exception from the from-sexp\n          converter. Note that the type of a component marked as opaque\n          doesn't need to have a sexp-converter defined. Here, if we\n          define a type without a sexp-converter, and then try to use it\n          another type with a sexp-converter, we'll error out:\n        </blockquote>")))
 (idp8600144
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        Sexplib supports a collection of directives for modifying the\n        default behavior of the auto-generated sexp-converters. These\n        directives allow you to customize the way in which types are\n        represented as s-expressions without having to write a custom\n        parser. We describe these directives below.\n      </blockquote>")))
 (idp8598528
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        In the above error, &quot;foo.scm:3:4&quot; tells us that the\n        error occurred on &quot;foo.scm&quot;, line 3, character 4,\n        which is a much better start for figuring out what has gone\n        wrong.\n      </blockquote>")))
 (idp8596864
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        and run it again, we'll get the following much more helpful\n        error message:\n      </blockquote>")))
 (idp8594800
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        But there's hope! If we make small change to the\n        <code>run</code> function as follows:\n      </blockquote>")))
 (idp8594048
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        If all you have is the error message and the string, it's not\n        terribly informative. In particular, you know that the parsing\n        error-ed out on the atom &quot;not-an-integer&quot;, but you\n        don't know which one! In a large file, this kind of bad error\n        message can be pure misery.\n      </blockquote>")))
 (idp8592832
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        you'll get the following error:\n      </blockquote>")))
 (idp8591648
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        If you were to run this on a malformatted file, say, this one:\n      </blockquote>")))
 (idp8589696
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        There are two steps to deserializing a type from an\n        s-expression: first, converting the bytes in a file to an\n        s-expression, and the second, converting that s-expression into\n        the type in question. One problem with this is that it can be\n        hard to localize errors to the right place using this scheme.\n        Consider the following example:\n      </blockquote>")))
 (idp8587392
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        We call the function <code>of_sexp_error</code> to raise\n        an exception because that improves the error reporting that\n        Sexplib can provide when a conversion fails.\n      </blockquote>")))
 (idp8585392
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        We can fix this problem by writing a custom sexp-converter, in\n        this case, using the sexp-converter that we already have:\n      </blockquote>")))
 (idp8580352
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        One easy mistake to make when dealing with sexp converters is to\n        ignore the fact that those converters can violate the invariants\n        of your code. For example, the <code>Int_interval</code>\n        module depends for the correctness of the\n        <code>is_empty</code> check on the fact that for any value\n        <code>Range (x,y)</code>, <code>y</code> is greater\n        than or equal to <code>x</code>. The\n        <code>create</code> function preserves this invariant, but\n        the <code>t_of_sexp</code> function does not.\n      </blockquote>")))
 (idp8577904
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        at which point <code>test_interval.ml</code> will compile\n        again, and if we run it, we'll get the following output:\n      </blockquote>")))
 (idp8576528
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        But Sexplib has a shorthand for this as well, so that we can\n        instead write simply:\n      </blockquote>")))
 (idp8575200
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        We could export the types by hand:\n      </blockquote>")))
 (idp8573840
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        then we'll get the following error:\n      </blockquote>")))
 (idp8570848
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        But we're still missing something: we haven't created an\n        <code>mli</code> for <code>Int_interval</code> yet.\n        Note that we need to explicitly export the s-expression\n        converters that were created within the ml. If we don't:\n      </blockquote>")))
 (idp8569280
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        We can now use this module as follows:\n      </blockquote>")))
 (idp8567072
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        The most important functionality provided by Sexplib is the\n        auto-generation of converters for new types. We've seen a bit of\n        how this works already, but let's walk through a complete\n        example. Here's the source for the beginning of a library for\n        representing integer intervals.\n      </blockquote>")))
 (idp8564960
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        (In the above, we use <code>Exn.handle_uncaught</code> to\n        make sure that the exception gets printed out in full detail.)\n      </blockquote>")))
 (idp8562592
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        If we introduce an error into our s-expression, by, say,\n        deleting the open-paren in front of <code>bar</code>,\n        we'll get a parse error:\n      </blockquote>")))
 (idp8561424
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        Note that the comments were dropped from the file upon reading.\n        This is expected, since there's no place in the\n        <code>Sexp.t</code> type to store comments.\n      </blockquote>")))
 (idp8559936
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        we can load it up and print it back out again:\n      </blockquote>")))
 (idp8558064
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n        Sexplib's format for s-expressions is pretty straightforward: an\n        s-expression is written down as a nested parenthetical\n        expression, with whitespace-separated strings as the atoms.\n        Quotes are used for atoms that contain parenthesis or spaces\n        themselves, backslash is the escape character, and semicolons\n        are used to introduce comments. Thus, if you create the\n        following file:\n      </blockquote>")))
 (idp8555808
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    We'll discuss each of these syntax extensions in detail, starting\n    with Sexplib.\n  </blockquote>")))
 (idp8553968
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n<span><strong>Pa_typehash</strong></span>: generates a hash\n        value for a type definition, <span><em>i.e.</em></span>, an\n        integer that is highly unlikely to be the same for two distinct\n        types.\n      </blockquote>")))
 (idp8552480
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n<span><strong>Pa_compare</strong></span>: generates\n        efficient, type-specialized comparison functions.\n      </blockquote>")))
 (idp8550928
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n<span><strong>Variantslib</strong></span>: like Fieldslib\n        for variants, producing first-class variants and other helper\n        functions for interacting with variant types.\n      </blockquote>")))
 (idp8549360
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n<span><strong>Fieldslib</strong></span>: generates\n        first-class values that represent fields of a record, as well as\n        accessor functions and setters for mutable record fields.\n      </blockquote>")))
 (idp8547888
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n<span><strong>Bin_prot</strong></span>: provides\n        serialization to an efficient binary format.\n      </blockquote>")))
 (idp8546416
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n<span><strong>Sexplib</strong></span>: provides\n        serialization for s-expressions.\n      </blockquote>")))
 (idp8545424
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    There are several syntax extensions distributed with Core,\n    including:\n  </blockquote>")))
 (idp8544752
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    The syntax-extensions in Core that we're going to discuss all have\n    this same basic structure: they auto-generate code based on type\n    definitions, implementing functionality that you could in theory\n    have implemented by hand, but with far less programmer effort.\n  </blockquote>")))
 (idp8543664
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    (You can ignore <code>t_of_sexp__</code>, which is a helper\n    function that is needed in very rare cases.)\n  </blockquote>")))
 (idp8540864
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    Given how mechanical the code is, you could imagine writing a\n    program that inspected the type definition and auto-generated the\n    conversion code for you. That is precisely where syntax extensions\n    come in. Using Sexplib and adding <code>with sexp</code> as an\n    annotation to our type definition, we get the functions we want for\n    free.\n  </blockquote>")))
 (idp8539184
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    This is somewhat tiresome to write, and it gets more so when you\n    consider the parser, <span><em>i.e.</em></span>,\n    <code>t_of_sexp</code>, which is considerably more complex.\n    Writing this kind of parsing and printing code by hand is mechanical\n    and error prone, not to mention a drag.\n  </blockquote>")))
 (idp8537120
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    But what if you want a function to convert some brand new type to an\n    s-expression? You can of course write it yourself:\n  </blockquote>")))
 (idp8535856
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    Notice that <code>List.sexp_of_t</code> is polymorphic, and\n    takes as its first argument another conversion function to handle\n    the elements of the list to be converted. Core uses this scheme more\n    generally for defining sexp-converters for polymorphic types.\n  </blockquote>")))
 (idp8534064
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    In addition, most of the base types in Core support conversion to\n    and from s-expressions. For example, we can write:\n  </blockquote>")))
 (idp8531536
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    An s-expression is in essence a nested parenthetical list whose\n    atomic values are strings. The <code>Sexp</code> module comes\n    with functionality for parsing and printing s-expressions.\n  </blockquote>")))
 (idp8529952
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    S-expressions are nested paranthetical strings whose atomic values\n    are strings. They were first popularized by the Lisp programming\n    language in the 1960s, and have remained a simple way to encode data\n    structures since then.\n  </blockquote>")))
 (idp8528304
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    We'll start by introducing some features in Core that make it really\n    easy to manipulate s-expressions and safe binary serialisers\n    directly from OCaml types. After this section, we'll move onto\n    interoperating with other third-party formats in\n    <a href=\"handling-json-data.html\">Chapter\194\16010, <i>Handling JSON data</i></a> and\n    <a href=\"xml-streams-and-trees.html\">Chapter\194\16011, <i>XML Streams and Trees</i></a>.\n  </blockquote>")))
 (idp8527120
  ((file data-serialization-with-s-expressions.html)
   (html
    "<blockquote>\n    Data serialization, <span><em>i.e.</em></span> reading and writing\n    program data to a sequence of bytes, is an important and common\n    programming task. Sometimes you need to match someone else's data\n    format (such as XML), and other times you just want to quickly dump\n    some values to disk and read them back later. To this end, OCaml\n    comes with several techniques for data serialization depending on\n    what your problem is.\n  </blockquote>")))
 (idp7006288
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      That's it for our guided tour! There are plenty of features left\n      to touch upon and lots of details to explain, but the hope is that\n      this has given you enough of a feel for the language that you have\n      a sense as to what to expect, and will be comfortable reading\n      examples in the rest of the book.\n    </blockquote>")))
 (idp7004576
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        More work is needed to make a really usable command-line\n        programming, including a proper command-line parsing interface\n        and better error handling.\n      </blockquote>")))
 (idp7002048
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        The <code>.native</code> suffix indicates that we're\n        building a native-code executable, which we'll discuss more in\n        <a href=\"\">???</a>. Once the\n        build completes, we can use the resulting program like any\n        command-line utility. In this example, we can just type in a\n        sequence of numbers, one per line, hitting control-d to exit\n        when the input is complete.\n      </blockquote>")))
 (idp7000320
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        With our <code>_tags</code> file in place, we can build\n        our executable by issuing this command.\n      </blockquote>")))
 (idp6996560
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        We can use <code>ocamlbuild</code> to compile the program.\n        We'll need to create a file, in the same directory as\n        <code>sum.ml</code>, called <code>_tags</code>. We\n        can put the following in <code>_tags</code> to indicate\n        that we're building against Core, and that threads should be\n        enabled, which is a required by Core.\n      </blockquote>")))
 (idp6991088
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      After <code>read_and_accumulate</code> returns, the total\n      needs to be printed. This is done using the\n      <code>printf</code> command, which provides support for\n      type-safe format strings, similar to what you'll find in a variety\n      of languages. The format string is parsed by the compiler and used\n      to determine the number and type of the remaining arguments that\n      are required for <code>printf</code>. In this case, there is\n      a single formatting directive, <code>%F</code>, so\n      <code>printf</code> expects one additional argument of type\n      <code>float</code>.\n    </blockquote>")))
 (idp6987216
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      This is our first use of OCaml's input and output routines. The\n      function <code>read_and_accumulate</code> uses\n      <code>In_channel.input_line</code> to read in lines one by\n      one from the standard input, adding each number to its accumulated\n      sum as it goes. Note that <code>input_line</code> returns an\n      optional value, with <code>None</code> indicating the end of\n      the input. Note that <code>read_and_accumulate</code> is a\n      recursive function, invoking itself to read the next line, until\n      the last line is reached.\n    </blockquote>")))
 (idp6984960
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      Here's the code, which you can save in a file called\n      <code>sum.ml</code>.\n    </blockquote>")))
 (idp6984304
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      So far, we've played with the basic features of the language using\n      the toplevel. Now we'll create a simple, complete stand-along\n      program that does something useful: sum up a list of numbers read\n      in from the UNIX standard input.\n    </blockquote>")))
 (idp6981296
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Here's an example run of this code.\n      </blockquote>")))
 (idp6980032
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Note that the semi-colon after the first array assignment\n        doesn't terminate the scope of the let-binding, so the variable\n        <code>j</code> remains in scope until the end of the body\n        of the for loop.\n      </blockquote>")))
 (idp6974784
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Along with mutable data structures, OCaml gives you constructs\n        like <code>while</code> and <code>for</code> loops\n        for interacting with them. Here, for example, is a piece of\n        imperative code for permuting an array. Here, we use the\n        <code>Random</code> module as our source of randomness.\n        (<code>Random</code> starts out with a deterministic seed,\n        but you can call <code>Random.self_init</code> to get a\n        new random seed chosen.)\n      </blockquote>")))
 (idp6973200
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        A ref is really just an example of a mutable record, but in\n        practice, it's the standard way of dealing with a single mutable\n        value in a computation.\n      </blockquote>")))
 (idp6971312
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        There are a handful of useful functions and operators defined\n        for refs to make them more convenient to work with.\n      </blockquote>")))
 (idp6969056
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        We can declare a single mutable value by using a\n        <code>ref</code>, which is a record type with a single\n        mutable field that is defined in the standard library.\n      </blockquote>")))
 (idp6965264
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Here's an example of <code>create</code> and\n        <code>update</code> in action.\n      </blockquote>")))
 (idp6961424
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        If it doesn't convey any information, then what is\n        <code>unit</code> good for? Most of the time,\n        <code>unit</code> acts as a placeholder. Thus, we use\n        <code>unit</code> for the return value of a function like\n        <code>update</code> that operates by side effect rather\n        than by returning a value, and for the argument to a function\n        like <code>create</code> that doesn't require any\n        information to be passed into it in order to run.\n      </blockquote>")))
 (idp6957664
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        A new and somewhat odd type has cropped up in this example:\n        <code>unit</code>. What makes <code>unit</code>\n        different is that there is only one value of type\n        <code>unit</code>, which is written <code>()</code>.\n        Because there is only one value of type <code>unit</code>\n        that value doesn't really convey any information.\n      </blockquote>")))
 (idp6957024
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Note the use in the above code of single semi-colons to sequence\n        operations. When we were working purely functionally, this\n        wasn't necessary, but you start needing it when your code is\n        acting by side-effect.\n      </blockquote>")))
 (idp6953392
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n<code>create</code> returns a\n        <code>running_sum</code> corresponding to the empty set,\n        and <code>update rsum x</code> changes\n        <code>rsum</code> to reflect the addition of\n        <code>x</code> to its set of samples, by updating the\n        number of samples, the sum, and the sum of squares.\n      </blockquote>")))
 (idp6950928
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        We also need functions to create and update\n        <code>running_sum</code>s:\n      </blockquote>")))
 (idp6948480
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        The fields in <code>running_sum</code> are designed to be\n        easy to extend incrementally, and sufficient to compute means\n        and standard deviations, as shown below.\n      </blockquote>")))
 (idp6946320
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        The array is an important mutable datastructure, but it's not\n        the only one. Records, which are immutable by default, can be\n        declared with specific fields as being mutable. Here's a small\n        example of a datastructure for storing a running statistical\n        summary of a collection of numbers. Here's the basic data\n        structure:\n      </blockquote>")))
 (idp6942848
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        the <code>.(i)</code> syntax is used to refer to an\n        element of an array, and the <code>&lt;-</code> syntax is\n        for modification. Because the elements of the array are counted\n        starting at zero, element <code>.(2)</code> is the third\n        element.\n      </blockquote>")))
 (idp6941408
  ((file a-guided-tour.html)
   (html "<blockquote>\n        Here's an example.\n      </blockquote>")))
 (idp6940480
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Perhaps the simplest mutable datastructure in OCaml is the\n        array. Arrays in OCaml are very similar to arrays in other\n        languages like C: they are fixed width, indexing starts at 0,\n        and accessing or modifying an array element is a constant-time\n        operation. Arrays are more compact in terms of memory\n        utilization than most other data structures in OCaml, including\n        lists. OCaml uses three words per element of a list, but only\n        one per element of an array.\n      </blockquote>")))
 (idp6938880
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      Functional code is the default in OCaml, with variable bindings\n      and most datastructures being immutable. But OCaml also has\n      excellent support for imperative programming, including mutable\n      data structures like arrays and hashtables and control-flow\n      constructs like for and while loops.\n    </blockquote>")))
 (idp6937008
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      So far, we've only written so-called <span><em>pure</em></span> or\n      <span><em>functional</em></span> code, meaning that we didn't write\n      any code that modified a variable or value after its creation.\n      This is a quite different style from\n      <span><em>imperative</em></span> programming, where computations\n      are structured as sequences of instructions that operate by\n      modifying state as they go.\n    </blockquote>")))
 (idp6933104
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      We also made our first use of an <span><em>anonymous\n      function</em></span> in the call to <code>List.forall</code>.\n      An anonymous function is a function that is defined but not named,\n      in this case, using the <code>fun</code> keyword. Anonymous\n      functions are common in OCaml, particularly when using iteration\n      functions like like <code>List.forall</code>.\n    </blockquote>")))
 (idp6928688
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      You might at this point notice that the use of\n      <code>match</code> here is reminiscent of how we used\n      <code>match</code> with <code>option</code> and\n      <code>list</code>. This is no accident:\n      <code>option</code> and <code>list</code> are really\n      just examples of variant types that happen to be important enough\n      to be defined in the standard library (and in the case of lists,\n      to have some special syntax).\n    </blockquote>")))
 (idp6922240
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      The <code>|</code> character separates the different cases\n      of the variant (the first <code>|</code> is optional), and\n      each case has a tag, like <code>Circle</code>,\n      <code>Rect</code> and <code>Scene</code>, to\n      distinguish that case from the others. Here's how we might write a\n      function for testing whether a point is in the interior of some\n      element of a list of <code>scene_element</code>s.\n    </blockquote>")))
 (idp6920192
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      Now, imagine that you want to combine multiple objects of these\n      types together as a description of a multi-object scene. You need\n      some unified way of representing these objects together in a\n      single type. One way of doing this is using a\n      <span><em>variant</em></span> type:\n    </blockquote>")))
 (idp6918512
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      And we can of course include our newly defined types as components\n      in larger types, as in the following types, each of which is a\n      description of a different geometric object.\n    </blockquote>")))
 (idp6916960
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      We can also use dot-notation for accessing record fields:\n    </blockquote>")))
 (idp6914928
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      We can write the pattern match even more tersely, using what's\n      called <span><em>field punning</em></span>. In particular, when the\n      name of the field and the name of the variable coincide, we don't\n      have to write them both down. Thus, the magnitude function can be\n      rewritten as follows.\n    </blockquote>")))
 (idp6913328
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      And we can get access to the contents of these types using pattern\n      matching:\n    </blockquote>")))
 (idp6910784
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n<code>point2d</code> is a <span><em>record</em></span> type,\n      which you can think of as a tuple where the individual fields are\n      named, rather than being defined positionally. Record types are\n      easy enough to construct:\n    </blockquote>")))
 (idp6909152
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      So far, we've looked only at data structures that were predefined\n      in the language, like lists and tuples. But OCaml also allows us\n      to define new datatypes. Here's a toy example of a datatype\n      representing a point in 2-dimensional space:\n    </blockquote>")))
 (idp6905216
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        In OCaml, however, nulls are explicit. A value of type\n        <code>string * string</code> always actually contains two\n        two well-defined values of type <code>string</code>. If\n        you want to allow, say, the first of those, to possibly be\n        absent, then you need to change the type to something like\n        <code>string option * string</code>. As we'll see, this\n        explicitness allows the compiler to provide a great deal of help\n        in making sure you're correctly handing the possibility of\n        missing data.\n      </blockquote>")))
 (idp6903984
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Options are important because they are the standard way in OCaml\n        to encode a value that might not be there. This is different\n        from most other languages, including Java and C#, where most if\n        not all datatypes are <span><em>nullable</em></span>, meaning\n        that, whatever their type is, any given value also contains the\n        possibility of being a null value. In such languages, null is\n        lurking everywhere.\n      </blockquote>")))
 (idp6899904
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        In this case, we can rewrite <code>print_log_entry</code>\n        using <code>Option.value</code>, which returns the content\n        of an option if the option is <code>Some</code>, or a\n        default value if the option is <code>None</code>.\n      </blockquote>")))
 (idp6896592
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Here, we again use a <code>match</code> statement for\n        handling the two possible states of an option. It's worth noting\n        that we don't necessarily need to use an explicit\n        <code>match</code> statement in this case. We can instead\n        use some built in functions from the <code>Option</code>\n        module, which, like the <code>List</code> module for\n        lists, is a place where you can find a large collection of\n        useful functions for working with options.\n      </blockquote>")))
 (idp6893408
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        To get a value out of an option, we use pattern matching, as we\n        did with tuples and lists. Consider the following simple\n        function for printing a log entry given an optional time and a\n        message. If no time is provided (<span><em>i.e.</em></span>, if\n        the time is <code>None</code>), the current time is\n        computed and used in its place.\n      </blockquote>")))
 (idp6888480
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        The function <code>divide</code> either returns\n        <code>None</code>, if the divisor is zero, or\n        <code>Some</code> of the result of the division,\n        otherwise. <code>Some</code> and <code>None</code>\n        are constructors, like <code>::</code> and\n        <code>[]</code> for lists, which let you build optional\n        values. You can think of an option as a specialized list that\n        can only have zero or one element.\n      </blockquote>")))
 (idp6886864
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Another common data structure in OCaml is the option. An option\n        is used to express that a value might or might not be present.\n        For example,\n      </blockquote>")))
 (idp6884288
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          In the last few examples, our list processing code involved a\n          lot of recursive functions. In practice, this isn't usually\n          necessary. Most of the time, you'll find yourself happy to use\n          the iteration functions found in the <code>List</code>\n          module. But it's good to know how to use recursion when you\n          need to do something new that's not already supported.\n        </blockquote>")))
 (idp6880032
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Note that this code used another variant of the list pattern,\n          <code>[hd]</code>, to match a list with a single\n          element. We can do this to match a list with any fixed number\n          of elements, <span><em>e.g.</em></span>,\n          <code>[x;y;z]</code> will match any list with exactly\n          three elements, and will bind those elements to the variables\n          <code>x</code>, <code>y</code> and\n          <code>z</code>.\n        </blockquote>")))
 (idp6878080
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          This indicates that we're missing a case, in particular we\n          don't handle one-element lists. That's easy enough to fix by\n          adding another case to the match:\n        </blockquote>")))
 (idp6876688
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Again, the first arm of the match is the base case, and the\n          second is the inductive. Unfortunately, this code has a\n          problem. If you type it into the top-level, you'll see this\n          error:\n        </blockquote>")))
 (idp6874480
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          We can introduce more complicated list patterns as well.\n          Here's a function for destuttering a list,\n          <span><em>i.e.</em></span>, for removing sequential duplicates.\n        </blockquote>")))
 (idp6872544
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Note that we had to use the <code>rec</code> keyword to\n          allow <code>sum</code> to refer to itself. And, as you\n          might imagine, the base case and inductive case are different\n          arms of the match. In particular, the base case is that of the\n          empty list, and the inductive case is that of a list of zero\n          or more elements.\n        </blockquote>")))
 (idp6870736
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          When writing recursive list functions, this separation between\n          the base cases and the inductive cases is often done using\n          pattern matching. Here's a simple example of a function that\n          sums the elements of a list.\n        </blockquote>")))
 (idp6869152
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Recursive functions, or, functions that call themselves, are\n          an important technique in OCaml and in any functional\n          language. The typical approach to designing a recursive\n          function is to separate the logic into a set of <span><em>base\n          cases</em></span>, that can be solved directly, and a set of\n          <span><em>inductive cases</em></span>, where the function\n          breaks the problem down into smaller pieces and then calls\n          itself to solve those smaller problems.\n        </blockquote>")))
 (idp6864848
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          The first pattern, <code>first :: the_rest</code>,\n          covers the case where <code>languages</code> has at\n          least one element, since every list except for the empty list\n          can be written down with one or more <code>::</code>'s.\n          The second pattern, <code>[]</code>, matches only the\n          empty list. These cases are exhaustive (every list is either\n          empty, or has at least one element), and the compiler can\n          detect that exhaustiveness, which is why it doesn't spit out a\n          warning.\n        </blockquote>")))
 (idp6863008
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Note that we included a comment in the above code. OCaml\n          comments are bounded by <code>(*</code> and\n          <code>*)</code>, and can be nested arbitrarily and cover\n          multiple lines.\n        </blockquote>")))
 (idp6859920
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Here's a new version of\n          <code>my_favorite_language</code> that uses\n          <code>match</code>, and doesn't trigger a compiler\n          warning.\n        </blockquote>")))
 (idp6856496
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          A <code>match</code> statement is a kind of juiced-up\n          version of the switch statement found in <code>C</code>\n          and <code>Java</code>. It essentially lets you list a\n          sequence of patterns (separated by <code>|</code>\n          characters --- the one before the first case is optional), and\n          the compiler then dispatches to the code following the first\n          matched pattern. And, as we've already seen, we can name new\n          variables in our patterns that correspond to sub-structures of\n          the value being matched.\n        </blockquote>")))
 (idp6855312
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          You can avoid these warnings, and more importantly make sure\n          that your code actually handles all of the possible cases, by\n          using a <code>match</code> statement instead.\n        </blockquote>")))
 (idp6852864
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          The warning comes because the compiler can't be certain that\n          the pattern match won't lead to a runtime error. Indeed, the\n          warning gives an example of a pattern that won't match, the\n          empty list, <code>[]</code>. We can see this in action\n          below.\n        </blockquote>")))
 (idp6850976
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          If you try the above example in the toplevel, however, you'll\n          see that it spits out an error:\n        </blockquote>")))
 (idp6848512
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          By pattern matching using <code>::</code>, we've broken\n          off the first element of <code>languages</code> from the\n          rest of the list. If you know Lisp or Scheme, what we've done\n          is the equivalent of using <code>car</code> to grab the\n          first element of a list.\n        </blockquote>")))
 (idp6845760
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          The elements of a list can be accessed through\n          pattern-matching. List patterns are based on the two list\n          constructors, <code>[]</code> and <code>::</code>.\n          Here's a simple example.\n        </blockquote>")))
 (idp6841328
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          The bracket notation for lists is really just syntactic sugar\n          for <code>::</code>. Thus, the following declarations\n          are all equivalent. Note that <code>[]</code> is used to\n          represent the empty list.\n        </blockquote>")))
 (idp6839856
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Here, we're creating a new extended list, not changing the\n          list we started with, as you can see below.\n        </blockquote>")))
 (idp6837648
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          In addition to constructing lists using brackets, we can use\n          the operator <code>::</code> for adding elements to the\n          front of a list.\n        </blockquote>")))
 (idp6835152
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          We'll learn more about labeled arguments and why they're\n          important in\n          <a href=\"variables-and-functions.html\">Chapter\194\1602, <i>Variables and Functions</i></a>.\n        </blockquote>")))
 (idp6831952
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          In this example, the function <code>String.length</code>\n          is passed using under the <span><em>labeled\n          argument</em></span> <code>~f</code>. Labels allow you to\n          specify function arguments by name rather than by position. As\n          you can see below, we can change the order of labeled\n          arguments without changing the function's behavior.\n        </blockquote>")))
 (idp6830096
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n<code>List.map</code> takes two arguments: a list, and a\n          function for transforming the elements of that list. Note that\n          <code>List.map</code> creates a new list and does not\n          modify the original.\n        </blockquote>")))
 (idp6828608
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Here's something a little more complicated. We can compute the\n          list of the lengths of each language as follows.\n        </blockquote>")))
 (idp6826480
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          OCaml comes with a <code>List</code> module that has a\n          rich collection of functions for working with lists. We can\n          access values from within a module by using dot-notation.\n          Here, for example, is how we compute the length of a list.\n        </blockquote>")))
 (idp6822992
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Note that you can't mix elements of different types on the same\n        list, as we did with tuples.\n      </blockquote>")))
 (idp6821360
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Where tuples let you combine a fixed number of items,\n        potentially of different types, lists let you hold any number of\n        items of the same type. For example:\n      </blockquote>")))
 (idp6819776
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        This is just a first taste of pattern matching. Pattern matching\n        is a pervasive tool in OCaml, and as you'll see, it has\n        surprising power.\n      </blockquote>")))
 (idp6817472
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Pattern matching can also show up in function arguments. Here's\n        a function for computing the distance between two points on the\n        plane, where each point is represented as a pair of\n        <code>float</code>s. The pattern matching syntax lets us\n        get at the values we need with a minimum of fuss.\n      </blockquote>")))
 (idp6814304
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Here, the <code>(x,y)</code> on the left-hand side of the\n        <code>let</code> binding is the pattern. This pattern lets\n        us mint the new variables <code>x</code> and\n        <code>y</code>, each bound to different components of the\n        value being matched. Note that the same syntax is used both for\n        constructing and for pattern-matching on tuples.\n      </blockquote>")))
 (idp6812800
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        You can extract the components of a tuple using OCaml's\n        pattern-matching syntax. For example:\n      </blockquote>")))
 (idp6809728
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        For the mathematically inclined, the <code>*</code>\n        character is used because the set of all pairs of type\n        <code>t * s</code> corresponds to the Cartesian product of\n        the set of elements of type <code>t</code> and the set of\n        elements of type <code>s</code>.\n      </blockquote>")))
 (idp6805488
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        So far we've encountered a handful of basic types like\n        <code>int</code>, <code>float</code> and\n        <code>string</code> as well as function types like\n        <code>string -&gt; int</code>. But we haven't yet talked\n        about any data structures. We'll start by looking at a\n        particularly simple data structure, the tuple. You can create a\n        tuple by joining values together with a comma:\n      </blockquote>")))
 (idp6801808
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        but the following code runs incident, even though it contains a\n        branch that would throw an exception if it were ever reached.\n      </blockquote>")))
 (idp6799680
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        One important distinction is that type errors will stop you\n        whether or not the offending code is ever actually executed.\n        Thus, you get an error from typing in this code:\n      </blockquote>")))
 (idp6798256
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        are compile-time errors, whereas an error that can't be caught\n        by the type system, like division by zero, leads to a runtime\n        exception.\n      </blockquote>")))
 (idp6796368
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Working in the top-level somewhat obscures the difference\n        between run-time and compile time errors, but that difference is\n        still there. Generally, type errors, like this one:\n      </blockquote>")))
 (idp6795648
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        There's a big difference in OCaml (and really in any compiled\n        language) between errors that are caught at compile time and\n        those that are caught at run-time. It's better to catch errors\n        as early as possible in the development process, and compilation\n        time is best of all.\n      </blockquote>")))
 (idp6789744
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        In this example, <code>big_number</code> requires that\n        <code>'a</code> be of type <code>int</code>, whereas\n        <code>&quot;short&quot;</code> and\n        <code>&quot;loooooong&quot;</code> require that\n        <code>'a</code> be of type <code>string</code>, and\n        they can't all be right at the same time. This kind of\n        genericity is called <span><em>parametric\n        polymorphism</em></span>, and is very similar to generics in C#\n        and Java.\n      </blockquote>")))
 (idp6784480
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Both <code>long_string</code> and\n        <code>big_number</code> are functions, and each is passed\n        to <code>first_if_true</code> with two other arguments of\n        the appropriate type (strings in the first example, and integers\n        in the second). But we can't mix and match two different\n        concrete types for <code>'a</code> in the same use of\n        <code>first_if_true</code>.\n      </blockquote>")))
 (idp6783056
  ((file a-guided-tour.html)
   (html "<blockquote>\n        And we can also write:\n      </blockquote>")))
 (idp6781536
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        This genericity means that we can write:\n      </blockquote>")))
 (idp6775456
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        we see that rather than choose a single concrete type, OCaml has\n        introduced a <span><em>type variable</em></span>\n<code>'a</code> to express that the type is generic. In\n        particular, the type of the <code>test</code> argument is\n        <code>('a -&gt; bool)</code>, which means that test is a\n        one-argument function whose return value is\n        <code>bool</code>, and whose argument could be of any type\n        <code>'a</code>. But, whatever type <code>'a</code>\n        is, it has to be the same as the type of the other two\n        arguments, <code>x</code> and <code>y</code>.\n      </blockquote>")))
 (idp6766352
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n<code>first_if_true</code> takes as its arguments a\n        function <code>test</code>, and two values,\n        <code>x</code> and <code>y</code>, where\n        <code>x</code> is to be returned if\n        <code>test x</code> evaluates to <code>true</code>,\n        and <code>y</code> otherwise. So what's the type of\n        <code>first_if_true</code>? There are no obvious clues\n        such as arithmetic operators or literals to tell you what the\n        type of <code>x</code> and <code>y</code> are. That\n        makes it seem like one could use this\n        <code>first_if_true</code> on values of any type. Indeed,\n        if we look at the type returned by the toplevel:\n      </blockquote>")))
 (idp6764944
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Sometimes, there isn't enough information to fully determine the\n        concrete type of a given value. Consider this function.\n      </blockquote>")))
 (idp6763200
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        In the above, we've marked every argument to the function with\n        its type, with the final annotation indicating the type of the\n        return value. Such type annotations can actually go around any\n        value in an OCaml program, and can be useful for figuring out\n        why a given program is failing to compile.\n      </blockquote>")))
 (idp6760448
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Over time, you'll build a rough intuition for how the OCaml\n        inference engine works, which makes it easier to reason through\n        your programs. One way of making it easier to understand the\n        types is to add explicit type annotations. These annotations\n        never change the behavior of an OCaml program, but they can\n        serve as useful documentation, as well as catch unintended type\n        changes. Here's an annotated version of\n        <code>sum_if_true</code>:\n      </blockquote>")))
 (idp6759296
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        Together, that nails down the the types of all the variables,\n        which determines the overall type of\n        <code>sum_if_true</code>.\n      </blockquote>")))
 (idp6757408
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n            The fact that <code>+</code> returns an int implies\n            that the return value of <code>sum_if_true</code> must\n            be int.\n          </blockquote>")))
 (idp228624
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n<code>test x</code> is used as the condition in an\n            <code>if</code> statement, so the return type of\n            <code>test</code> must be <code>bool</code>.\n          </blockquote>")))
 (idp223584
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n<code>test</code> is passed <code>x</code> as an\n            argument. Since <code>x</code> has type\n            <code>int</code>, the input type of\n            <code>test</code> must be <code>int</code>.\n          </blockquote>")))
 (idp217952
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n            OCaml requires that both arms of an <code>if</code>\n            statement return the same type, so the expression\n            <code>if test x then x else 0</code> requires that\n            <code>x</code> must be the same type as\n            <code>0</code>, which is <code>int</code>. By\n            the same logic we can conclude that <code>y</code> has\n            type <code>int</code>.\n          </blockquote>")))
 (idp216224
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        As an example, let's walk through the process of inferring the\n        type of <code>sum_if_true</code>.\n      </blockquote>")))
 (idp215168
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        OCaml determines the type of an expression using a technique\n        called <span><em>type inference</em></span>, by which it infers\n        the type of a given expression based on what it already knows\n        about the types of other related variables, and on constraints\n        on the types that arise from the structure of the code.\n      </blockquote>")))
 (idp214560
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n        As the types we encounter get more complicated, you might ask\n        yourself how OCaml is able to figure them out, given that we\n        didn't write down any explicit type information.\n      </blockquote>")))
 (idp211568
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      If we look at the inferred type signature in detail, we see that\n      the first argument is a function that takes an int and returns a\n      boolean, and that the remaining two arguments are integers. Here's\n      an example of this function in action.\n    </blockquote>")))
 (idp209712
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      We can even write functions that take other functions as\n      arguments. Here's an example of a function that takes three\n      arguments: a test function and two integer arguments. The function\n      returns the sum of the integers that pass the test.\n    </blockquote>")))
 (idp207904
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      describes a function that takes two <code>int</code>\n      arguments and returns a <code>float</code>.\n    </blockquote>")))
 (idp205344
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      The notation for the type-signature of a multi-argument functions\n      may be a little surprising at first, but we'll explain where it\n      comes from when we get to function currying in\n      <a href=\"variables-and-functions.html\">Chapter\194\1602, <i>Variables and Functions</i></a>. For the\n      moment, think of the arrows as separating different arguments of\n      the function, with the type after the final arrow being the return\n      value of the function. Thus,\n    </blockquote>")))
 (idp260976
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      Now that we're creating more interesting values like functions,\n      the types have gotten more interesting too.\n      <code>int -&gt; int</code> is a function type, in this case\n      indicating a function that takes an <code>int</code> and\n      returns an <code>int</code>. We can also write functions\n      that take multiple arguments.\n    </blockquote>")))
 (idp258432
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      When using <code>let</code> to define a function, the first\n      identifier after the <code>let</code> is the function name,\n      and each subsequent identifier is a different argument to the\n      function. Thus, <code>square</code> is a function with a\n      single argument.\n    </blockquote>")))
 (idp256160
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      The <code>let</code> syntax can also be used for creating\n      functions:\n    </blockquote>")))
 (idp304512
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      After a new variable is created, the toplevel tells us the name of\n      the variable, in addition to its type and value.\n    </blockquote>")))
 (idp302352
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      We can also a create variable to name the value of a given\n      expression, using a <code>let</code> binding.\n    </blockquote>")))
 (idp3136768
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          OCaml carefully distinguishes between\n          <code>float</code>, the type for floating point numbers\n          and <code>int</code>. The types have different literals\n          (<code>6.</code> instead of <code>6</code>) and\n          different infix operators (<code>+.</code> instead of\n          <code>+</code>), and OCaml doesn't do any automated\n          casting between the types. This can be a bit of a nuisance,\n          but it has its benefits, since it prevents some kinds of bugs\n          that arise in other languages due to unexpected differences\n          between the behavior of <code>int</code> and\n          <code>float</code>.\n        </blockquote>")))
 (idp4331312
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          Function arguments are separated by spaces, instead of by\n          parenthesis and commas, which is more like the UNIX shell than\n          C or Java.\n        </blockquote>")))
 (idp4013472
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          After evaluating an expression, the toplevel spits out both\n          the type of the result and the result itself.\n        </blockquote>")))
 (idp3247632
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n          We needed to type <code>;;</code> in order to tell the\n          toplevel that it should evaluate an expression. This is a\n          peculiarity of the toplevel that is not required in\n          stand-alone programs (though it is sometimes helpful to\n          include <code>;;</code> to improve OCaml's error\n          reporting.)\n        </blockquote>")))
 (idp3224208
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      By and large, this is pretty similar to what you'd find in any\n      programming language, but there are a few things that jump right\n      out at you.\n    </blockquote>")))
 (idp4092400
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      Now that we have Core open, let's try a few simple numerical\n      calculations.\n    </blockquote>")))
 (idp4818416
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n      Let's spin up the toplevel. Throughout the book we're going to use\n      Core, a more full-featured and capable replacement for OCaml's\n      standard library. Accordingly, we'll start by opening the\n      <code>Core.Std</code> module to get access to Core's\n      libraries. If you don't open <code>Core.Std</code> many of\n      the examples below will fail.\n    </blockquote>")))
 (idp3292464
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n    You can exit <code>utop</code> by pressing\n    <code>control-D</code> and return.\n  </blockquote>")))
 (idp1458608
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n    The easiest way to get <code>utop</code> is via the OPAM\n    package manager, which is explained in\n    <a href=\"installation.html\">Chapter\194\16013, <i>Installation</i></a>. You'll need to also have\n    the Core standard library installed. In a nutshell, you need to:\n  </blockquote>")))
 (idp4167792
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n    Make sure you have a working toplevel as you go through this\n    chapter, so you can try out the examples as you go.\n  </blockquote>")))
 (idp4676992
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n    We'll present this guided tour using the <code>utop</code>\n    OCaml toplevel, a shell that lets you type in expressions and\n    evaluate them interactively. When you get to the point of running\n    real programs, you'll want to leave the toplevel behind, but it's a\n    great tool for getting to know the language.\n  </blockquote>")))
 (idp3042528
  ((file a-guided-tour.html)
   (html
    "<blockquote>\n    This chapter gives an overview of OCaml by walking through a series\n    of small examples that cover most of the major features of the\n    language. This should give a sense of what OCaml can do, without\n    getting too deep in any one topic.\n  </blockquote>"))))
